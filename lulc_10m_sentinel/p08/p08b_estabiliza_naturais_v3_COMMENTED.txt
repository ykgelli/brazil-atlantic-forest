var limite_MA2 = 
    /* color: #d63000 */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[-49.247700941636595, -29.022523383158095],
          [-48.7353515625, -28.806173508854762],
          [-48.14208984375, -27.537500308359466],
          [-48.39445536421073, -26.590423365831768],
          [-48.328857421875, -25.809781975840405],
          [-47.52238508646195, -24.961533378966568],
          [-46.702880859375, -24.467150664738988],
          [-46.201591895409365, -24.133590011676564],
          [-45.10986328125, -24.016361823963027],
          [-44.71435546875, -23.52370005882413],
          [-43.83867478555652, -23.28797276201207],
          [-41.868896484375, -23.099944212531387],
          [-41.53739054012016, -22.54787404186189],
          [-40.858154296875, -22.055096050575845],
          [-40.813241260469226, -21.30385052235623],
          [-40.341796875, -20.745840238902247],
          [-39.98919871239127, -19.972814500963008],
          [-39.70458984375, -19.73568357862943],
          [-39.6146087043204, -19.29822872014044],
          [-39.57324612304177, -18.26836581577437],
          [-39.0838623046875, -17.748686651728793],
          [-39.055713575251104, -17.0336668879567],
          [-38.7432861328125, -15.866241564066616],
          [-38.93015197494924, -14.712551816040117],
          [-38.73779296875, -13.336175186494915],
          [-38.221435546875, -13.100879969526476],
          [-36.826171875, -10.908830155722121],
          [-35.4638671875, -9.633245727691198],
          [-34.793701171875, -8.461505694920898],
          [-34.683837890625, -7.079088026071719],
          [-32.135009765625, -3.601142320158722],
          [-35.6396484375, -5.101887070062321],
          [-35.60086706035952, -5.614547055897661],
          [-35.441686579377, -6.423044456643987],
          [-35.8154296875, -7.547655601241832],
          [-35.77628458120148, -7.890311935689954],
          [-36.8096923828125, -8.933913624704099],
          [-37.452392578125, -10.093262015308474],
          [-38.3148193359375, -11.280773781192053],
          [-39.5123291015625, -11.78670268848142],
          [-40.616455078125, -13.2399454992863],
          [-40.6439208984375, -14.243086862716888],
          [-41.396484375, -14.838611553384807],
          [-41.90185546875, -14.966013251567153],
          [-42.5390625, -15.802824941413187],
          [-42.550048828125, -17.14603949574698],
          [-43.890380859375, -18.594188856740427],
          [-43.7255859375, -19.575317892869442],
          [-44.670737078228704, -19.268247267184112],
          [-45.0439453125, -19.414792438099557],
          [-45.46142578125, -19.91138351415555],
          [-46.021728515625, -20.7047387200555],
          [-46.966552734375, -20.365227537412434],
          [-47.098388671875, -19.963022929830807],
          [-47.493896484375, -19.611543503814232],
          [-47.96630859375, -19.559790136497398],
          [-48.416748046875, -19.559790136497398],
          [-49.04296875, -19.694314241825747],
          [-49.998779296875, -19.373340713364044],
          [-49.493408203125, -19.2489223284628],
          [-47.757568359375, -19.020577110966794],
          [-47.98828125, -18.323240460443383],
          [-48.62548828125, -17.75914975540014],
          [-49.207763671875, -17.790535393588964],
          [-51.119384765625, -18.417078658661257],
          [-51.85546875, -20.097206227083888],
          [-52.88818359375, -21.841104749065032],
          [-54.33837890625, -21.5041855007784],
          [-55.294189453125, -21.80030805097258],
          [-55.4150390625, -23.23125092389778],
          [-55.458984375, -24.12670195868167],
          [-54.6240234375, -23.93605491459982],
          [-54.404296875, -24.39713301739104],
          [-54.744873046875, -25.681137335685307],
          [-53.96484375, -25.770213848960246],
          [-53.85498046875, -26.95145308349825],
          [-54.9755859375, -27.498526722798296],
          [-55.47821044921875, -28.069556808283593],
          [-55.14389607787536, -28.294019340320542],
          [-54.843276751098756, -28.455948569287795],
          [-54.47755233547173, -28.574911416473032],
          [-54.08786740173093, -28.686648423642083],
          [-53.37158203125, -29.046565622728846],
          [-53.743743896484375, -29.424048845483828],
          [-53.89471068932722, -29.476890814513165],
          [-53.96333274830807, -29.516463876552184],
          [-53.985933193466906, -29.466627605546755],
          [-54.01399085963391, -29.362974979934112],
          [-54.0957995760449, -29.356021030068643],
          [-54.154222913515014, -29.314313841353393],
          [-54.23853854957156, -29.313083872479314],
          [-54.34931514088896, -29.360217477461482],
          [-54.37451966390222, -29.251873401377896],
          [-54.41987650022799, -29.22165031302486],
          [-54.561629026807395, -29.255956269857826],
          [-54.62100646401336, -29.232741355021034],
          [-54.69684636444414, -29.21513553302705],
          [-54.80832142057618, -29.211841387289443],
          [-54.86783664015559, -29.201620760910515],
          [-54.861083387822305, -29.286939284390016],
          [-54.936762801395275, -29.29077843021244],
          [-54.934557778030864, -29.317890891762687],
          [-54.89637833995612, -29.355389471176345],
          [-54.918606622151415, -29.380926390970743],
          [-54.971869817666686, -29.365728890813415],
          [-55.011401674227045, -29.360099098278926],
          [-55.0234626088652, -29.31855224246986],
          [-55.11566162109375, -29.29358522654161],
          [-55.1383134470135, -29.344453559309528],
          [-55.169219970703125, -29.438401595657513],
          [-55.054316400333846, -29.54316711975633],
          [-54.971431829700066, -29.560110616981305],
          [-54.8246791955296, -29.481057814453678],
          [-54.772348103860324, -29.547101213390164],
          [-54.65399970066687, -29.59875323709413],
          [-54.529287966222284, -29.596952601022753],
          [-54.42106275663161, -29.592662068126202],
          [-54.25211822648299, -29.557985162004776],
          [-54.23838114877856, -29.6057018525106],
          [-54.143545282885725, -29.65695554739698],
          [-53.98760428093533, -29.63544046885246],
          [-53.89482321115236, -29.64842475879738],
          [-53.91323116566139, -29.695990247187094],
          [-53.82999936609964, -29.766196563619406],
          [-53.732642004168156, -29.70057719271144],
          [-53.5803125276326, -29.792259794207105],
          [-53.41292085991745, -29.808497111211725],
          [-53.20404052734375, -29.93589521337243],
          [-52.404220884110465, -30.002515899452863],
          [-51.33087158203125, -29.900186637177384],
          [-50.09765625, -30.002516938570686]]]),
    remap_21ou15_para_29 = 
    /* color: #d68326 */
    /* shown: false */
    ee.Geometry.MultiPolygon(
        [[[[-44.90204509577677, -22.47210213896691],
           [-44.879729116772864, -22.475591875802422],
           [-44.816557730054114, -22.47432289076303],
           [-44.78737529597208, -22.45845959690877],
           [-44.76780589899943, -22.423871324061977],
           [-44.77123912653849, -22.38165561182068],
           [-44.808317983960364, -22.365781728478577],
           [-44.838530386304114, -22.367051705760403],
           [-44.863249624585364, -22.40006704783069],
           [-44.91749461970255, -22.39117907269556],
           [-44.941870535229896, -22.41593701852782],
           [-44.926421011304114, -22.463853320592605]]],
         [[[-44.72438433537164, -22.11860405529174],
           [-44.7113380707232, -22.101268915791575],
           [-44.710994747969295, -22.092680075906873],
           [-44.72318270573297, -22.092680075906873],
           [-44.73279574284234, -22.09252101838706],
           [-44.73502734074273, -22.091089492643448],
           [-44.740692166182185, -22.084090713383468],
           [-44.74206545719781, -22.07788695994924],
           [-44.744983700606014, -22.073750972952613],
           [-44.75082018742242, -22.06881944559954],
           [-44.76335146794, -22.065637723717597],
           [-44.780174282881404, -22.062296838657574],
           [-44.780689267012264, -22.07247833720932],
           [-44.77897265324273, -22.08870358414468],
           [-44.79270556339898, -22.09888317936917],
           [-44.78549578556695, -22.108584922599572],
           [-44.78206255802789, -22.116218612081646],
           [-44.78669741520562, -22.118922111336726],
           [-44.78583910832086, -22.12305677461685],
           [-44.78086092838922, -22.127191316604456],
           [-44.76729967960992, -22.135937063362235],
           [-44.76129153141656, -22.135778054631057],
           [-44.74652865299859, -22.13848117864694],
           [-44.73279574284234, -22.132597842312222],
           [-44.72901919254937, -22.125919162758848]]],
         [[[-43.423745942527106, -19.21646203718466],
           [-43.422758889609625, -19.216644395894953],
           [-43.422758889609625, -19.21702937473011],
           [-43.422994924002936, -19.21814378206487],
           [-43.42220099013453, -19.218042472619388],
           [-43.42160017531519, -19.21743461463514],
           [-43.42108519118433, -19.217110422791045],
           [-43.419239831382086, -19.217515662496254],
           [-43.417995286399176, -19.217657496157038],
           [-43.41743738692408, -19.217920901202376],
           [-43.41672928374415, -19.21826535331704],
           [-43.415248704367926, -19.218609804709832],
           [-43.41419727843409, -19.219055564264245],
           [-43.41333897154932, -19.21974446301578],
           [-43.412502122336676, -19.219460799173678],
           [-43.41138632338648, -19.219663416253713],
           [-43.410259795038094, -19.220068651889097],
           [-43.409562421256354, -19.219460799173678],
           [-43.409283471518805, -19.218832684638162],
           [-43.411794019156744, -19.217515662496254],
           [-43.414261651450445, -19.21577312467557],
           [-43.41660053771143, -19.214476340355727],
           [-43.42016251128321, -19.214314241596483],
           [-43.42235119383936, -19.214111617922665],
           [-43.42346699278956, -19.21520578279435]]],
         [[[-43.43496818163108, -19.204481649360922],
           [-43.432779499074925, -19.205089555231833],
           [-43.42921752550315, -19.205170609178204],
           [-43.428573795339574, -19.204805866104994],
           [-43.42741508104514, -19.205494824564266],
           [-43.42522639848899, -19.205900092898148],
           [-43.42574138261985, -19.2073590506318],
           [-43.4233381233425, -19.207723788042998],
           [-43.42247981645774, -19.208493786587987],
           [-43.42209357835959, -19.208899047532],
           [-43.4204198799343, -19.209425885266143],
           [-43.42016238786887, -19.20885852148254],
           [-43.41947574236106, -19.208736943274243],
           [-43.41969031908225, -19.20906115162997],
           [-43.420334049245824, -19.210560606960772],
           [-43.419304080984105, -19.210641658210758],
           [-43.416814991018285, -19.209871669722858],
           [-43.41745872118186, -19.209020625620454],
           [-43.41891784288596, -19.20881799542309],
           [-43.419304080984105, -19.207683261703913],
           [-43.41767329790305, -19.208129050884494],
           [-43.41664332964133, -19.20650799352664],
           [-43.41823119737815, -19.206224306846284],
           [-43.418789096853246, -19.206872732825243],
           [-43.41921825029563, -19.20671062657017],
           [-43.41994781114768, -19.20630536023346],
           [-43.418274112722386, -19.2058595661097],
           [-43.41771621324729, -19.205454297675963],
           [-43.41960448839377, -19.204603230714838],
           [-43.42136401750754, -19.205008501245526],
           [-43.421793170949925, -19.204846393153076],
           [-43.421578594228734, -19.202131058855457],
           [-43.42441100694846, -19.202617390681276],
           [-43.42488307573508, -19.202050003411376],
           [-43.42466849901389, -19.20083416695789],
           [-43.425526805898656, -19.199213037709743],
           [-43.42617053606223, -19.198442995721447],
           [-43.428316303274144, -19.19868616726496],
           [-43.42861671068381, -19.200023604330443],
           [-43.427071758291234, -19.20059099858895],
           [-43.42599887468528, -19.202050003411376],
           [-43.42685718157004, -19.20229316962381],
           [-43.42720050432395, -19.202738973413087],
           [-43.42900294878196, -19.202779500970387],
           [-43.429260440847386, -19.201685253418795],
           [-43.431534954092015, -19.202009475674362],
           [-43.43265075304221, -19.202617390681276],
           [-43.4348823509426, -19.202982138607123]]],
         [[[-43.46415062067054, -19.1990914538282],
           [-43.46303482144548, -19.19905092535261],
           [-43.46140403796266, -19.198645640045974],
           [-43.45938701628652, -19.19787559521294],
           [-43.45771331744891, -19.197348720356153],
           [-43.457026671771935, -19.196862372837092],
           [-43.453078459129635, -19.19742977813663],
           [-43.448186108681476, -19.19840246838363],
           [-43.44346541965239, -19.199739908084386],
           [-43.44290752003984, -19.20002360601726],
           [-43.44226378971764, -19.20055047230907],
           [-43.44033259875112, -19.20115839285683],
           [-43.438573069203684, -19.20257686539938],
           [-43.4355689943667, -19.203549525216605],
           [-43.43449611049668, -19.202131061060346],
           [-43.43719977785012, -19.200104662479053],
           [-43.43925971488109, -19.199415681275983],
           [-43.43818683101093, -19.198848282824482],
           [-43.438830561333184, -19.197997181478907],
           [-43.44157714404089, -19.19856458286544],
           [-43.44273585862076, -19.198159296360718],
           [-43.44247836649197, -19.19751083587668],
           [-43.44033259875156, -19.19738924925125],
           [-43.43908805346239, -19.195322262877138],
           [-43.43878764597909, -19.19284995096214],
           [-43.440246768042726, -19.190823438091442],
           [-43.4407188369141, -19.191350333209307],
           [-43.44149131374411, -19.192241999371674],
           [-43.4423067053057, -19.192525710430104],
           [-43.4428002302585, -19.1934173641785],
           [-43.44363708119892, -19.194673790775095],
           [-43.44591159495077, -19.19471432048867],
           [-43.44728488623057, -19.194633261650548],
           [-43.44955940003533, -19.19560596842697],
           [-43.45144767564686, -19.196011261220328],
           [-43.45243472880742, -19.195524909748443],
           [-43.45294971306505, -19.194592732076693],
           [-43.45363635874194, -19.194471143295427],
           [-43.45492381938617, -19.194795379845647],
           [-43.457069587126504, -19.19479537984546],
           [-43.45814247099662, -19.19439008405765],
           [-43.45887203202844, -19.19507908630278],
           [-43.46045990015645, -19.19613284886291],
           [-43.461704445446024, -19.196943430856166],
           [-43.462476921832696, -19.19763242241119],
           [-43.46367855176733, -19.197632422410983],
           [-43.46445102815405, -19.19844299701764]]],
         [[[-43.46863325952431, -19.274607766935183],
           [-43.463740910281146, -19.272663283804324],
           [-43.46314009546181, -19.268369135150177],
           [-43.46717413782021, -19.26723481294651],
           [-43.474040592898334, -19.2663435542795],
           [-43.477216328371966, -19.2663435542795],
           [-43.4778171431913, -19.26496614498975],
           [-43.479276264895404, -19.26545229076653],
           [-43.48218805493805, -19.26719125533761],
           [-43.48373300733063, -19.26727227863402],
           [-43.48596460523102, -19.266948185208065],
           [-43.48716623486969, -19.26889273615142]]]]),
    remap_29_para12 = 
    /* color: #ded185 */
    /* shown: false */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.74845470756087, -22.316165381488716],
                  [-44.693866389689774, -22.334903041437737],
                  [-44.6348148760179, -22.330139468155284],
                  [-44.592929500041336, -22.30568389831424],
                  [-44.559283870158524, -22.270104515591825],
                  [-44.574733394084305, -22.210997336896938],
                  [-44.59739269584212, -22.195104060389443],
                  [-44.63000835746321, -22.1966934690073],
                  [-44.68528332084212, -22.189064143591033],
                  [-44.69764293998274, -22.22053243890775],
                  [-44.739528315959305, -22.24150738139584],
                  [-44.78381695121321, -22.24532067006142],
                  [-44.79789318412337, -22.27995328675698],
                  [-44.75635113090071, -22.318388625242264]]]),
            {
              "remap": 100,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.758817869102536, -22.23207630432293],
                  [-44.719679075157224, -22.23334749762403],
                  [-44.7073194560166, -22.223813266891746],
                  [-44.700453000938474, -22.20029272651941],
                  [-44.675733762657224, -22.16532247881716],
                  [-44.6908399638291, -22.1519679074421],
                  [-44.73203869429785, -22.125891044613944],
                  [-44.758131223594724, -22.13479588210665],
                  [-44.808256345665036, -22.177404093702087],
                  [-44.810316282188474, -22.20219994422176],
                  [-44.77117748824316, -22.23271190241453]]]),
            {
              "remap": 100,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.56993844874189, -22.207522476443597],
                  [-44.5541456020622, -22.21546863658158],
                  [-44.53835275538251, -22.21197238155952],
                  [-44.529769686534856, -22.203708159756907],
                  [-44.52358987696454, -22.19957586638272],
                  [-44.49784764830573, -22.207907035508562],
                  [-44.46454534117682, -22.20250340441579],
                  [-44.45287236754401, -22.190423947543305],
                  [-44.44943914000495, -22.170077251111667],
                  [-44.44806584898932, -22.15131753170395],
                  [-44.484458060903386, -22.143367743603932],
                  [-44.51158055846198, -22.1296930580921],
                  [-44.539389701528386, -22.133191359828],
                  [-44.56170568053229, -22.143049742742104],
                  [-44.57955846373542, -22.155133270507527],
                  [-44.59329137389167, -22.17071312995907],
                  [-44.59397801939948, -22.18597335942792],
                  [-44.57971454544205, -22.203803714479022],
                  [-44.56735492630143, -22.207935883397493]]]),
            {
              "remap": 100,
              "system:index": "2"
            })]),
    remap_29_para_4 = 
    /* color: #0b4a8b */
    /* shown: false */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.38544205261908, -18.54822104786883],
                  [-43.378210817114926, -18.55147590974352],
                  [-43.374241147772885, -18.549055112136735],
                  [-43.37780312134466, -18.542056983205686],
                  [-43.3827813012763, -18.54199595175031],
                  [-43.386235986487485, -18.54217904605103],
                  [-43.38842466904364, -18.542463859017616],
                  [-43.39052752091131, -18.544518567062564],
                  [-43.389690671698666, -18.546797026288896],
                  [-43.38735178543768, -18.548892368209266]]]),
            {
              "remap": 100,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.417989142952784, -19.221470053353574],
                  [-43.41492069583975, -19.225420993045667],
                  [-43.41193807941519, -19.223455665688924],
                  [-43.41382635456167, -19.219727557457134],
                  [-43.41479194980703, -19.21845106618086],
                  [-43.41743124347769, -19.218005304987003],
                  [-43.418461211739405, -19.21778242393673],
                  [-43.41889036518179, -19.218795517184468]]]),
            {
              "remap": 100,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.40041530948721, -19.221996850801293],
                  [-43.394278415261134, -19.22580595132093],
                  [-43.391982444344386, -19.226555604321003],
                  [-43.39058769565664, -19.224185068275972],
                  [-43.38955772739492, -19.22300991806954],
                  [-43.387755282936915, -19.221855020885346],
                  [-43.38721884113394, -19.220072005785486],
                  [-43.38657511097036, -19.218086352566715],
                  [-43.38833464008413, -19.21687063467482],
                  [-43.391553290902, -19.21160241991427],
                  [-43.39485777240835, -19.211784784015105],
                  [-43.39668167453848, -19.212878964372482],
                  [-43.39779747348867, -19.217600066488963],
                  [-43.401638396798, -19.21988965087804]]]),
            {
              "remap": 100,
              "system:index": "2"
            })]),
    remap_11_para_12 = 
    /* color: #d63000 */
    /* shown: false */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.78940351079589, -22.197107463960847],
                  [-44.67164380620605, -22.129700960523234],
                  [-44.65739591191894, -22.076981264464976],
                  [-44.69541171879106, -22.055238923890084],
                  [-44.82568460309636, -21.988300647607588],
                  [-44.85950189435613, -21.994030824136704],
                  [-44.876324709297535, -22.01281144645413],
                  [-44.89091592633855, -22.012652299090426],
                  [-44.90035730207097, -22.01488034591882],
                  [-44.92885309064519, -22.02792963091253],
                  [-44.96816354596746, -22.03365820553222],
                  [-44.98361306989324, -22.034135576288413],
                  [-44.99030786359441, -22.040341249627083],
                  [-44.98481469953191, -22.054660995672812],
                  [-44.937264498115894, -22.084091475416496],
                  [-44.89761072003972, -22.100841877482715],
                  [-44.8841867342715, -22.142834572154566],
                  [-44.87371539027736, -22.179876894955203],
                  [-44.88247012050197, -22.20403658383288],
                  [-44.904442939893976, -22.25504512171292],
                  [-44.89826313032366, -22.264295258715478],
                  [-44.83646503462054, -22.24316484059121],
                  [-44.75469173109279, -22.257362706439988],
                  [-44.7605282179092, -22.336047109426183],
                  [-44.921359348434386, -22.404912546454597],
                  [-44.9330323220672, -22.447121192465037],
                  [-45.130099582809386, -22.488682568160925],
                  [-45.27223520292657, -22.53245128555434],
                  [-45.443123196922706, -22.610359304652818],
                  [-45.54920992787974, -22.67468209786707],
                  [-45.50076425154105, -22.56809750107321],
                  [-45.65251290876761, -22.65430334131575],
                  [-45.63980996687308, -22.757552284769485],
                  [-45.61776990573941, -22.828480649696434],
                  [-45.49520368259488, -22.790187185580056],
                  [-45.40490979831753, -22.73415175496418],
                  [-45.23690908510708, -22.61280119302714],
                  [-45.19788464338438, -22.563950101106006],
                  [-45.05506237775938, -22.508139421844966],
                  [-44.83488370084669, -22.46957274198613],
                  [-44.73017026090528, -22.433400543159152],
                  [-44.591811191081064, -22.468303701802263],
                  [-44.542372714518564, -22.380076959203212],
                  [-44.57804619273367, -22.30446831237171],
                  [-44.49394494919129, -22.235854108051416],
                  [-44.483301943820194, -22.134442094493025],
                  [-44.39349665896457, -22.097452229186125],
                  [-44.395899918241916, -22.05418344315236],
                  [-44.49443354861301, -22.1038141678545],
                  [-44.58507075564426, -22.130213146870194],
                  [-44.63073268191379, -22.088545033208575],
                  [-44.627510774776084, -22.148743232032864],
                  [-44.726387727901084, -22.225039730716517]]]),
            {
              "remap": 100,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.09283435836307, -22.52422081459221],
                  [-43.02519977584354, -22.522635139009335],
                  [-43.03069293990604, -22.43856831693953],
                  [-43.11480701461307, -22.437298992929666],
                  [-43.14124286666385, -22.493455461370907]]]),
            {
              "remap": 100,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.674720766380645, -22.389312419302254],
                  [-42.7602081321033, -22.292458920995458],
                  [-42.795570375755645, -22.383598344334267]]]),
            {
              "remap": 100,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.919098772735666, -21.93655636649111],
                  [-41.7179116389466, -21.80114423846042],
                  [-41.77661982986457, -21.798275299848818],
                  [-41.86760035964973, -21.83588570894301],
                  [-41.93969813797004, -21.881451168780202]]]),
            {
              "remap": 100,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.40873471184143, -20.5899811453691],
                  [-42.42761746330628, -20.658100942954242],
                  [-42.36410275383362, -20.588052783247328]]]),
            {
              "remap": 100,
              "system:index": "4"
            })]),
    remap11para50 = /* color: #98ff00 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.049017512933794, -21.4644484270782],
                  [-41.08609637035567, -21.48297891749711],
                  [-41.16300066723067, -21.567294775431936],
                  [-41.18154009594161, -21.614541324718672],
                  [-41.19252642406661, -21.68155385814459],
                  [-41.16167454492366, -21.783454975759764],
                  [-41.08477024804866, -21.8746047848508],
                  [-41.00016468638064, -21.973369638728478],
                  [-40.98093861216189, -22.030030506320433],
                  [-40.943675185949246, -21.812793423598592],
                  [-40.98893732651759, -21.52057731096301],
                  [-40.99374384507228, -21.46179798609512]]]),
            {
              "remap": 100,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.61390077546772, -27.81781915099373],
                  [-48.63244020417866, -27.849393842208794],
                  [-48.63381349519428, -27.86032140205998],
                  [-48.63244020417866, -27.87944198107302],
                  [-48.62420045808491, -27.891276838773567],
                  [-48.612870807206, -27.900379695144565],
                  [-48.56926881745991, -27.906751239035053],
                  [-48.55141603425678, -27.88581475749381],
                  [-48.58609163240131, -27.812049705431722]]]),
            {
              "remap": 100,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.654020224471815, -28.5215798743317],
                  [-48.604971332274204, -28.21486513434648],
                  [-48.63655702563358, -28.143141603852524],
                  [-48.67397920580936, -28.173107915329947],
                  [-48.68393556567264, -28.18309482126405],
                  [-48.68874208422733, -28.19852729590894],
                  [-48.690802020750766, -28.20730163087828],
                  [-48.714834613524204, -28.244811346599157],
                  [-48.745265241223436, -28.292777807855668],
                  [-48.75247501905547, -28.347481562519715],
                  [-48.77204441602812, -28.359869109649694],
                  [-48.80603336866484, -28.353826584289962],
                  [-48.82182621534453, -28.37316145460969],
                  [-48.83843441143932, -28.431673194640723],
                  [-48.806162072572135, -28.487814117415002],
                  [-48.73646755352917, -28.525224825707582]]]),
            {
              "remap": 100,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.56184723071583, -29.27141917278124],
                  [-49.44786407641895, -29.114368706651597],
                  [-49.16977947426071, -28.90432795193533],
                  [-48.828767669338994, -28.635817596150623],
                  [-48.878206145901494, -28.60025478260721],
                  [-48.96815670742493, -28.620750077838952],
                  [-49.04240155159951, -28.65653532015391],
                  [-49.115185975427636, -28.69990910943194],
                  [-49.16325116097451, -28.736642287515526],
                  [-49.187235286097874, -28.78301434789331],
                  [-49.216074397426, -28.80227049235387],
                  [-49.247660090785374, -28.80227049235387],
                  [-49.26825945601975, -28.81550702813153],
                  [-49.34516375289475, -28.882265705843984],
                  [-49.41069814824916, -28.932383694596837],
                  [-49.51300832891322, -28.9654304607688],
                  [-49.59128591680385, -29.03089197201559],
                  [-49.63111135625697, -29.098111963567295],
                  [-49.65033743047572, -29.13950244869583],
                  [-49.69908926153041, -29.1832742422924],
                  [-49.7203752722726, -29.23361868485366],
                  [-49.7203752722726, -29.28813057293878],
                  [-49.6984026160226, -29.324655233950512],
                  [-49.69702932500697, -29.36296213462254]]]),
            {
              "remap": 100,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-40.92436286654894, -21.193415452998497],
                  [-40.966934888033315, -21.207499280243542],
                  [-40.993370740084096, -21.23374282813208],
                  [-40.99646064486925, -21.250382658700545],
                  [-40.98581763949816, -21.28845519845498],
                  [-40.947708813814565, -21.31692317811509]]]),
            {
              "remap": 100,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-40.76090024017171, -20.896871422485667],
                  [-40.77840970062093, -20.88789042427144],
                  [-40.798665743101395, -20.908096914444382],
                  [-40.82733319305257, -20.926697308423655],
                  [-40.84106610320882, -20.935554804628605],
                  [-40.84381268524007, -20.943090068367628],
                  [-40.8484475424178, -20.948861503244164],
                  [-40.8539407064803, -20.957838848440385],
                  [-40.85823224090413, -20.96457150380835],
                  [-40.85531399749593, -20.974189057077258],
                  [-40.842611055601395, -20.992620970930975],
                  [-40.83007977508382, -20.981562095510515],
                  [-40.80484555267171, -20.97755505453474]]]),
            {
              "remap": 100,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-39.803069784536255, -19.664321574082635],
                  [-39.74882478941907, -19.570213632058483],
                  [-39.820579244985474, -19.56342020756094],
                  [-39.863494589223755, -19.552744247895234],
                  [-39.95550508727063, -19.656238863766525],
                  [-40.02723307597659, -19.725077874725418],
                  [-40.06056184996594, -19.817169516432557]]]),
            {
              "remap": 100,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-39.73179611203709, -19.542095676998528],
                  [-39.67510395364138, -19.397774674387517],
                  [-39.66821363170175, -19.26613975196666],
                  [-39.71765210826425, -19.098497031831595],
                  [-39.721428658557215, -19.148450996928208],
                  [-39.7203986902955, -19.16596374403238],
                  [-39.7203986902955, -19.185420170029104],
                  [-39.71715208168802, -19.21615824824013],
                  [-39.71509214516458, -19.23658120364689],
                  [-39.716808758934114, -19.25829806759868],
                  [-39.72333189125833, -19.27579911909679],
                  [-39.7271084415513, -19.321163506544526],
                  [-39.74353978883566, -19.337501286411136],
                  [-39.75727269899191, -19.363415548882898],
                  [-39.76928899537863, -19.391916480602127],
                  [-39.75315282594504, -19.394183386019865],
                  [-39.74765966188254, -19.402603043968956],
                  [-39.76001928102316, -19.43206841418348],
                  [-39.77120384505677, -19.454514902795037],
                  [-39.83986839583802, -19.53801343161505],
                  [-39.83677849105286, -19.547719764799837],
                  [-39.75163444808411, -19.5677776697999]]]),
            {
              "remap": 100,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-39.39840969085111, -17.963934652042155],
                  [-39.343134727472204, -17.910366428802817],
                  [-39.36304744719877, -17.891417691541083],
                  [-39.37987026214017, -17.902852516572114],
                  [-39.41042598723783, -17.911346480835732],
                  [-39.4526546859683, -17.930293088179358],
                  [-39.47634395598783, -17.944991645774635],
                  [-39.48664363860502, -17.95805600522171],
                  [-39.50174983977689, -17.96785364128576],
                  [-39.506899681085486, -17.974058529800732],
                  [-39.50449642180814, -17.978956972018114],
                  [-39.52131923674955, -17.996916763885363],
                  [-39.52921566008939, -18.01160977896251],
                  [-39.53196224212064, -18.02271035574218],
                  [-39.53779872893705, -18.029892709074595],
                  [-39.55496486663236, -18.047520879163073],
                  [-39.55942806243314, -18.064168083972497],
                  [-39.54741176604642, -18.082445550663245],
                  [-39.53367885589017, -18.083424646960136]]]),
            {
              "remap": 100,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-39.109874551386845, -17.696704560639887],
                  [-39.167896096797, -17.560916680332973],
                  [-39.23656064757825, -17.550769389806582],
                  [-39.25853330382825, -17.54978736377907],
                  [-39.265399758906376, -17.574009118064048],
                  [-39.26059324035169, -17.612626286892635],
                  [-39.25784665832044, -17.618516315656002],
                  [-39.261966531367314, -17.626369388222123],
                  [-39.26230985412122, -17.636185248017274],
                  [-39.26608640441419, -17.64272885756952],
                  [-39.27672940978528, -17.644037550961805],
                  [-39.28222257384778, -17.65974112990987],
                  [-39.260936563105595, -17.667592405648342],
                  [-39.26394887953555, -17.67888099531031],
                  [-39.27905508070742, -17.69654400324744],
                  [-39.281458339984766, -17.720419011329945],
                  [-39.25914236098086, -17.743963851032387],
                  [-39.23785635023867, -17.752138418741623],
                  [-39.1952843287543, -17.750176556536537],
                  [-39.157175503070704, -17.721727139130824]]]),
            {
              "remap": 100,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-39.16661687659206, -17.538211839116215],
                  [-39.16181035803737, -17.414753763644082],
                  [-39.230131586064715, -17.387889739923857],
                  [-39.2184586124319, -17.448492000467223],
                  [-39.21159215735378, -17.528718040257285]]]),
            {
              "remap": 100,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-39.077713699019206, -16.901312713408863],
                  [-39.14122840849186, -16.842503202767148],
                  [-39.15324470487858, -16.895728239731632],
                  [-39.126465530073894, -16.92857570914814]]]),
            {
              "remap": 100,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-38.98487603829344, -16.331816872004797],
                  [-39.021268250207505, -16.31666069075933],
                  [-39.0313949651408, -16.358993915698537],
                  [-39.037747742395005, -16.37859593015883],
                  [-39.030537964562974, -16.40362800041947],
                  [-39.00358292621504, -16.372335335768177]]]),
            {
              "remap": 100,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-38.91176031175317, -16.08242450284624],
                  [-38.86544536124408, -15.964911111889728],
                  [-38.83944395313988, -15.832132070002293],
                  [-38.923214705093, -15.67947653931688],
                  [-38.944844038589096, -15.723690011039514],
                  [-38.969563276870346, -15.77226411199599],
                  [-39.000805647475815, -15.82353024445065],
                  [-39.01488188038597, -15.846320550152234],
                  [-38.97642973194847, -15.903119959855063],
                  [-38.96033847394567, -15.930436870154223],
                  [-38.95484530988317, -15.95288497540502],
                  [-38.94935214582067, -15.974010307567593],
                  [-38.94351565900426, -16.017904254956],
                  [-38.956218600898794, -16.03440324396218],
                  [-38.955786091799496, -16.052303829583014],
                  [-38.96196590136981, -16.096180543433785],
                  [-38.966772419924496, -16.120918778293504],
                  [-38.959562642092465, -16.147632604752744],
                  [-38.93587337207293, -16.15818522187777],
                  [-38.944799763674496, -16.106172014782665]]]),
            {
              "remap": 100,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-38.961396912648055, -15.26951534987307],
                  [-39.005342225148055, -15.287068356693661],
                  [-39.00671551616368, -15.344022699737616],
                  [-39.00499890239415, -15.379445766575333],
                  [-38.9583070078629, -15.383087049067807]]]),
            {
              "remap": 100,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-38.96756350540422, -15.243182595726193],
                  [-38.96777239191773, -15.008873331607356],
                  [-39.01137438166382, -14.849641178161082],
                  [-39.037466910960696, -14.876851685371324],
                  [-39.00994954936608, -15.012758231926249],
                  [-39.01338277690514, -15.115199405772977],
                  [-39.01147619189041, -15.1816623717549],
                  [-39.00289312304275, -15.26878701874314],
                  [-38.97199407519119, -15.264812535363584]]]),
            {
              "remap": 100,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-38.94036779287818, -13.860461097491322],
                  [-38.955130671296146, -13.920785235725525],
                  [-38.959937189850834, -13.934114415858842],
                  [-38.958907221589115, -13.944444001360043],
                  [-38.927664850983646, -13.979094715224779],
                  [-38.90981206778052, -13.878793297538842]]]),
            {
              "remap": 100,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-38.94512751659996, -13.71041612867648],
                  [-38.95680049023277, -13.68006201666657],
                  [-38.97705653271324, -13.674724625053031],
                  [-38.98254969677574, -13.691403571968564],
                  [-38.990446120115585, -13.698408377058158],
                  [-39.00829890331871, -13.727995351071327],
                  [-39.016195326658554, -13.753007652695764],
                  [-39.02100184521324, -13.772015215005725],
                  [-39.028898268553085, -13.792354929378233],
                  [-39.039884596678085, -13.795022301492788],
                  [-39.048124342771835, -13.814359837165721],
                  [-39.03130152783043, -13.843696481470728],
                  [-38.98941615185387, -13.849363361416916],
                  [-38.94409754833824, -13.836696027314265]]]),
            {
              "remap": 100,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-38.951577498560994, -13.386684545053297],
                  [-38.89768791449224, -13.253052055156795],
                  [-38.940946581484425, -13.213615733553373],
                  [-38.99347496283208, -13.257396344082977],
                  [-39.01029777777349, -13.310189952956797],
                  [-38.99725151312505, -13.370654564773664]]]),
            {
              "remap": 100,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-37.192297027766045, -11.306437237119733],
                  [-37.13658955195911, -11.188364775542928],
                  [-37.032466888692504, -10.988641928328505],
                  [-37.07118945437798, -10.983011627530692],
                  [-37.17538502315052, -11.101794850769107],
                  [-37.18877461055286, -11.126050500623123],
                  [-37.222420240435675, -11.175229365195698],
                  [-37.25605183181435, -11.216206580181494],
                  [-37.37076756455811, -11.346157973490007],
                  [-37.3814105699292, -11.361305157453907],
                  [-37.414026231550295, -11.411116882460188],
                  [-37.40063664414795, -11.437701998426109],
                  [-37.375574083112795, -11.451834841873119],
                  [-37.29626652696045, -11.45856451917682]]]),
            {
              "remap": 100,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-36.83233155097724, -10.746160250895231],
                  [-36.86700714912177, -10.740763372793625],
                  [-36.89893616523505, -10.76909590595674],
                  [-36.999186409375675, -10.863855571694373],
                  [-36.97137726630927, -10.891502202318515],
                  [-36.92537201728583, -10.866215749963057]]]),
            {
              "remap": 100,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-36.60948075495523, -10.61986229692683],
                  [-36.38883632890416, -10.527662445630963],
                  [-36.28839012612145, -10.419444726679892],
                  [-36.26077694169713, -10.290954277981552],
                  [-36.39278980424378, -10.327182572618295],
                  [-36.423174474186524, -10.341119174299005],
                  [-36.49217647782994, -10.37843226700334],
                  [-36.56908077470494, -10.390927130930896],
                  [-36.66933101884557, -10.567827506714458],
                  [-36.67928737870885, -10.584702016867304],
                  [-36.696110193650256, -10.604612744308975],
                  [-36.716366236130725, -10.626209356769495],
                  [-36.73387569657994, -10.643755480016143],
                  [-36.75996822587682, -10.660288402880994],
                  [-36.77610439531041, -10.674458764978583],
                  [-36.7754177498026, -10.683905306121055],
                  [-36.75790828935338, -10.684580047819349]]]),
            {
              "remap": 100,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-35.07525071124523, -6.016196904867174],
                  [-35.169321145815545, -5.772360643018036],
                  [-35.20571335772961, -5.78739004637369],
                  [-35.210519876284295, -5.874142850230568],
                  [-35.18623701214159, -5.995282989867575],
                  [-35.12787214397753, -6.125016532149291],
                  [-35.10589948772753, -6.191919449378804],
                  [-35.04135480999315, -6.148911398323108]]]),
            {
              "remap": 100,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-35.17262940185438, -5.609950080898986],
                  [-35.255510567043586, -5.371996451717033],
                  [-35.458070991848274, -5.132679783133318],
                  [-35.55900788149671, -5.118317885465175],
                  [-35.49216541571514, -5.2813922179418205],
                  [-35.415947764347955, -5.347026851749128],
                  [-35.36127675122396, -5.447120515713765],
                  [-35.315271502200524, -5.496333718025339],
                  [-35.2974187189974, -5.558527914411316],
                  [-35.30016530102865, -5.600898223954403],
                  [-35.252100115481774, -5.641898824132904],
                  [-35.243860369388024, -5.674013937637336],
                  [-35.175195818606774, -5.703394283676904]]]),
            {
              "remap": 100,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.42235487732291, -22.239380433618322],
                  [-41.157309711307285, -22.12811222799156],
                  [-41.165549457401035, -22.10266713583069],
                  [-41.40793532165885, -22.12429575694266],
                  [-41.56517714294791, -22.15991213216716],
                  [-41.75194472107291, -22.306734264532356],
                  [-41.73271864685416, -22.354370667919397]]]),
            {
              "remap": 100,
              "system:index": "24"
            })]),
    remap22_para33 = 
    /* color: #0b4a8b */
    /* shown: false */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-38.514633040756145, -12.886157275899157],
                  [-38.540930025239426, -12.923252870198294],
                  [-38.542169809440566, -12.981899023620691],
                  [-38.551439523796034, -13.013177272639078],
                  [-38.53598999987025, -13.016856807404189],
                  [-38.493761301139784, -13.017191307856109],
                  [-38.49513459215541, -13.012508260450316],
                  [-38.50165772447963, -13.013010019761142],
                  [-38.50886750231166, -13.012675513666753],
                  [-38.51607728014369, -13.011170230657045],
                  [-38.519682169059706, -13.010333958369596],
                  [-38.52105546007533, -13.011337484776085],
                  [-38.526720285514784, -13.011337484776085],
                  [-38.5303251744308, -13.010668467623026],
                  [-38.53238511095424, -13.012341007121046],
                  [-38.53410172472377, -13.011504738782307],
                  [-38.53478837023158, -13.005985297015394],
                  [-38.53410172472377, -13.001971080406319],
                  [-38.53238511095424, -12.99929489992086],
                  [-38.5303251744308, -12.997622272463087],
                  [-38.528951883415175, -12.993273388328216],
                  [-38.5248320103683, -12.987251730709513],
                  [-38.52149959110986, -12.98193607665539],
                  [-38.52287288212548, -12.978088747797722],
                  [-38.518581347701655, -12.977252364079893],
                  [-38.518066363570796, -12.97591414427909],
                  [-38.518581347701655, -12.972903123395303],
                  [-38.510856585738765, -12.966546404050685],
                  [-38.50879664921533, -12.960691387302344],
                  [-38.508110003707515, -12.953665185440112],
                  [-38.50296016239892, -12.94948282832338],
                  [-38.50399013066064, -12.94262361069141],
                  [-38.514118151900874, -12.933087311665469],
                  [-38.52167125248681, -12.927064198145393],
                  [-38.50107188725244, -12.917025352680172],
                  [-38.49849696659814, -12.907655399606456],
                  [-38.494377093551265, -12.908157370283027],
                  [-38.4935187866665, -12.911503815701389],
                  [-38.49025722050439, -12.913344341583764],
                  [-38.48476405644189, -12.913846300835516],
                  [-38.48218913578759, -12.907655399606456],
                  [-38.497123675582515, -12.903639597914383],
                  [-38.51566310429345, -12.904308902674927],
                  [-38.527851062057124, -12.926562265457672]]]),
            {
              "remap": 100,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-38.36666093382255, -12.964124669007584],
                  [-38.357047896713176, -12.960109776157482],
                  [-38.36116776976005, -12.954087315488861],
                  [-38.36614594969169, -12.950741441081691],
                  [-38.376788955062786, -12.955760235839387]]]),
            {
              "remap": 100,
              "system:index": "1"
            })]);

// Define the input and output versions and prefixes for the Landsat data
var vesion_in = '33';
var version_out = '34';
var prefixo_in = 'MA_S2_p08a_v';
var prefixo_out = 'MA_S2_p08b_v';

// Define the output directory for the processed data
var dirout = 'projects/mapbiomas-workspace/COLECAO9/classificacao-ma-S2/';

// Import the palettes module
var palettes = require('users/mapbiomas/modules:Palettes.js');

// Define the visualization parameters for the classification
var vis = {
    'min': 0,
    'max': 69,
    'palette': palettes.get('classification9')
};

// Load the input Landsat 8 image
var S2_v2 =  ee.Image(dirout+prefixo_in+vesion_in);

// Add the input image to the map
Map.addLayer(S2_v2.select('classification_2023'), vis, 'S2_v2', false);
Map.addLayer(S2_v2, {}, 'S2_v2', false);

// Define the years to process
var anos = ['2016','2017','2018','2019','2020','2021','2022','2023'];

// Create a list of images for natural classes
var countNaturais = anos.map(function (ano) {
        // Remap the classification to include only natural classes
        var image = S2_v2.select('classification_'+ano).remap(
                  [3, 4, 5, 49, 11,12,32,29,50,13,33],
                  [3, 4, 3,  3, 11,12,32,29,50,13,33]);
        // Convert the image to int8
        return image.int8();
    }
);

// Calculate the mode of the natural classes
var moda_natural = ee.ImageCollection.fromImages(countNaturais).mode();

// Add the mode image to the map
Map.addLayer(moda_natural, vis, 'moda_natural', false);

//  var amostraTotal = remove_reflo_3
  
//  var amostraTotalimg = amostraTotal.reduceToImage({properties: ['reference'],reducer: ee.Reducer.first()});
//  amostraTotalimg = amostraTotalimg.select([0],['reference']);

// Define the years to process
var anos = ['2016','2017','2018','2019','2020','2021','2022','2023'];
            
// Loop through the years and blend the classification with the mode image
for (var i_ano=0;i_ano<anos.length; i_ano++){
  var ano = anos[i_ano];
  // Create a mask for natural classes in the current year
  var mask_nat_ano = S2_v2.select('classification_'+ano).remap(
                  [3, 4, 5, 49, 11,12,32,29,50,13],
                  [1, 1, 1,  1,  1, 1, 1, 1, 1, 1]);
  // Mask the mode image with the natural class mask
  var moda_natural_ano = moda_natural.mask(mask_nat_ano);
  // Blend the original classification with the masked mode image
  var corrige_ano = S2_v2.select('classification_'+ano).blend(moda_natural_ano);
  
  // Combine the corrected classifications for all years
  if (i_ano == 0){ var corrige = corrige_ano.rename('classification_'+ano); }  
  else {corrige = corrige.addBands(corrige_ano.rename('classification_'+ano)); }
}
// Print the corrected classification image to the console
print('corrige',corrige);

// Define the years to process
var anos = [2016,2017,2018,2019,2020,2021,2022,2023];

// Loop through the years and apply remapping rules to the classification
for (var i_ano=0;i_ano<anos.length; i_ano++){
  var ano = anos[i_ano];

  // Select the classification for the current year
  var class_ano = corrige.select('classification_'+ano);

  // Apply remapping rule 1: remap class 29 to 12
  var class_remap1 = class_ano.add(remap_29_para12.reduceToImage({properties: ['remap'],reducer: ee.Reducer.first()}))
                                        .remap([3,4,9,11,12,13,19,21,22,25,29,33,50,103,104,109,111,112,113,119,121,122,125,129,133,150],
                                               [3,4,9,11,12,13,19,21,22,25,29,33,50,  3,  4,  9, 11, 12, 50, 19, 21, 22, 25, 12, 33, 50])
                                        .rename('classification_'+ano);
  // Apply remapping rule 2: remap class 29 to 4
  var class_remap2 = class_ano.add(remap_29_para_4.reduceToImage({properties: ['remap'],reducer: ee.Reducer.first()}))
                                        .remap([3,4,9,11,12,13,19,21,22,25,29,33,50,103,104,109,111,112,113,119,121,122,125,129,133,150],
                                               [3,4,9,11,12,13,19,21,22,25,29,33,50,  3,  4,  9, 11, 12, 50, 19, 21, 22, 25,  4, 33, 50])
                                        .rename('classification_'+ano);
  // Apply remapping rule 3: remap class 11 to 12
  var class_remap3 = class_ano.add(remap_11_para_12.reduceToImage({properties: ['remap'],reducer: ee.Reducer.first()}))
                                        .remap([3,4,9,11,12,13,19,21,22,25,29,33,50,103,104,109,111,112,113,119,121,122,125,129,133,150],
                                               [3,4,9,11,12,13,19,21,22,25,29,33,50,  3,  4,  9, 12, 12, 50, 19, 21, 22, 25, 29, 33, 50])
                                        .rename('classification_'+ano);
  // Apply remapping rule 4: remap class 11 to 50
  var class_remap4 = class_ano.add(remap11para50.reduceToImage({properties: ['remap'],reducer: ee.Reducer.first()}))
                                        .remap([3,4,9,11,12,13,19,21,22,25,29,33,50,103,104,109,111,112,113,119,121,122,125,129,133,150],
                                               [3,4,9,11,12,13,19,21,22,25,29,33,50,  3,  4,  9, 50, 12, 50, 19, 21, 22, 25, 29, 33, 50])
                                        .rename('classification_'+ano);
  // Apply remapping rule 5: remap class 22 to 33
  var class_remap5 = class_ano.add(remap22_para33.reduceToImage({properties: ['remap'],reducer: ee.Reducer.first()}))
                                        .remap([3,4,9,11,12,13,19,21,22,25,29,33,50,103,104,109,111,112,113,119,121,122,125,129,133,150],
                                               [3,4,9,11,12,13,19,21,22,25,29,33,50,  3,  4,  9, 11, 12, 50, 19, 21, 33, 25, 29, 33, 50])
                                        .rename('classification_'+ano);

  // Blend the original classification with the remapped classifications
  var class_corr = class_ano.blend(class_remap1).blend(class_remap2).blend(class_remap3).blend(class_remap4).blend(class_remap5);

  // Combine the corrected classifications for all years
  if (i_ano == 0){ var class_corr_remap = class_corr; }  
  else {class_corr_remap = class_corr_remap.addBands(class_corr); }
}

// Print the final corrected classification image to the console
print('class_corr_remap',class_corr_remap);

// Add the corrected classification image to the map
Map.addLayer(class_corr_remap.select('classification_2023'), vis, 'colS2 corrigido', false);

// Set metadata for the corrected classification image
class_corr_remap = class_corr_remap
.set('territory', 'BRAZIL')
.set('biome', 'MATA ATÂNTICA')
.set('source', 'arcplan')
//.set('version', version_out)
.set('collection_id', 2)
.set('description', 'Ajusta transição menor/igual que 0.25ha em falsas transicoes');

// Export the corrected classification image to an asset
Export.image.toAsset({
    "image": class_corr_remap.toInt8(),
    'description': prefixo_out+version_out,
    'assetId': dirout+prefixo_out+version_out,
    "scale": 10,
    "pyramidingPolicy": {
        '.default': 'mode'
    },
    "maxPixels": 1e13,
    "region": limite_MA2
});
