var varzea = /* color: #cf21d6 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.2598596436163, -26.17928270370584],
                  [-52.26191958013974, -26.185598664609543],
                  [-52.25848635260068, -26.181747509665087],
                  [-52.25762804571591, -26.179744858794017],
                  [-52.2543664795538, -26.1775881193701]]]),
            {
              "reference": 11,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.45102363855502, -26.40392845007053],
                  [-52.45205360681674, -26.406004108789293],
                  [-52.45025116235873, -26.40538910269086],
                  [-52.449907839604826, -26.403390310234197]]]),
            {
              "reference": 11,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.37967973017936, -26.403648359691573],
                  [-52.38002305293327, -26.407107778544038],
                  [-52.381825497391276, -26.408260895114214],
                  [-52.38474374079948, -26.41148956020067],
                  [-52.382597973587565, -26.410874583340796],
                  [-52.380881359818034, -26.408722138515532],
                  [-52.37873559260612, -26.408260895114214],
                  [-52.377877285721354, -26.405493395985726]]]),
            {
              "reference": 11,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.3308420684362, -26.432243106472512],
                  [-52.33410363459831, -26.427324085128628],
                  [-52.33504777217155, -26.429399322856376],
                  [-52.33170037532096, -26.43385711461049]]]),
            {
              "reference": 11,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.34809403681999, -26.42501822161702],
                  [-52.347407391312174, -26.4237884088871],
                  [-52.34483247065788, -26.423480953655],
                  [-52.34551911616569, -26.422558583039766],
                  [-52.34852319026237, -26.422866040731336],
                  [-52.34946732783561, -26.42563312306283]]]),
            {
              "reference": 11,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.58337929584237, -26.738337679021765],
                  [-51.58595421649667, -26.736268032988235],
                  [-51.58561089374276, -26.739257509614287]]]),
            {
              "reference": 11,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.600202110783776, -26.72147279989782],
                  [-51.59908631183358, -26.719786174500264],
                  [-51.60063126422616, -26.719402847060646],
                  [-51.601489571110925, -26.721166142593663]]]),
            {
              "reference": 11,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.29857041140354, -26.65196514835745],
                  [-51.293935554225804, -26.65319251753966],
                  [-51.2880990674094, -26.650584342253943],
                  [-51.290673988063695, -26.64766925230272],
                  [-51.29187561770237, -26.650277494185143],
                  [-51.29462219973362, -26.651351458817757],
                  [-51.29702545901096, -26.650124069841475]]]),
            {
              "reference": 11,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.5686312977423, -26.53638000589067],
                  [-51.56433976331847, -26.541217579392825],
                  [-51.56185067335265, -26.54060329565208],
                  [-51.564253932629995, -26.537224676280392]]]),
            {
              "reference": 11,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.43411216296332, -26.479955890547814],
                  [-51.43333968676703, -26.48249112804778],
                  [-51.43179473437445, -26.48456537170652],
                  [-51.430421443358824, -26.481338754293862]]]),
            {
              "reference": 11,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.44621429003851, -26.492324247704126],
                  [-51.448360057250426, -26.496549157987744],
                  [-51.44424018420355, -26.49447513052605]]]),
            {
              "reference": 11,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.41200169562958, -26.368754109601788],
                  [-51.41260251044891, -26.37544424708095],
                  [-51.41148671149872, -26.376059412691323],
                  [-51.40977009772919, -26.369523110621127]]]),
            {
              "reference": 11,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.456032838818054, -26.354295938266684],
                  [-51.45740612983368, -26.35721848038764],
                  [-51.45629033088348, -26.359679511202277],
                  [-51.45388707160614, -26.35529576361951]]]),
            {
              "reference": 11,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.51033436368196, -25.789962855358798],
                  [-51.51024853299349, -25.79166303667356],
                  [-51.508274427158526, -25.79127663397002],
                  [-51.50818859647005, -25.789808292212232]]]),
            {
              "reference": 11,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.73445116485059, -25.714584213503827],
                  [-51.734794487604496, -25.718450679883276],
                  [-51.73393618071973, -25.719687922583557],
                  [-51.73299204314649, -25.714352221525022]]]),
            {
              "reference": 11,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.938232974374635, -25.72948830419913],
                  [-51.935743884408815, -25.731575950015777],
                  [-51.93668802198206, -25.734282102994296],
                  [-51.933254794442995, -25.733431604410633],
                  [-51.93170984205042, -25.731730588988345],
                  [-51.9335981171969, -25.72902437792834],
                  [-51.93557222303186, -25.730570791791145]]]),
            {
              "reference": 11,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.48454968376937, -25.590501959180237],
                  [-51.48454968376937, -25.59235981003662],
                  [-51.482232255180506, -25.590424548101765]]]),
            {
              "reference": 11,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.48978535576644, -25.591353477737538],
                  [-51.48961369438949, -25.59313390604462],
                  [-51.48815457268539, -25.59352095217015],
                  [-51.487467927177576, -25.591817939850557]]]),
            {
              "reference": 11,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.51836697502914, -25.56399898162395],
                  [-51.52214352532211, -25.562372978514407],
                  [-51.52214352532211, -25.564153837911782]]]),
            {
              "reference": 11,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.567118806083826, -25.553932893511117],
                  [-51.5657455150682, -25.55052571828646],
                  [-51.56797711296859, -25.55052571828646],
                  [-51.56952206536117, -25.55184213837901],
                  [-51.56952206536117, -25.553235979186667]]]),
            {
              "reference": 11,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.552076561266645, -25.538751723761923],
                  [-51.549587471300825, -25.537280269101625],
                  [-51.550617439562544, -25.53627347393109],
                  [-51.552591545397505, -25.537047932504784]]]),
            {
              "reference": 11,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.67094219954927, -25.506782887065913],
                  [-51.671371352991656, -25.504071576509805],
                  [-51.67205799849947, -25.50143767335802],
                  [-51.67300213607271, -25.501670078900663],
                  [-51.67222965987642, -25.50476877649916],
                  [-51.67325962813814, -25.506860352182343]]]),
            {
              "reference": 11,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.741826884231564, -25.476294940750122],
                  [-51.7383936566925, -25.478619462208425],
                  [-51.734788767776486, -25.479316809883123],
                  [-51.732814661941525, -25.477767142891377],
                  [-51.732814661941525, -25.474202833017962],
                  [-51.7398527783966, -25.474125346847437]]]),
            {
              "reference": 11,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.82150867014027, -25.481651335623067],
                  [-51.81893374948597, -25.481108964979242],
                  [-51.81738879709339, -25.478784491649588],
                  [-51.821594500828745, -25.478474558476893]]]),
            {
              "reference": 11,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.636376938921764, -25.25762383492256],
                  [-51.63277205000575, -25.25847770841033],
                  [-51.6314845896786, -25.25739095929302],
                  [-51.62865217695887, -25.257468584552488],
                  [-51.62693556318934, -25.254751670949805],
                  [-51.63079794417079, -25.25428590822963],
                  [-51.631827912432506, -25.256537078164207],
                  [-51.63268621931727, -25.257779085094178],
                  [-51.63569029341395, -25.25700283225144]]]),
            {
              "reference": 11,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.77302895874425, -25.365944927197685],
                  [-51.7757755407755, -25.368271577562073],
                  [-51.773372281498155, -25.37602675522309]]]),
            {
              "reference": 11,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.934042298633074, -25.21708811371746],
                  [-51.93095239384792, -25.215379779149814],
                  [-51.93155320866725, -25.21452560287132],
                  [-51.93567308171413, -25.21693281156612]]]),
            {
              "reference": 11,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.95936235173366, -25.229045783994565],
                  [-51.96039231999538, -25.227725839156054],
                  [-51.96082147343776, -25.224076505338022],
                  [-51.96253808720729, -25.224076505338022],
                  [-51.961250626880144, -25.225396489785368],
                  [-51.96107896550319, -25.228657566411695]]]),
            {
              "reference": 11,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.87219057091426, -25.247894845757184],
                  [-51.87030229576778, -25.247894845757184],
                  [-51.86849985130977, -25.24805010836397],
                  [-51.866182422720904, -25.247506688372162],
                  [-51.8647233010168, -25.246497473367576],
                  [-51.86403665550899, -25.24510008490709],
                  [-51.86669740685176, -25.247118529747056],
                  [-51.86927232750606, -25.247429056746345],
                  [-51.8713322640295, -25.245332984099846],
                  [-51.87304887779903, -25.247739582951983]]]),
            {
              "reference": 11,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.61471089862229, -25.39266056518596],
                  [-51.61556920550706, -25.39095470381169],
                  [-51.617629142030495, -25.39266056518596]]]),
            {
              "reference": 11,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.836840720399636, -25.628147252436502],
                  [-51.83649739764573, -25.625516076395208],
                  [-51.83804235003831, -25.623813519836002]]]),
            {
              "reference": 11,
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.83701238177659, -25.616074320573595],
                  [-51.83821401141526, -25.61808656060645],
                  [-51.83666905902268, -25.62164659457479]]]),
            {
              "reference": 11,
              "system:index": "31"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.83169087909104, -25.634647556496702],
                  [-51.828600974305886, -25.633564197058956],
                  [-51.83151921771409, -25.633099897148078]]]),
            {
              "reference": 11,
              "system:index": "32"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.20196446917893, -25.7224637630127],
                  [-52.202136130555886, -25.724474208030525],
                  [-52.198187918885964, -25.72462885623955]]]),
            {
              "reference": 11,
              "system:index": "33"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.22582540057542, -25.75771894505452],
                  [-52.22531041644456, -25.756172884475724],
                  [-52.226855368837136, -25.756636704762887]]]),
            {
              "reference": 11,
              "system:index": "34"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.33282717913552, -26.096282275966562],
                  [-52.335745422543724, -26.101061186393153],
                  [-52.33265551775857, -26.099827937879404]]]),
            {
              "reference": 11,
              "system:index": "35"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.522242157162864, -26.103681796304947],
                  [-51.52258547991677, -26.10167780577332],
                  [-51.52413043230935, -26.103527644406377]]]),
            {
              "reference": 11,
              "system:index": "36"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.53748358314866, -26.743514085565614],
                  [-51.53988684242601, -26.747499782956304],
                  [-51.53834189003343, -26.748112954768537]]]),
            {
              "reference": 11,
              "system:index": "37"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.917265008338205, -26.893592642212614],
                  [-51.92069823587727, -26.89833851467844],
                  [-51.91760833109211, -26.8984916040187]]]),
            {
              "reference": 11,
              "system:index": "38"
            })]),
    reflo = /* color: #0b4a8b */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.3630565935276, -26.58204593791164],
                  [-51.35859339772682, -26.58204593791164],
                  [-51.36236994801979, -26.578361498825892]]]),
            {
              "reference": 9,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.37335627614479, -26.570224609270753],
                  [-51.377476149191665, -26.566386253205753],
                  [-51.37627451955299, -26.571606385974967]]]),
            {
              "reference": 9,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.36442988454323, -26.557327223116513],
                  [-51.36528819142799, -26.561472969818507],
                  [-51.36168330251198, -26.557941417274847]]]),
            {
              "reference": 9,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.34818444691362, -26.50849520485437],
                  [-51.35041604481401, -26.50726628382963],
                  [-51.35247598133745, -26.5086488190581],
                  [-51.35041604481401, -26.509416886995403]]]),
            {
              "reference": 9,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.39144311390581, -26.490213648161102],
                  [-51.396249632460496, -26.49098183932098],
                  [-51.391786436659714, -26.493132747260354]]]),
            {
              "reference": 9,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.564261148752315, -26.427899948845077],
                  [-51.568037699045284, -26.425901546448525],
                  [-51.56735105353747, -26.430666910357697]]]),
            {
              "reference": 9,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.59979505378161, -26.42528664643434],
                  [-51.59567518073474, -26.427746226813678],
                  [-51.596705148996456, -26.425132920918358]]]),
            {
              "reference": 9,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.62863416510974, -26.44711358826779],
                  [-51.622969339670284, -26.448035762374314],
                  [-51.62605924445544, -26.44526921790571]]]),
            {
              "reference": 9,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.67401117456335, -26.3790126768894],
                  [-51.67692941797155, -26.381011891397907],
                  [-51.673324529055535, -26.381011891397907]]]),
            {
              "reference": 9,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.704051915530144, -26.38485643743637],
                  [-51.69958871972936, -26.384548878462326],
                  [-51.70233530176061, -26.38254972516857]]]),
            {
              "reference": 9,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.6686896718778, -26.357480482354728],
                  [-51.666286412600456, -26.357480482354728],
                  [-51.66937631738561, -26.353942666812518]]]),
            {
              "reference": 9,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.37119630178126, -26.34571552646398],
                  [-51.37428620656642, -26.345869357721977],
                  [-51.372054608666026, -26.350176549901043]]]),
            {
              "reference": 9,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.27658123707574, -26.514218196359995],
                  [-51.282417723892145, -26.515600647913516],
                  [-51.27606625294488, -26.51713668567686]]]),
            {
              "reference": 9,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.20156521534722, -26.52174467568484],
                  [-51.19693035816949, -26.520515896431505],
                  [-51.200020262954645, -26.517904696853652]]]),
            {
              "reference": 9,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.360351989028864, -26.54938873120045],
                  [-51.36275524830621, -26.544781851170658],
                  [-51.36224026417535, -26.5506172012856]]]),
            {
              "reference": 9,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.43605465626519, -26.547853125086597],
                  [-51.43777127003472, -26.551077874174407],
                  [-51.43227810597222, -26.547238876883377]]]),
            {
              "reference": 9,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.200588234422256, -25.3179811971057],
                  [-52.19904328202968, -25.31922257494198],
                  [-52.197841652391006, -25.31782602398149],
                  [-52.19715500688319, -25.316119106493773]]]),
            {
              "reference": 9,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.565691378561546, -25.15205234257679],
                  [-51.56577720925002, -25.154150021616385],
                  [-51.56388893410354, -25.154344249332933],
                  [-51.56303062721877, -25.152246573632443]]]),
            {
              "reference": 9,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.5653051404634, -25.16137508447757],
                  [-51.562472727743675, -25.160986651122474],
                  [-51.56401768013625, -25.158267583002104]]]),
            {
              "reference": 9,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.58101215645461, -25.154188867184427],
                  [-51.579939272848655, -25.15512115710727],
                  [-51.57903805061965, -25.15399463922053]]]),
            {
              "reference": 9,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.57732143685012, -25.163084176544352],
                  [-51.57714977547317, -25.164715560266874],
                  [-51.575733569113304, -25.163394917983446]]]),
            {
              "reference": 9,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.58702030464797, -25.161880045989896],
                  [-51.58423080727248, -25.16273459147901],
                  [-51.584445383993675, -25.16028746796612],
                  [-51.58556118294387, -25.16063706004527]]]),
            {
              "reference": 9,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.55927354972359, -25.14772788893718],
                  [-51.559681245493856, -25.149087548014958],
                  [-51.558973142313924, -25.14957313687175],
                  [-51.55841524283883, -25.148349449252255]]]),
            {
              "reference": 9,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.55766422431466, -25.148524262520517],
                  [-51.55624801795479, -25.148737922841704],
                  [-51.55710632483956, -25.14757249836379]]]),
            {
              "reference": 9,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.55624801795479, -25.152603167692266],
                  [-51.554123708415, -25.15508929063262],
                  [-51.55214960258004, -25.155885616175173],
                  [-51.55133421103951, -25.15538062984868],
                  [-51.55262167136666, -25.153418932365856],
                  [-51.55390913169381, -25.151554319383983],
                  [-51.55652696769234, -25.15184566704059]]]),
            {
              "reference": 9,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.590909847778065, -25.146963730083556],
                  [-51.59020174459813, -25.14822627906309],
                  [-51.58908594564794, -25.147196817032025],
                  [-51.58970821813939, -25.146245042523624]]]),
            {
              "reference": 9,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.58683259974231, -25.14502483843623],
                  [-51.58601720820178, -25.146617615680636],
                  [-51.58608158121814, -25.144616928725778]]]),
            {
              "reference": 9,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.643947140710594, -25.13759866239132],
                  [-51.64257384969497, -25.14004624091187],
                  [-51.64085723592544, -25.139385788049363],
                  [-51.6422734422853, -25.13787061798316]]]),
            {
              "reference": 9,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.64707996083999, -25.136161172772283],
                  [-51.6463074846437, -25.140007390842374],
                  [-51.645148770349266, -25.140085090969],
                  [-51.64502002431655, -25.137171302380334]]]),
            {
              "reference": 9,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.62124492360854, -25.127652441793362],
                  [-51.61927081777358, -25.129167738635637],
                  [-51.618970410363914, -25.12757473375631]]]),
            {
              "reference": 9,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.63798190786147, -25.137482109809383],
                  [-51.63914062215591, -25.139113835832255],
                  [-51.63635112478042, -25.1380648716065]]]),
            {
              "reference": 9,
              "system:index": "30"
            })]),
    agro = /* color: #d2470b */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.848937499751905, -25.06190040200929],
                  [-51.85185574316011, -25.061628277452005],
                  [-51.84958122991548, -25.062716772054824]]]),
            {
              "reference": 21,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.864944923152784, -25.06022877018235],
                  [-51.86704777502046, -25.060034392908474],
                  [-51.86571739934907, -25.060850775386733]]]),
            {
              "reference": 21,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.8570055844687, -25.053075483407586],
                  [-51.854688155879835, -25.053580892375837],
                  [-51.85485981725679, -25.052453438739693]]]),
            {
              "reference": 21,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.838165748348096, -25.04759360611082],
                  [-51.835934150447706, -25.04759360611082],
                  [-51.837736594905714, -25.046854894684365]]]),
            {
              "reference": 21,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.00137351187597, -25.149289122348637],
                  [-52.00206015738378, -25.151076076862154],
                  [-52.00000022086034, -25.150687610715536]]]),
            {
              "reference": 21,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.99914191397558, -25.155116051477357],
                  [-52.00111601981054, -25.154261452617742],
                  [-52.002231818760734, -25.15581526427377]]]),
            {
              "reference": 21,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.02154372366796, -25.146569793537182],
                  [-52.01682303580175, -25.149289122348637],
                  [-52.01828215750585, -25.1472690553041]]]),
            {
              "reference": 21,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.99416373404394, -25.138022937148623],
                  [-51.99227545889745, -25.139887756848918],
                  [-51.992704612339836, -25.13786753422131]]]),
            {
              "reference": 21,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.02598788719806, -25.185600240541575],
                  [-52.02409961205158, -25.186920642273673],
                  [-52.024442934805485, -25.18839636845141],
                  [-52.02315547447834, -25.187308993000915],
                  [-52.024442934805485, -25.185677911627813]]]),
            {
              "reference": 21,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.110949311686156, -25.25645348938723],
                  [-52.10880354447424, -25.25614298545638],
                  [-52.1107776503092, -25.25536672215619]]]),
            {
              "reference": 21,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.14008171075981, -25.288495321738406],
                  [-52.14076835626762, -25.289814606215014],
                  [-52.13862258905571, -25.289116163279942]]]),
            {
              "reference": 21,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.13673431390922, -25.30300666149354],
                  [-52.135446853582074, -25.303161853599615],
                  [-52.13604766840141, -25.302075504683778]]]),
            {
              "reference": 21,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.18690590860558, -25.348770709766335],
                  [-52.18776421549035, -25.350244469546954],
                  [-52.18613343240929, -25.350554732475487]]]),
            {
              "reference": 21,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.15919842023909, -25.378180029400987],
                  [-52.15971340436995, -25.376939256547086],
                  [-52.16022838850081, -25.378877958530072]]]),
            {
              "reference": 21,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.1514736582762, -25.39306830933255],
                  [-52.15181698103011, -25.391439993135055],
                  [-52.15276111860335, -25.39291323254584]]]),
            {
              "reference": 21,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.14346679745222, -25.44035092015043],
                  [-52.14226516781355, -25.439420821241804],
                  [-52.144067612271556, -25.43903327791015]]]),
            {
              "reference": 21,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.1507284957543, -25.46771383137143],
                  [-52.150385173000394, -25.46686143476569],
                  [-52.15244510952383, -25.46755885061962]]]),
            {
              "reference": 21,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.10811587827198, -25.535976821860093],
                  [-52.10863086240284, -25.53675128234951],
                  [-52.10734340207569, -25.537293401716315]]]),
            {
              "reference": 21,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.13062860967444, -25.610819052087056],
                  [-52.12934114934729, -25.612521793809726],
                  [-52.1296844721012, -25.6095032805055]]]),
            {
              "reference": 21,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.14578787837926, -25.67928225290138],
                  [-52.14724700008336, -25.680519902713893],
                  [-52.14535872493688, -25.680906665644017]]]),
            {
              "reference": 21,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.0764350245392, -25.704294991290077],
                  [-52.0790099451935, -25.703289602524706],
                  [-52.07943909863588, -25.704140316648136]]]),
            {
              "reference": 21,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.10216012327656, -25.73172335291442],
                  [-52.10138764708027, -25.733733641375373],
                  [-52.10104432432637, -25.732264587767304]]]),
            {
              "reference": 21,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.11177962109238, -25.756706546091905],
                  [-52.11135046765, -25.75832990187582],
                  [-52.110663822142186, -25.756861152360788]]]),
            {
              "reference": 21,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.08532982719531, -25.74172547860505],
                  [-52.08507233512988, -25.745049888276725],
                  [-52.08438568962207, -25.742807854756204]]]),
            {
              "reference": 21,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.07858568572175, -25.77193890921152],
                  [-52.07849985503327, -25.76992926727369],
                  [-52.079443992606514, -25.77247996084176]]]),
            {
              "reference": 21,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.12182861221905, -25.799031090157513],
                  [-52.12182861221905, -25.797408291202863],
                  [-52.12260108841534, -25.798799263095695]]]),
            {
              "reference": 21,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.044551810100636, -25.898116301270253],
                  [-52.04197688944634, -25.898116301270253],
                  [-52.04326434977349, -25.896649285127108]]]),
            {
              "reference": 21,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.99017951337937, -25.89147597740408],
                  [-51.98863456098679, -25.892556985817706],
                  [-51.9878620847905, -25.891398762138557]]]),
            {
              "reference": 21,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.1560177664423, -25.978745984051635],
                  [-52.15610359713077, -25.980289135202042],
                  [-52.15421532198429, -25.97836019309958]]]),
            {
              "reference": 21,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.17426486467585, -26.012375845912917],
                  [-52.173063235037176, -26.01083311612024],
                  [-52.175809817068426, -26.01044743050487]]]),
            {
              "reference": 21,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.10641891534482, -26.032257450865526],
                  [-52.10659057672177, -26.0339541427545],
                  [-52.10470230157529, -26.032720187450927]]]),
            {
              "reference": 21,
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.08461792047177, -26.021768265371794],
                  [-52.085991211487396, -26.02192252489277],
                  [-52.085047073914154, -26.024313521539167]]]),
            {
              "reference": 21,
              "system:index": "31"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.14040786798154, -26.054466747534057],
                  [-52.141180344177826, -26.05199925566876],
                  [-52.14160949762021, -26.05477518036438]]]),
            {
              "reference": 21,
              "system:index": "32"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.996219565192035, -26.14243445830715],
                  [-51.99493210486489, -26.143050859382974],
                  [-51.99484627417641, -26.140508183967302]]]),
            {
              "reference": 21,
              "system:index": "33"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.01527397803383, -26.13033692854851],
                  [-52.015188147345356, -26.131955142079395],
                  [-52.01407234839516, -26.130105753356702]]]),
            {
              "reference": 21,
              "system:index": "34"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.53687098700363, -26.143189728306165],
                  [-51.5377292938884, -26.144229896503525],
                  [-51.53618434149582, -26.1440757980962]]]),
            {
              "reference": 21,
              "system:index": "35"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.516861733954975, -26.13122648207897],
                  [-51.51570301966054, -26.132844683284784],
                  [-51.51583176569326, -26.131187953205547]]]),
            {
              "reference": 21,
              "system:index": "36"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.53142490174431, -26.09131042952286],
                  [-51.53035201813835, -26.09115626131929],
                  [-51.53086700226921, -26.088072854589168]]]),
            {
              "reference": 21,
              "system:index": "37"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.5474309026295, -25.902048516234967],
                  [-51.548031717448836, -25.90143084803409],
                  [-51.54837504020274, -25.90235734912282],
                  [-51.54751673331798, -25.90297501247336]]]),
            {
              "reference": 21,
              "system:index": "38"
            })]),
    flo = /* color: #ffa429 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.4588394246078, -25.252791002247545],
                  [-51.45437622880702, -25.247977956996802],
                  [-51.45832444047694, -25.246580585563063]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.45317459916835, -25.25310151474768],
                  [-51.44991303300624, -25.254033047485404],
                  [-51.44991303300624, -25.252480488953648],
                  [-51.45283127641444, -25.25077265164891]]]),
            {
              "system:index": "1"
            })]);

// Define the region ID (reg_26)
var regiaoID = 'reg_26'; // old 07

// Define whether to collect data (false)
var coleta = false;   // true or false

// Define the years to process (2016-2023)
var anos = [2016,2017,2018,2019,2020,2021,2022,2023]

// If collecting data, only process 2023
if (coleta) {var anos = [2023]}

// Define the number of trees for the Random Forest classifier (100)
var RFtrees = 100;

// If collecting data, use 200 trees
if (coleta) {var RFtrees = 200}

// Define the output version (1)
var versao_out = 1;

// Define the version of the point data (S2_v1)
var versao_pt = 'S2_v1';

// Define the stable version (3)
var versao_estavel = '3'

// Define the input directory for point data
var dir_pt_in = 'projects/mapbiomas-workspace/AMOSTRAS/col9/MATA_ATLANTICA/teste/';

// Load the 250k biome collection
var bioma250mil = ee.FeatureCollection('projects/mapbiomas-workspace/AUXILIAR/biomas_IBGE_250mil');

// Filter the collection to only include the Mata Atlântica biome
var bioma250mil_MA_vetor = bioma250mil.filterMetadata('Bioma','equals', 'Mata Atlântica');

// Load the biome raster
var biomes = ee.Image('projects/mapbiomas-workspace/AUXILIAR/biomas-raster-41');

// Mask the biome raster to only include the Mata Atlântica biome
var bioma250mil_MA = biomes.mask(biomes.eq(2));

// Add the Mata Atlântica biome layer to the map
Map.addLayer(bioma250mil_MA,{},'layer bioma',false)

// Import the palettes module
var palettes = require('users/mapbiomas/modules:Palettes.js');

// Define the visualization parameters for the classification
var vis = {
    'min': 0,
    'max': 62,
    'palette': palettes.get('classification7')
};

// Load the Mata Atlântica regions collection
var regioesCollection = ee.FeatureCollection('projects/mapbiomas-workspace/AUXILIAR/Mata_Atlantica_col6_PLANET');

// Define the visualization parameters for the median composite
var visParMedian2 = {bands: ['swir1_median', 'nir_median', 'red_median'],gain: [0.08, 0.06, 0.2],gamma: 0.85}

// Define the biome name (MATAATLANTICA)
var bioma = "MATAATLANTICA";

// Define the output directory
var dirout = 'projects/mapbiomas-workspace/COLECAO7/classificacao-ma/';

// Load the S2 cluster image
var S2_cluster = ee.Image('projects/mapbiomas-workspace/AMOSTRAS/S2_2024/MATA_ATLANTICA/mosaicos_MA_S2_clusters_2106_2023')

// Filter the regions collection to only include the specified region ID
var limite = regioesCollection.filterMetadata('reg_id', "equals", regiaoID);
//var limite = reg_04_rev

// Load the stable map from collection 6
var mapa_estavel_col6 = ee.Image('projects/mapbiomas-workspace/AMOSTRAS/col7/MATA_ATLANTICA/MA_amostras_estaveis85a20_col6_v1')

// Add the stable map layer to the map
Map.addLayer(mapa_estavel_col6, vis, 'mapa_estavel_col6', false);

// Create a blank image
var blank = ee.Image(0).mask(0);
// Paint the region outline on the blank image
var outline = blank.paint(limite, 'AA0000', 2); 
// Define the visualization parameters for the outline
var visPar = {'palette':'000000','opacity': 0.6};
// Add the outline layer to the map
Map.addLayer(outline, visPar, regiaoID, false);

// Define a function to shuffle a feature collection
var shuffle = function (collection, seed) {
    // Add a random column to the collection
    collection = collection.randomColumn('random', seed || 1)
        // Sort the collection by the random column
        .sort('random', true)
        // Map over the collection and set a new ID based on the random value
        .map(function (feature) {
                var rescaled = ee.Number(feature.get('random')).multiply(1000000000).round();
                return feature.set('new_id', rescaled)});
    // Get a list of the new IDs
    var randomIdList = ee.List(collection.reduceColumns(ee.Reducer.toList(), ['new_id']).get('list'));
    // Create a sequential list of IDs
    var sequentialIdList = ee.List.sequence(1, collection.size());
    // Remap the collection using the new and sequential IDs
    var shuffled = collection.remap(randomIdList, sequentialIdList, 'new_id');
    // Return the shuffled collection
    return shuffled;
};

// Define the visualization parameters for the hand-labeled data
var vis_hand = {
    'min': 0,
    'max': 60,
    'palette': 'blue,white,green,orange,red,brown'
};

// Loop through the years
for (var i_ano=0;i_ano<anos.length; i_ano++){
  // Get the current year
  var ano = anos[i_ano];

  // Define the asset path for the Sentinel-2 mosaics
  var asset = 'projects/mapbiomas-mosaics/assets/SENTINEL/BRAZIL/mosaics-3';
  // Define the band names to use for classification
  var bandNames = ee.List([
  //  THE 60 MOST IMPORTANT BANDS FOR THIS REGION
  'swir2_median','nddi_median','green_median_texture_'+ano,'ri_median_dry','red_edge_1_stdDev','red_edge_4_median','green_min','dswi5_median_wet','red_edge_1_median_dry','nddi_median_wet','gvmi_median_dry','afvi_median_wet','gli_median_wet','red_median_dry','green_median_wet','co2flux_median','ndwi_median_wet','swir1_median','red_edge_3_median_wet','spri_median','swir1_median_wet','evi_median','ndwi_median','dswi5_median','bsi_median','mbi_median_wet','ndwi_median_'+ano,'mbi_median','bsi_median_1','ndvi_median_wet_'+ano,'wetness_median_wet','spri_median_1','gcvi_median','iia_median_dry','shape_median','ri_median','swir2_median_dry','red_edge_1_median_wet','cvi_median','green_median_texture','red_edge_3_median_dry','gvmi_median_dry_1','wetness_median','brightness_median','ui_median_dry','cvi_median_dry','evi_median_dry','gcvi_median_wet','red_edge_1_median','spri_median_wet','red_edge_3_stdDev','ndvi_median_dry','ndvi_median_wet','iia_median','avi_median_wet','gvmi_median_wet','wetness_median_dry','gcvi_median_dry','longitude','ndvi_median_dry_'+ano,

  // ALL 143 BANDS TO FEATURE IMPORTANCE
  //    'blue_median','afvi_median','afvi_median_dry','afvi_median_wet','avi_median','avi_median_dry','avi_median_wet','awei_median','awei_median_dry','awei_median_wet','blue_median_dry','blue_median_wet','blue_stdDev','brba_median','brba_median_dry','brba_median_wet','brightness_median','brightness_median_dry','brightness_median_wet','bsi_median','bsi_median_1','bsi_median_2','clusters_2023','co2flux_median','cvi_median','cvi_median_dry','cvi_median_wet','dswi5_median','dswi5_median_dry','dswi5_median_wet','evi_median','evi_median_dry','evi_median_wet','gcvi_median','gcvi_median_dry','gcvi_median_wet','gemi_median','gemi_median_dry','gemi_median_wet','gli_median','gli_median_dry','gli_median_wet','green_median','green_median_dry','green_median_texture','green_median_texture_2023','green_median_wet','green_min','green_stdDev','gvmi_median','gvmi_median_1','gvmi_median_dry','gvmi_median_dry_1','gvmi_median_wet','gvmi_median_wet_1','iia_median','iia_median_dry','iia_median_wet','lai_median','latitude','longitude','lswi_median','lswi_median_dry','lswi_median_wet','mbi_median','mbi_median_dry','mbi_median_wet','msi_median','msi_median_dry','msi_median_wet','nddi_median','nddi_median_dry','nddi_median_wet','ndvi_median','ndvi_median_dry','ndvi_median_dry_2023','ndvi_median_wet','ndvi_median_wet_2023','ndwi_median','ndwi_median_2023','ndwi_median_dry','ndwi_median_wet','nir_median','nir_median_contrast','nir_median_dry','nir_median_dry_contrast','nir_median_wet','nir_stdDev','osavi_median','osavi_median_dry','osavi_median_wet','ratio_median','ratio_median_dry','ratio_median_wet','red_edge_1_median','red_edge_1_median_dry','red_edge_1_median_wet','red_edge_1_stdDev','red_edge_2_median','red_edge_2_median_dry','red_edge_2_median_wet','red_edge_2_stdDev','red_edge_3_median','red_edge_3_median_dry','red_edge_3_median_wet','red_edge_3_stdDev','red_edge_4_median','red_edge_4_median_dry','red_edge_4_median_wet','red_edge_4_stdDev','red_median','red_median_contrast','red_median_dry','red_median_dry_contrast','red_median_wet','red_min','red_stdDev','ri_median','ri_median_dry','ri_median_wet','rvi_median','rvi_median_1','rvi_median_wet','shape_median','shape_median_dry','shape_median_wet','spri_median','spri_median_1','spri_median_wet','swir1_median','swir1_median_dry','swir1_median_wet','swir1_stdDev','swir2_median','swir2_median_dry','swir2_median_wet','swir2_stdDev','ui_median','ui_median_dry','ui_median_wet','wetness_median','wetness_median_dry','wetness_median_wet',
  ])

  // Load the Sentinel-2 mosaics for the current year
  var collection = ee.ImageCollection(asset)
        // Filter the collection to only include version 3
        .filter(ee.Filter.eq('version', '3'))
        // Filter the collection to only include the current year
        .filter(ee.Filter.eq('year', ano))
        // Filter the collection to only include the Mata Atlântica biome
        .filter(ee.Filter.inList('biome', [
            'MATAATLANTICA',
        ])); 

  // Create a mosaic of the Sentinel-2 images
  var mosaicoTotal = collection.mosaic()

  // Import the function to add indices for the Caatinga biome
  var addIndexCaatinga = require('users/marcosrosaUSP/MapBiomas_col9_MataAtlan:Mata_Atlantica_SENTINEL2/processa_Bandas_Sentinel2_CAATINGA');

  // Add the Caatinga indices to the mosaic
  mosaicoTotal = addIndexCaatinga.get(mosaicoTotal);

  // Add the S2 cluster bands to the mosaic
  mosaicoTotal = mosaicoTotal.addBands(S2_cluster.select([
    'clusters_'+ano, 'ndvi_median_dry_'+ano,'ndvi_median_wet_'+ano,'ndwi_median_'+ano, 'green_median_texture_'+ano
    ]))
    
  // Add the mosaic layer to the map
  Map.addLayer(mosaicoTotal, {'bands': ['swir1_median', 'nir_median', 'red_median'],
    'gain': [0.08, 0.07, 0.2],'gamma': 0.85}, 'Sentinel 2 '+ano, false);

  //print(mosaicoTotal)
  //var BDamostras = ee.FeatureCollection('projects/mapbiomas-workspace/AMOSTRAS/col9/MATA_ATLANTICA/teste/REGIONs_'+regiaoID+'_'+ano)

  // Load the training points for the current year
  var BDamostras = ee.FeatureCollection('projects/mapbiomas-workspace/AMOSTRAS/S2_2024/MATA_ATLANTICA/pontos_train_v1_'+ano)
                    // Filter the points to only include the specified region ID
                    .filterMetadata('reg_id', 'equals', regiaoID)
                    
    // Filter the points by reference class
    var BDflo = BDamostras.filterMetadata("reference", "equals", 3)
    var BDsav = BDamostras.filterMetadata("reference", "equals", 4)//.limit(100)
    var BDreflo = BDamostras.filterMetadata("reference", "equals", 9)
    var BDvarzea = BDamostras.filterMetadata("reference", "equals", 11)
    var BDcampo = BDamostras.filterMetadata("reference", "equals", 12)
    var BDOutroNFlo = BDamostras.filterMetadata("reference", "equals", 13)
    var BDagro = BDamostras.filterMetadata("reference", "equals", 21)
    // BDagro = shuffle(BDagro, 2).limit(2500)
    var BDNaoVeg = BDamostras.filterMetadata("reference", "equals", 22)
    var BDAflora = BDamostras.filterMetadata("reference", "equals", 29)
    var BDagua = BDamostras.filterMetadata("reference", "equals", 33)

  // Complementary samples
  // Merge the complementary samples
  var amostraTotal = varzea.merge(reflo).merge(agro).merge (varzea).merge (flo)//.merge(campo).merge(aflora)//.merge(agua)
  
  // Reduce the complementary samples to an image
  var amostraTotalimg = amostraTotal.reduceToImage({properties: ['reference'],reducer: ee.Reducer.first()})

  // Rename the band
  amostraTotalimg = amostraTotalimg.select([0],['reference'])

  // Sample the mosaic using the complementary samples
  var training_flo = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 300, 'region': flo.filterBounds(limite), 'scale': 10, 'seed': 1});
  var training_reflo = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 400, 'region': reflo.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_nflo = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 300, 'region': nao_flo.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_sav = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 2000, 'region': savana.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_afl = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 1000, 'region': aflora.filterBounds(limite), 'scale': 10, 'seed': 1});
  var training_var = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 1500, 'region': varzea.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_agu = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 100, 'region': agua.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_cam = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 4500, 'region': campo.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_nflo = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 500, 'region': restinga.filterBounds(limite), 'scale': 10, 'seed': 1});
  var training_agr = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 500, 'region': agro.filterBounds(limite), 'scale': 10, 'seed': 1});

// If collecting data, print the size of each training set
if (coleta) {
// print('BDflo',BDflo.size())
// print('BDsav',BDsav.size())
// print('BDvar',BDvarzea.size())
// print('BDcam',BDcampo.size())
// print('BDOut',BDOutroNFlo.size())
// print('BDAfl',BDAflora.size())
// print('BDagr',BDagro.size())
// print('BDNao',BDNaoVeg.size())
// print('BDagu',BDagua.size())
print('training_flo',training_flo.size())
print('training_var',training_var.size())
// print('training_nflo',training_nflo.size())
// print('training_cam',training_cam.size())
// print('training_sav',training_sav.size())
// print('training_afl',training_afl.size())
// print('training_cam',training_cam.size())
print('training_agr',training_agr.size())
print('training_reflo',training_reflo.size())
 }

  // Merge all the training points
  var training = BDflo.merge(BDreflo).merge(BDcampo)//.merge(BDsav).merge(BDOutroNFlo).merge(BDAflora)
                      .merge(BDagro).merge(BDNaoVeg).merge(BDagua)
                      //complementares
                      .merge(training_var)
                      .merge(training_reflo).merge(training_agr).merge(training_var)
                      // .merge(training_afl)
                      .merge(training_flo)
                      //.merge(training_agu).merge(training_agr)

  // Train the Random Forest classifier
  var classifierRF = ee.Classifier.smileRandomForest({numberOfTrees: RFtrees, variablesPerSplit:1}).train(training, 'reference', bandNames);

  // If collecting data, print the classifier explanation
  if (coleta) {print(classifierRF.explain())}

  // Train the Gradient Tree Boost classifier
  var classifierGTB = ee.Classifier.smileGradientTreeBoost({numberOfTrees: 30, shrinkage: 0.1, samplingRate: 0.8, loss: 'LeastSquares'}).train(training, 'reference', bandNames);

  // print(classifier.explain())

  // Classify the mosaic using the Random Forest classifier
  var classifiedRF = mosaicoTotal.classify(classifierRF).mask(mosaicoTotal.select('blue_median'));

  // Classify the mosaic using the Gradient Tree Boost classifier
  var classifiedGTB = mosaicoTotal.classify(classifierGTB).mask(mosaicoTotal.select('blue_median'));

  // Rename the classification band and clip the image to the region
  classifiedRF = classifiedRF.select(['classification'],['classification_'+ano]).clip(limite.geometry()).toInt8()
  // classifiedGTB = classifiedGTB.select(['classification'],['classification_'+ano]).clip(limite.geometry()).toInt8()

  // If collecting data, add the classification layers to the map
  if (coleta) {  
    Map.addLayer(classifiedRF, vis, 'RF'+ano+"_"+regiaoID, false);
//    Map.addLayer(classifiedGTB, vis, 'GTB'+ano+"_"+regiaoID, false);
  }

  // If this is the first year, store the classification
  if (i_ano == 0){ var classified16a23RF = classifiedRF;}//  var classified16a23GTB = classifiedGTB}  
  // Otherwise, add the classification to the existing image
  else {classified16a23RF = classified16a23RF.addBands(classifiedRF);}// classified16a23GTB = classified16a23GTB.addBands(classifiedGTB)}
}

// If collecting data, do nothing
if (coleta) {}
   // Otherwise, export the classification to an asset
   else 
   {
     // Set the metadata for the classification
     classified16a23RF = classified16a23RF
     .set('territory', 'BRAZIL')
     .set('biome', 'MATA ATÂNTICA')
     .set('source', 'arcplan')
     .set('version', '1')
     .set('collection_id',versao_out)

//     classified16a23GTB = classified16a23GTB
//     .set('territory', 'BRAZIL')
//     .set('biome', 'MATA ATÂNTICA')
//     .set('source', 'arcplan')
//     .set('version', '1')
//     .set('collection_id',versao_out)
     
    // Export the Random Forest classification to an asset
    Export.image.toAsset({
       "image": classified16a23RF.toInt8(),
       "description": regiaoID+'-'+'RF_SENTINEL2_v'+versao_out,
       "assetId": dirout + regiaoID+'-'+'RF_SENTINEL2_v'+versao_out,
       "scale": 10,
       "pyramidingPolicy": {
           '.default': 'mode'
       },
       "maxPixels": 1e13,
       "region": limite
     });    
     
//    Export.image.toAsset({
//       "image": classified16a23GTB.toInt8(),
//       "description": regiaoID+'-'+'GTB_SENTINEL2_v'+versao_out,
//       "assetId": dirout + regiaoID+'-'+'GTB_SENTINEL2_v'+versao_out,
//       "scale": 10,
//       "pyramidingPolicy": {
//           '.default': 'mode'
//       },
//       "maxPixels": 1e13,
//       "region": limite
//     });    
}
