var varzea = /* color: #d63000 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.817921029204676, -25.88887186386031],
                  [-52.814916955107996, -25.88713446984438],
                  [-52.81225620376522, -25.886671160455354],
                  [-52.81414447891171, -25.886400895805483],
                  [-52.81633316146786, -25.88728890590336]]]),
            {
              "reference": 11,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.505051855530894, -25.641673347370265],
                  [-52.50711179205433, -25.643336960884163],
                  [-52.503292326417125, -25.642485812680906]]]),
            {
              "reference": 11,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.500737335806576, -24.842404604027838],
                  [-53.500994827872006, -24.834771295686938],
                  [-53.50193896544525, -24.83695228896029],
                  [-53.50168147337982, -24.841469938502605]]]),
            {
              "reference": 11,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.538116812025926, -24.727172001493475],
                  [-53.53768765858354, -24.731381816950407],
                  [-53.53657185963335, -24.728653249102155]]]),
            {
              "reference": 11,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.40153059297885, -24.695908944172],
                  [-53.402903883994476, -24.700977569862918],
                  [-53.403676360190765, -24.705266245901864],
                  [-53.407452910483734, -24.71049043354728],
                  [-53.40110143953647, -24.705656118219043],
                  [-53.401702254355804, -24.703472817522986],
                  [-53.39998564058627, -24.70105554710893],
                  [-53.39981397920932, -24.699106101314833]]]),
            {
              "reference": 11,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.62200853566154, -24.53501329778091],
                  [-53.62441179493889, -24.54461687325328],
                  [-53.62329599598869, -24.54383612220707],
                  [-53.620721075334394, -24.53649682491202]]]),
            {
              "reference": 11,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.70536689734124, -24.567389422306526],
                  [-53.704079437014094, -24.564891455508963],
                  [-53.70674018835687, -24.566452690591422]]]),
            {
              "reference": 11,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.86658405501782, -24.65449187344702],
                  [-53.865124933313716, -24.654569879767436],
                  [-53.86049007613598, -24.651995645456584],
                  [-53.86383747298657, -24.652073653336807],
                  [-53.86426662642895, -24.65371180756188],
                  [-53.86581157882153, -24.652931736802255]]]),
            {
              "reference": 11,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.510635165959485, -24.91866254935925],
                  [-53.51046350458253, -24.917339254827848],
                  [-53.51200845697511, -24.916638681386683]]]),
            {
              "reference": 11,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.50703027704347, -24.924422607184905],
                  [-53.50600030878175, -24.927925213486237],
                  [-53.505399493962415, -24.927769544208182],
                  [-53.50600030878175, -24.924889627107863]]]),
            {
              "reference": 11,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.481195239812024, -24.914459094122208],
                  [-53.48136690118898, -24.91344712980053],
                  [-53.48205354669679, -24.91422556463098]]]),
            {
              "reference": 11,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.52428224542726, -24.94247942242114],
                  [-53.52419641473878, -24.94481416223837],
                  [-53.52325227716554, -24.944891986136845],
                  [-53.52368143060792, -24.942401596998486]]]),
            {
              "reference": 11,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.363030876003904, -24.60868196927139],
                  [-53.36285921462695, -24.60719929650622],
                  [-53.36431833633105, -24.608057688143667]]]),
            {
              "reference": 11,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.24073813613888, -24.12510928025861],
                  [-52.2391931837463, -24.123777598400537],
                  [-52.2403089826965, -24.123072584746566],
                  [-52.241853935089075, -24.12385593301118]]]),
            {
              "reference": 11,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.23593161758419, -24.13176748161786],
                  [-52.23395751174923, -24.130514199605603],
                  [-52.23696158584591, -24.130122546458264]]]),
            {
              "reference": 11,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.24923537429806, -24.116335591704413],
                  [-52.24854872879025, -24.115160498454326],
                  [-52.250608665313685, -24.114925478509694]]]),
            {
              "reference": 11,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.24339888748165, -24.121114193102787],
                  [-52.24271224197384, -24.123464259478375],
                  [-52.24168227371212, -24.122759244097825]]]),
            {
              "reference": 11,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.92327689548327, -23.99713573598794],
                  [-51.92108821292712, -23.997959059151782],
                  [-51.92293357272936, -23.99682208768302]]]),
            {
              "reference": 11,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.91327762027575, -23.999840920891085],
                  [-51.911389345129265, -24.000585816894052],
                  [-51.911389345129265, -23.999958536336102]]]),
            {
              "reference": 11,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.91882140084124, -24.005724935479304],
                  [-51.91779143257952, -24.005842545546006],
                  [-51.918692654808524, -24.005450511572228]]]),
            {
              "reference": 11,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.935998528829565, -24.030066512254376],
                  [-51.93578395210837, -24.0312031898522],
                  [-51.93531188332175, -24.031046407333022]]]),
            {
              "reference": 11,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.92960414253806, -24.03594577063849],
                  [-51.928531258932104, -24.03684723313609],
                  [-51.92737254463767, -24.037004008576915]]]),
            {
              "reference": 11,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.93380984627341, -24.033398125034726],
                  [-51.93406733833884, -24.034691551423723],
                  [-51.93303737007712, -24.033515709789963]]]),
            {
              "reference": 11,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.89823302589988, -24.031634340793577],
                  [-51.89823302589988, -24.033162955201448],
                  [-51.89771804176902, -24.031908708821234]]]),
            {
              "reference": 11,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.53865438074268, -23.99689031632854],
                  [-51.537216716710695, -23.997301979353786],
                  [-51.53837543100513, -23.996380636473017]]]),
            {
              "reference": 11,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.213502419494894, -25.88395277930122],
                  [-52.21311618139675, -25.884261659540517],
                  [-52.21262265493801, -25.88393347425944]]]),
            {
              "reference": 11,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.20309544851711, -25.879107114792056],
                  [-52.20219422628811, -25.879551148101612],
                  [-52.20262337973049, -25.879029891437376]]]),
            {
              "reference": 11,
              "system:index": "26"
            })]),
    agro = /* color: #bf04c2 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.99713538224399, -24.582610752905584],
                  [-52.00056860978305, -24.58183023845786],
                  [-51.99756453568637, -24.583781515457066]]]),
            {
              "reference": 21,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.030695181438325, -24.565906682186174],
                  [-52.031725149700044, -24.567311783254528],
                  [-52.028721075603364, -24.5674679046231]]]),
            {
              "reference": 21,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.03764746720493, -24.55981772888035],
                  [-52.03953574235141, -24.560286120403685],
                  [-52.03764746720493, -24.56091063971276]]]),
            {
              "reference": 21,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.911605776717415, -24.636232434676632],
                  [-51.90903085606312, -24.636076399077055],
                  [-51.90894502537464, -24.6343599946202]]]),
            {
              "reference": 21,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.84043588368671, -24.695688000089337],
                  [-51.83846177785175, -24.69584396115443],
                  [-51.8400925609328, -24.693660488478034]]]),
            {
              "reference": 21,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.86833085744159, -24.7461312157645],
                  [-51.86618509022968, -24.746832754605126],
                  [-51.8620652171828, -24.746287113626803],
                  [-51.86266603200214, -24.745429672964626],
                  [-51.865498444721865, -24.746209164720096],
                  [-51.867730042622256, -24.745507622360133]]]),
            {
              "reference": 21,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.93373384206073, -24.777930329980812],
                  [-51.936909577534365, -24.777151037257696],
                  [-51.937167069599795, -24.777774471827605],
                  [-51.93536462514179, -24.77863168924847]]]),
            {
              "reference": 21,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.011324784443545, -24.788294457892786],
                  [-52.01175393788593, -24.78689184461293],
                  [-52.01269807545917, -24.787593153234933],
                  [-52.012097260639834, -24.78938536836993]]]),
            {
              "reference": 21,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.976134202168154, -24.80769564776704],
                  [-51.969611069843936, -24.804267545859798],
                  [-51.97716417042987, -24.805825785751455]]]),
            {
              "reference": 21,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.977850815937686, -24.814162036446294],
                  [-51.97553338734882, -24.819381646253362],
                  [-51.97604837147968, -24.814863190846346]]]),
            {
              "reference": 21,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.907433714457014, -24.85692519162151],
                  [-51.90219804245994, -24.854043621789014],
                  [-51.90794869858787, -24.854666669603393]]]),
            {
              "reference": 21,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.92957803208397, -24.857548224920322],
                  [-51.93198129136131, -24.85801549783466],
                  [-51.930350508280256, -24.8592615503081]]]),
            {
              "reference": 21,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.82307231893543, -24.875017606774104],
                  [-51.82058322896961, -24.87439466150952],
                  [-51.82152736654285, -24.873304499740357],
                  [-51.823930625820196, -24.873849581827045]]]),
            {
              "reference": 21,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.71013308127515, -24.94749721508374],
                  [-51.710562234717536, -24.944773406991303],
                  [-51.711334710913825, -24.946952458283945]]]),
            {
              "reference": 21,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.70129252036207, -24.965239404738398],
                  [-51.70000506003492, -24.966484374660883],
                  [-51.69974756796949, -24.964227857402605]]]),
            {
              "reference": 21,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.63894082236699, -25.03158651702435],
                  [-51.63739586997441, -25.033375191268426],
                  [-51.6352501027625, -25.03244197317713]]]),
            {
              "reference": 21,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.63250352073125, -25.002575247350467],
                  [-51.63173104453496, -25.005064418641282],
                  [-51.630100261453904, -25.005531132643338]]]),
            {
              "reference": 21,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.46730383830637, -24.995261260894274],
                  [-51.4661022086677, -24.995261260894274],
                  [-51.46730383830637, -24.992771891007216],
                  [-51.46807631450266, -24.994561130709823]]]),
            {
              "reference": 21,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.46738966899485, -24.982502707318726],
                  [-51.46412810283274, -24.982813907305488],
                  [-51.46532973247141, -24.981335700354194]]]),
            {
              "reference": 21,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.43082579570383, -24.983202906181443],
                  [-51.427735890918676, -24.984681090686927],
                  [-51.42807921367258, -24.982502707318726]]]),
            {
              "reference": 21,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.0667291545833, -25.276114619615928],
                  [-51.06466921805986, -25.27487280026619],
                  [-51.0652700328792, -25.27370858308404]]]),
            {
              "reference": 21,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.09050425529131, -25.290084211477858],
                  [-51.09024676322588, -25.2875232400767],
                  [-51.09170588492998, -25.288764929934295]]]),
            {
              "reference": 21,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.047935441597865, -25.34069084039674],
                  [-51.04905124054806, -25.33921696421616],
                  [-51.0499953781213, -25.34100112783115]]]),
            {
              "reference": 21,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.11093516693966, -25.36202124785354],
                  [-51.111535981759, -25.36465820049196],
                  [-51.110076860054896, -25.364813313561367]]]),
            {
              "reference": 21,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.38359095421136, -25.86932876679126],
                  [-51.384620922473076, -25.874580271166636],
                  [-51.37672449913323, -25.87519807986365]]]),
            {
              "reference": 21,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.655503533201625, -24.930649394031143],
                  [-51.65310027392428, -24.921931804386862],
                  [-51.65653350146334, -24.921931804386862]]]),
            {
              "reference": 21,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.40007188776124, -24.938121123042762],
                  [-52.39835527399171, -24.9331400207004],
                  [-52.40487840631593, -24.935630597038838]]]),
            {
              "reference": 21,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.555352954655774, -24.899200905035876],
                  [-53.557069568425305, -24.903560580149172],
                  [-53.55294969537843, -24.90231497440204]]]),
            {
              "reference": 21,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.648154000313845, -24.718996458250302],
                  [-52.647124032052126, -24.714318411137928],
                  [-52.654677132638064, -24.715877779709896]]]),
            {
              "reference": 21,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.098837594063845, -24.70995207522221],
                  [-52.099867562325564, -24.715254034625175],
                  [-52.094374398263064, -24.716189651080214],
                  [-52.09368775275525, -24.711511498485116]]]),
            {
              "reference": 21,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.65320465949353, -24.73583597185392],
                  [-51.652861336739626, -24.740513209971432],
                  [-51.64702484992322, -24.74176044375661],
                  [-51.64702484992322, -24.73770688821183]]]),
            {
              "reference": 21,
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.16087983039197, -24.72866386508742],
                  [-51.163969735177126, -24.72523358089154],
                  [-51.16637299445447, -24.729287542961643]]]),
            {
              "reference": 21,
              "system:index": "31"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.80255005744275, -24.460193420656108],
                  [-51.79534027961072, -24.460505929517403],
                  [-51.79465363410291, -24.45769332185323],
                  [-51.80186341193494, -24.45706828939928]]]),
            {
              "reference": 21,
              "system:index": "32"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.8934378279082, -24.298422592418728],
                  [-51.89240785964648, -24.30342904361478],
                  [-51.88897463210742, -24.30186454883512]]]),
            {
              "reference": 21,
              "system:index": "33"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.274040443267786, -24.204515094994278],
                  [-52.27644370254513, -24.21296960802509],
                  [-52.26992057022091, -24.21328272736517],
                  [-52.2692339247131, -24.204515094994278]]]),
            {
              "reference": 21,
              "system:index": "34"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.148212653961146, -24.010298826771173],
                  [-52.145466071929896, -24.01813898371755],
                  [-52.141002876129114, -24.016570990566755],
                  [-52.14512274917599, -24.009357975819707]]]),
            {
              "reference": 21,
              "system:index": "35"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.5518093210573, -25.912817093864273],
                  [-52.55219555915544, -25.914476909591535],
                  [-52.550650606762865, -25.91393650703597]]]),
            {
              "reference": 21,
              "system:index": "36"
            })]),
    flo = /* color: #dde603 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.393136947947774, -26.506515889440006],
                  [-51.394853561717305, -26.510817083605314],
                  [-51.38798710663918, -26.51020263715621]]]),
            {
              "reference": 3,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.38421055634621, -26.634867802499038],
                  [-51.38249394257668, -26.628729839888003],
                  [-51.391077011424336, -26.63394712912812]]]),
            {
              "reference": 3,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.50627091271296, -26.369327916908496],
                  [-51.50695755822077, -26.373941823364717],
                  [-51.50043442589655, -26.372711466321423]]]),
            {
              "reference": 3,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.952491310662175, -26.101406916807093],
                  [-50.95420792443171, -26.10418167021097],
                  [-50.95043137413874, -26.10479827313724]]]),
            {
              "reference": 3,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.04759171349421, -25.877051486567453],
                  [-51.045875099724675, -25.882302647625142],
                  [-51.04278519493952, -25.880140433113024]]]),
            {
              "reference": 3,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.50627091271296, -25.927700003564222],
                  [-51.507300880974675, -25.93202264991903],
                  [-51.50352433068171, -25.932331404305263]]]),
            {
              "reference": 3,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.35668137413874, -25.91133426335934],
                  [-52.35565140587702, -25.915348711796746],
                  [-52.35187485558405, -25.911951879706166]]]),
            {
              "reference": 3,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.370513466423894, -26.027697726054694],
                  [-53.370513466423894, -26.02461264894145],
                  [-53.37394669396296, -26.0255381805923]]]),
            {
              "reference": 3,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.55981470909417, -25.769815052453257],
                  [-52.558441418078544, -25.767032412451247],
                  [-52.56187464561761, -25.766723226201794]]]),
            {
              "reference": 3,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.423073070910576, -25.746624392773004],
                  [-51.42822291221917, -25.75682884101877],
                  [-51.41998316612542, -25.75404589662525]]]),
            {
              "reference": 3,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.983619945910576, -25.780635810000426],
                  [-50.98773981895745, -25.784654697159624],
                  [-50.98396326866448, -25.78558211331985]]]),
            {
              "reference": 3,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.324196117785576, -25.60212213062685],
                  [-51.32316614952386, -25.60707585411658],
                  [-51.31835963096917, -25.60521823186032]]]),
            {
              "reference": 3,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.12139101663572, -25.616293064133707],
                  [-52.12139101663572, -25.612268489782934],
                  [-52.125510889682594, -25.613197249739308]]]),
            {
              "reference": 3,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.29923220315916, -25.581305695872686],
                  [-52.29991884866697, -25.576350905136202],
                  [-52.30232210794431, -25.57758962204798]]]),
            {
              "reference": 3,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.46574373880369, -25.456444500929084],
                  [-52.46986361185056, -25.452414559115063],
                  [-52.47364016214353, -25.45520453320293]]]),
            {
              "reference": 3,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.13287897745115, -25.488446746019015],
                  [-51.133222300205055, -25.492475480706382],
                  [-51.12635584512693, -25.492475480706382]]]),
            {
              "reference": 3,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.230382639560524, -25.32004915369395],
                  [-51.22832270303709, -25.325945484389784],
                  [-51.22454615274412, -25.322531854246158]]]),
            {
              "reference": 3,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.404889780673805, -25.235917629957488],
                  [-52.40111323038084, -25.232812030118005],
                  [-52.40626307168943, -25.230948632134915]]]),
            {
              "reference": 3,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.7396294657324, -25.241196967599546],
                  [-52.74065943399412, -25.23747040012582],
                  [-52.745465952548805, -25.23871260197902]]]),
            {
              "reference": 3,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.303022104892555, -25.092045273336577],
                  [-53.30473871866209, -25.097019933651413],
                  [-53.29958887735349, -25.097019933651413]]]),
            {
              "reference": 3,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.36437769571287, -25.0702787566921],
                  [-52.360944468173805, -25.066546965295448],
                  [-52.364721018466774, -25.066546965295448]]]),
            {
              "reference": 3,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.78107233682615, -25.052240711859493],
                  [-51.77901240030271, -25.046953195561514],
                  [-51.784162241611305, -25.04633111982801]]]),
            {
              "reference": 3,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.26952143350584, -25.096398112174242],
                  [-51.270551401767555, -25.088625077040792],
                  [-51.27776117959959, -25.091423426575098]]]),
            {
              "reference": 3,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.98121764452975, -24.832229423104295],
                  [-50.979844353514125, -24.82693245645788],
                  [-50.98293425829928, -24.826309269015407]]]),
            {
              "reference": 3,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.559373162107875, -24.975784188228847],
                  [-51.5607464531235, -24.970182147816704],
                  [-51.563836357908656, -24.971738295741652]]]),
            {
              "reference": 3,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.71283891656984, -24.92691335966506],
                  [-52.7162721441089, -24.917261413530895],
                  [-52.720392017155774, -24.922554509803476]]]),
            {
              "reference": 3,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.24567583063234, -24.944658514293884],
                  [-53.24739244440187, -24.942168120435582],
                  [-53.25013902643312, -24.94621498488828]]]),
            {
              "reference": 3,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.55226304987062, -24.868678868798465],
                  [-53.5512330816089, -24.86618694110341],
                  [-53.55569627740968, -24.86618694110341]]]),
            {
              "reference": 3,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.51149347284425, -24.94403592054928],
                  [-53.51218011835206, -24.94154551410458],
                  [-53.51346757867921, -24.941934643430184]]]),
            {
              "reference": 3,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.53295114496339, -24.94279072362007],
                  [-53.532350330144055, -24.941467688091965],
                  [-53.53406694391359, -24.942401596998486]]]),
            {
              "reference": 3,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.03301880744275, -24.822803781225],
                  [-53.02683899787244, -24.821868967725468],
                  [-53.031645516427126, -24.817194794413624]]]),
            {
              "reference": 3,
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.397185067208376, -24.727728342413595],
                  [-52.39684174445447, -24.723674329538458],
                  [-52.40130494025525, -24.724609882695013]]]),
            {
              "reference": 3,
              "system:index": "31"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.95292542365369, -24.63757337342137],
                  [-51.948805550606814, -24.635388880740084],
                  [-51.953268746407595, -24.631956029358523]]]),
            {
              "reference": 3,
              "system:index": "32"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.57080719855603, -24.622905332777613],
                  [-51.57218048957166, -24.626650528092078],
                  [-51.56394074347791, -24.627274716401576]]]),
            {
              "reference": 3,
              "system:index": "33"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.133757332833376, -24.712759023032667],
                  [-51.13410065558728, -24.716813391476727],
                  [-51.128264168770876, -24.717125260502883]]]),
            {
              "reference": 3,
              "system:index": "34"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.27623627570447, -24.469568349177134],
                  [-51.28104279425916, -24.473943076951354],
                  [-51.27520630744275, -24.47363060143781]]]),
            {
              "reference": 3,
              "system:index": "35"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.544028023751345, -24.554535821768212],
                  [-51.54368470099744, -24.550788468753645],
                  [-51.54814789679822, -24.55359899401152]]]),
            {
              "reference": 3,
              "system:index": "36"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.04596588996228, -24.47831765269015],
                  [-52.04253266242322, -24.478630116567576],
                  [-52.04596588996228, -24.474568025651376]]]),
            {
              "reference": 3,
              "system:index": "37"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.42455812820117, -24.626082551702208],
                  [-52.42730471023242, -24.621713126406313],
                  [-52.430394615017576, -24.624834160059276]]]),
            {
              "reference": 3,
              "system:index": "38"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.89697023757617, -24.399295701158564],
                  [-52.896626914822264, -24.39398036651442],
                  [-52.90074678786914, -24.396481728323717]]]),
            {
              "reference": 3,
              "system:index": "39"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.24259706863086, -24.349416565265244],
                  [-52.240193809353514, -24.34441193014861],
                  [-52.247403587185545, -24.345663107472035]]]),
            {
              "reference": 3,
              "system:index": "40"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.079277259674036, -24.39601272675693],
                  [-51.07790396865841, -24.39163529484089],
                  [-51.084083778228724, -24.39132261532925]]]),
            {
              "reference": 3,
              "system:index": "41"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.40200064834591, -24.119625795407394],
                  [-51.4068071669006, -24.117432335670674],
                  [-51.408867103424036, -24.12181921754754]]]),
            {
              "reference": 3,
              "system:index": "42"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.868576270904505, -24.200444203507047],
                  [-51.867546302642786, -24.192615200672776],
                  [-51.872352821197474, -24.192615200672776]]]),
            {
              "reference": 3,
              "system:index": "43"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.350944740142786, -24.197312660057285],
                  [-52.34510825332638, -24.193867873428122],
                  [-52.353004676666224, -24.19292837001517]]]),
            {
              "reference": 3,
              "system:index": "44"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.66491339859005, -24.22306731894298],
                  [-52.66354010757443, -24.219623228426283],
                  [-52.66697333511349, -24.219623228426283]]]),
            {
              "reference": 3,
              "system:index": "45"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.16984198745724, -23.9908531755155],
                  [-52.16640875991818, -23.986775488940115],
                  [-52.17190192398068, -23.98614814108211]]]),
            {
              "reference": 3,
              "system:index": "46"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.85879157241818, -24.112496913813956],
                  [-51.85741828140255, -24.10936321386831],
                  [-51.863598090972864, -24.11124344304056]]]),
            {
              "reference": 3,
              "system:index": "47"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.97377368926763, -24.062886963082263],
                  [-51.97321578979253, -24.064493576382027],
                  [-51.97300121307134, -24.06378823643508]]]),
            {
              "reference": 3,
              "system:index": "48"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.97656318664312, -24.07115492906375],
                  [-51.97574779510259, -24.072016961189295],
                  [-51.97501823425054, -24.071390029308944]]]),
            {
              "reference": 3,
              "system:index": "49"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.58873658746875, -23.994792774754305],
                  [-51.58496003717578, -23.996753095027525],
                  [-51.586419158879885, -23.99345973991532]]]),
            {
              "reference": 3,
              "system:index": "50"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.629849487249025, -24.015100244940417],
                  [-51.62401300043262, -24.015727451668774],
                  [-51.62873368829883, -24.013297008556563]]]),
            {
              "reference": 3,
              "system:index": "51"
            })]);

// Define the region ID (reg_13)
var regiaoID = 'reg_13'; // old 26

// Define whether to collect data (false)
var coleta = false;   // true or false

// Define the years to process (2016-2023)
var anos = [2016,2017,2018,2019,2020,2021,2022,2023]

// If collecting data, only process 2023
if (coleta) {var anos = [2023]}

// Define the number of trees for the Random Forest classifier (100)
var RFtrees = 100;

// If collecting data, use 200 trees
if (coleta) {var RFtrees = 200}

// Define the output version (1)
var versao_out = 1;

// Define the version of the point data (S2_v1)
var versao_pt = 'S2_v1';

// Define the stable version (3)
var versao_estavel = '3'

// Define the input directory for point data
var dir_pt_in = 'projects/mapbiomas-workspace/AMOSTRAS/col9/MATA_ATLANTICA/teste/';

// Load the 250k biome collection
var bioma250mil = ee.FeatureCollection('projects/mapbiomas-workspace/AUXILIAR/biomas_IBGE_250mil');

// Filter the collection to only include the Mata Atlântica biome
var bioma250mil_MA_vetor = bioma250mil.filterMetadata('Bioma','equals', 'Mata Atlântica');

// Load the biome raster
var biomes = ee.Image('projects/mapbiomas-workspace/AUXILIAR/biomas-raster-41');

// Mask the biome raster to only include the Mata Atlântica biome
var bioma250mil_MA = biomes.mask(biomes.eq(2));

// Add the Mata Atlântica biome layer to the map
Map.addLayer(bioma250mil_MA,{},'layer bioma',false)

// Import the palettes module
var palettes = require('users/mapbiomas/modules:Palettes.js');

// Define the visualization parameters for the classification
var vis = {
    'min': 0,
    'max': 62,
    'palette': palettes.get('classification7')
};

// Load the Mata Atlântica regions collection
var regioesCollection = ee.FeatureCollection('projects/mapbiomas-workspace/AUXILIAR/Mata_Atlantica_col6_PLANET');

// Define the visualization parameters for the median composite
var visParMedian2 = {bands: ['swir1_median', 'nir_median', 'red_median'],gain: [0.08, 0.06, 0.2],gamma: 0.85}

// Define the biome name (MATAATLANTICA)
var bioma = "MATAATLANTICA";

// Define the output directory
var dirout = 'projects/mapbiomas-workspace/COLECAO7/classificacao-ma/';

// Load the S2 cluster image
var S2_cluster = ee.Image('projects/mapbiomas-workspace/AMOSTRAS/S2_2024/MATA_ATLANTICA/mosaicos_MA_S2_clusters_2106_2023')

// Filter the regions collection to only include the specified region ID
var limite = regioesCollection.filterMetadata('reg_id', "equals", regiaoID);
//var limite = reg_04_rev

// Load the stable map from collection 6
var mapa_estavel_col6 = ee.Image('projects/mapbiomas-workspace/AMOSTRAS/col7/MATA_ATLANTICA/MA_amostras_estaveis85a20_col6_v1')

// Add the stable map layer to the map
Map.addLayer(mapa_estavel_col6, vis, 'mapa_estavel_col6', false);

// Create a blank image
var blank = ee.Image(0).mask(0);
// Paint the outline of the region on the blank image
var outline = blank.paint(limite, 'AA0000', 2); 
// Define the visualization parameters for the outline
var visPar = {'palette':'000000','opacity': 0.6};
// Add the outline layer to the map
Map.addLayer(outline, visPar, regiaoID, false);

// Define a function to shuffle a feature collection
var shuffle = function (collection, seed) {
    // Add a random column to the collection
    collection = collection.randomColumn('random', seed || 1)
        // Sort the collection by the random column
        .sort('random', true)
        // Map over the collection and set a new ID based on the random value
        .map(function (feature) {
                var rescaled = ee.Number(feature.get('random')).multiply(1000000000).round();
                return feature.set('new_id', rescaled)});
    // Get a list of the new IDs
    var randomIdList = ee.List(collection.reduceColumns(ee.Reducer.toList(), ['new_id']).get('list'));
    // Create a sequential list of IDs
    var sequentialIdList = ee.List.sequence(1, collection.size());
    // Remap the collection using the new and sequential IDs
    var shuffled = collection.remap(randomIdList, sequentialIdList, 'new_id');
    // Return the shuffled collection
    return shuffled;
};

// Define the visualization parameters for the hand-labeled data
var vis_hand = {
    'min': 0,
    'max': 60,
    'palette': 'blue,white,green,orange,red,brown'
};

// Loop through the years
for (var i_ano=0;i_ano<anos.length; i_ano++){
  // Get the current year
  var ano = anos[i_ano];

  // Define the asset path for the Sentinel-2 mosaics
  var asset = 'projects/mapbiomas-mosaics/assets/SENTINEL/BRAZIL/mosaics-3';
  // Define the band names to use for classification
  var bandNames = ee.List([
  // THE 60 MOST IMPORTANT BANDS FOR THIS REGION
  'green_median','ndwi_median_'+ano,'msi_median','afvi_median','iia_median_wet','avi_median_wet','green_median_texture_'+ano,'gvmi_median_dry_1','red_median','awei_median_dry','longitude','swir2_stdDev','red_edge_2_median','spri_median','lswi_median_dry','nir_stdDev','avi_median_dry','ri_median_dry','dswi5_median_dry','ratio_median','bsi_median','blue_median','nddi_median','osavi_median_dry','spri_median_1','brightness_median_dry','gemi_median_dry','green_median_dry','shape_median','red_edge_4_median_dry','rvi_median_1','blue_median_wet','red_edge_4_stdDev','osavi_median','red_edge_1_median_wet','swir2_median_dry','lswi_median','cvi_median','awei_median_wet','rvi_median_wet','gvmi_median_wet','wetness_median_wet','brba_median_wet','ui_median_wet','bsi_median_2','green_stdDev','ratio_median_wet','green_min','lswi_median_wet','ri_median','ndwi_median','ndwi_median_dry','ndvi_median_dry_'+ano,'gemi_median','blue_stdDev','mbi_median_dry','brightness_median_wet','red_edge_3_median_wet','ui_median','evi_median',

  // ALL 143 BANDS TO FEATURE IMPORTANCE
  //    'blue_median','afvi_median','afvi_median_dry','afvi_median_wet','avi_median','avi_median_dry','avi_median_wet','awei_median','awei_median_dry','awei_median_wet','blue_median_dry','blue_median_wet','blue_stdDev','brba_median','brba_median_dry','brba_median_wet','brightness_median','brightness_median_dry','brightness_median_wet','bsi_median','bsi_median_1','bsi_median_2','clusters_2023','co2flux_median','cvi_median','cvi_median_dry','cvi_median_wet','dswi5_median','dswi5_median_dry','dswi5_median_wet','evi_median','evi_median_dry','evi_median_wet','gcvi_median','gcvi_median_dry','gcvi_median_wet','gemi_median','gemi_median_dry','gemi_median_wet','gli_median','gli_median_dry','gli_median_wet','green_median','green_median_dry','green_median_texture','green_median_texture_2023','green_median_wet','green_min','green_stdDev','gvmi_median','gvmi_median_1','gvmi_median_dry','gvmi_median_dry_1','gvmi_median_wet','gvmi_median_wet_1','iia_median','iia_median_dry','iia_median_wet','lai_median','latitude','longitude','lswi_median','lswi_median_dry','lswi_median_wet','mbi_median','mbi_median_dry','mbi_median_wet','msi_median','msi_median_dry','msi_median_wet','nddi_median','nddi_median_dry','nddi_median_wet','ndvi_median','ndvi_median_dry','ndvi_median_dry_2023','ndvi_median_wet','ndvi_median_wet_2023','ndwi_median','ndwi_median_2023','ndwi_median_dry','ndwi_median_wet','nir_median','nir_median_contrast','nir_median_dry','nir_median_dry_contrast','nir_median_wet','nir_stdDev','osavi_median','osavi_median_dry','osavi_median_wet','ratio_median','ratio_median_dry','ratio_median_wet','red_edge_1_median','red_edge_1_median_dry','red_edge_1_median_wet','red_edge_1_stdDev','red_edge_2_median','red_edge_2_median_dry','red_edge_2_median_wet','red_edge_2_stdDev','red_edge_3_median','red_edge_3_median_dry','red_edge_3_median_wet','red_edge_3_stdDev','red_edge_4_median','red_edge_4_median_dry','red_edge_4_median_wet','red_edge_4_stdDev','red_median','red_median_contrast','red_median_dry','red_median_dry_contrast','red_median_wet','red_min','red_stdDev','ri_median','ri_median_dry','ri_median_wet','rvi_median','rvi_median_1','rvi_median_wet','shape_median','shape_median_dry','shape_median_wet','spri_median','spri_median_1','spri_median_wet','swir1_median','swir1_median_dry','swir1_median_wet','swir1_stdDev','swir2_median','swir2_median_dry','swir2_median_wet','swir2_stdDev','ui_median','ui_median_dry','ui_median_wet','wetness_median','wetness_median_dry','wetness_median_wet',
  ])

  // Filter the Sentinel-2 collection by version, year, and biome
  var collection = ee.ImageCollection(asset)
        .filter(ee.Filter.eq('version', '3'))
        .filter(ee.Filter.eq('year', ano))
        .filter(ee.Filter.inList('biome', [
            'MATAATLANTICA',
        ])); 

  // Create a mosaic of the filtered collection
  var mosaicoTotal = collection.mosaic()

  // Import the function to add indices for the Caatinga biome
  var addIndexCaatinga = require('users/marcosrosaUSP/MapBiomas_col9_MataAtlan:Mata_Atlantica_SENTINEL2/processa_Bandas_Sentinel2_CAATINGA');

  // Add the Caatinga indices to the mosaic
  mosaicoTotal = addIndexCaatinga.get(mosaicoTotal);

  // Add the S2 cluster bands to the mosaic
  mosaicoTotal = mosaicoTotal.addBands(S2_cluster.select([
    'clusters_'+ano, 'ndvi_median_dry_'+ano,'ndvi_median_wet_'+ano,'ndwi_median_'+ano, 'green_median_texture_'+ano
    ]))
    
  // Add the Sentinel-2 mosaic layer to the map
  Map.addLayer(mosaicoTotal, {'bands': ['swir1_median', 'nir_median', 'red_median'],
    'gain': [0.08, 0.07, 0.2],'gamma': 0.85}, 'Sentinel 2 '+ano, false);
  //print(mosaicoTotal)
  //var BDamostras = ee.FeatureCollection('projects/mapbiomas-workspace/AMOSTRAS/col9/MATA_ATLANTICA/teste/REGIONs_'+regiaoID+'_'+ano)

  // Load the training points for the current year and region
  var BDamostras = ee.FeatureCollection('projects/mapbiomas-workspace/AMOSTRAS/S2_2024/MATA_ATLANTICA/pontos_train_v1_'+ano)
                    .filterMetadata('reg_id', 'equals', regiaoID)
          
  // Filter the training points by reference class
  var BDflo = BDamostras.filterMetadata("reference", "equals", 3)
  var BDsav = BDamostras.filterMetadata("reference", "equals", 4)//.limit(100)
  var BDreflo = BDamostras.filterMetadata("reference", "equals", 9)
  var BDvarzea = BDamostras.filterMetadata("reference", "equals", 11)
  var BDcampo = BDamostras.filterMetadata("reference", "equals", 12)
  var BDOutroNFlo = BDamostras.filterMetadata("reference", "equals", 13)
  var BDagro = BDamostras.filterMetadata("reference", "equals", 21)
  // BDagro = shuffle(BDagro, 2).limit(1000)
  var BDNaoVeg = BDamostras.filterMetadata("reference", "equals", 22)
  var BDAflora = BDamostras.filterMetadata("reference", "equals", 29)
  var BDagua = BDamostras.filterMetadata("reference", "equals", 33)

  // Complementary samples
  // Merge the training points for different classes
  var amostraTotal = varzea.merge(agro).merge(flo)//flo.merge(agr).merge(agua).merge(varzea)
  
  // Reduce the training points to an image
  var amostraTotalimg = amostraTotal.reduceToImage({properties: ['reference'],reducer: ee.Reducer.first()})

  // Rename the band to 'reference'
  amostraTotalimg = amostraTotalimg.select([0],['reference'])

  // Sample the mosaic using the training points for each class
  var training_flo = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 400, 'region': flo.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_nflo = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 300, 'region': nao_flo.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_sav = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 1500, 'region': sav.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_afl = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 1000, 'region': aflora.filterBounds(limite), 'scale': 10, 'seed': 1});
  var training_var = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 500, 'region': varzea.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_agu = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 100, 'region': agua.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_cam = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 800, 'region': campo.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_nflo = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 200, 'region': n_flo.filterBounds(limite), 'scale': 10, 'seed': 1});
  var training_agr = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 800, 'region': agro.filterBounds(limite), 'scale': 10, 'seed': 1});

// If collecting data, print the size of each training set
if (coleta) {
// print('BDflo',BDflo.size())
// print('BDsav',BDsav.size())
print('BDvar',BDvarzea.size())
// print('BDcam',BDcampo.size())
// print('BDOut',BDOutroNFlo.size())
// print('BDAfl',BDAflora.size())
// print('BDagr',BDagro.size())
// print('BDNao',BDNaoVeg.size())
// print('BDagu',BDagua.size())
//print('training_flo',training_flo.size())
//print('training_cam',training_cam.size())
//print('training_sav',training_sav.size())
//print('training_afl',training_afl.size())
//print('training_cam',training_cam.size())
print('training_agr',training_agr.size())
print('training_var',training_var.size())
}

  // Merge all training points into a single feature collection
  var training = BDflo.merge(BDreflo).merge(BDcampo)//.merge(BDsav).merge(BDOutroNFlo).merge(BDAflora)
                      .merge(BDagro).merge(BDNaoVeg).merge(BDagua)
                      //complementares
                      // .merge(training_afl)
                      .merge(training_var).merge(training_agr).merge(training_flo)
                      // .merge(training_sav)
                      // .merge(training_agr).merge(training_flo)//.merge(training_agu)

  // Train a Random Forest classifier
  var classifierRF = ee.Classifier.smileRandomForest({numberOfTrees: RFtrees, variablesPerSplit:1}).train(training, 'reference', bandNames);

  // If collecting data, print the classifier explanation
  if (coleta) {print(classifierRF.explain())}

  // Train a Gradient Tree Boost classifier
  var classifierGTB = ee.Classifier.smileGradientTreeBoost({numberOfTrees: 30, shrinkage: 0.1, samplingRate: 0.8, loss: 'LeastSquares'}).train(training, 'reference', bandNames);

  // print(classifier.explain())

  // Classify the mosaic using the Random Forest classifier
  var classifiedRF = mosaicoTotal.classify(classifierRF).mask(mosaicoTotal.select('blue_median'));

  // Classify the mosaic using the Gradient Tree Boost classifier
  var classifiedGTB = mosaicoTotal.classify(classifierGTB).mask(mosaicoTotal.select('blue_median'));

  // Rename the classification band and clip the image to the region
  classifiedRF = classifiedRF.select(['classification'],['classification_'+ano]).clip(limite.geometry()).toInt8()
  // classifiedGTB = classifiedGTB.select(['classification'],['classification_'+ano]).clip(limite.geometry()).toInt8()

  // If collecting data, add the classified layers to the map
  if (coleta) {  
    Map.addLayer(classifiedRF, vis, 'RF'+ano+"_"+regiaoID, false);
//    Map.addLayer(classifiedGTB, vis, 'GTB'+ano+"_"+regiaoID, false);
  }

  // If this is the first year, initialize the classified image for the entire period
  if (i_ano == 0){ var classified16a23RF = classifiedRF;}//  var classified16a23GTB = classifiedGTB}  
  // Otherwise, add the current year's classification to the image
  else {classified16a23RF = classified16a23RF.addBands(classifiedRF);}// classified16a23GTB = classified16a23GTB.addBands(classifiedGTB)}
}

// If collecting data, do nothing
if (coleta) {}
// Otherwise, export the classified image to an asset
   else 
   {
     // Set the metadata for the classified image
     classified16a23RF = classified16a23RF
     .set('territory', 'BRAZIL')
     .set('biome', 'MATA ATÂNTICA')
     .set('source', 'arcplan')
     .set('version', '1')
     .set('collection_id',versao_out)

//     classified16a23GTB = classified16a23GTB
//     .set('territory', 'BRAZIL')
//     .set('biome', 'MATA ATÂNTICA')
//     .set('source', 'arcplan')
//     .set('version', '1')
//     .set('collection_id',versao_out)
     
    // Export the classified image to an asset
    Export.image.toAsset({
       "image": classified16a23RF.toInt8(),
       "description": regiaoID+'-'+'RF_SENTINEL2_v'+versao_out,
       "assetId": dirout + regiaoID+'-'+'RF_SENTINEL2_v'+versao_out,
       "scale": 10,
       "pyramidingPolicy": {
           '.default': 'mode'
       },
       "maxPixels": 1e13,
       "region": limite
     });    
     
//    Export.image.toAsset({
//       "image": classified16a23GTB.toInt8(),
//       "description": regiaoID+'-'+'GTB_SENTINEL2_v'+versao_out,
//       "assetId": dirout + regiaoID+'-'+'GTB_SENTINEL2_v'+versao_out,
//       "scale": 10,
//       "pyramidingPolicy": {
//           '.default': 'mode'
//       },
//       "maxPixels": 1e13,
//       "region": limite
//     });    
}
