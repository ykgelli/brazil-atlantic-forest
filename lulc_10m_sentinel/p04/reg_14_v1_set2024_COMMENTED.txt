var varzea = /* color: #98ff00 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.08581682485248, -24.022314929155435],
                  [-54.072427237450135, -24.025764334730354],
                  [-54.0593809728017, -24.021687754560862],
                  [-54.07826372426654, -24.019179025585988]]]),
            {
              "reference": 11,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.12701555532123, -24.0289000776526],
                  [-54.13971849721576, -24.030781486681473],
                  [-54.14418169301654, -24.03705265116331],
                  [-54.12392565053607, -24.03485777841268],
                  [-54.1143126134267, -24.027018641080005]]]),
            {
              "reference": 11,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.20014330190326, -24.05366975640933],
                  [-54.17885729116107, -24.050534618123734],
                  [-54.17576738637592, -24.02795936280917],
                  [-54.226235831200135, -24.04739940327591]]]),
            {
              "reference": 11,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.93132158559467, -24.031408616903313],
                  [-53.9165587071767, -24.030781486681473],
                  [-53.92617174428607, -24.0289000776526]]]),
            {
              "reference": 11,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.14699718263391, -24.00003953769708],
                  [-54.12495561879779, -23.9918934379785],
                  [-54.150361502586854, -23.995030006732563]]]),
            {
              "reference": 11,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.69028601874892, -24.451536455345433],
                  [-53.6918309711415, -24.444660591836865],
                  [-53.691659309764546, -24.451458322640153],
                  [-53.69123015632216, -24.45247404402977]]]),
            {
              "reference": 11,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.64805732001845, -24.427391144553116],
                  [-53.650718071361226, -24.429735552143224],
                  [-53.64779982795302, -24.42879779433588]]]),
            {
              "reference": 11,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.53501044324267, -24.381125160512664],
                  [-53.53192053845751, -24.384877566349587],
                  [-53.533808813604, -24.380656101951125]]]),
            {
              "reference": 11,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.62126369225725, -24.329391816648073],
                  [-53.620147893307056, -24.336821381772832],
                  [-53.61886043297991, -24.336821381772832],
                  [-53.6196329091762, -24.332911138645237],
                  [-53.6196329091762, -24.32907898329579]]]),
            {
              "reference": 11,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.63491332057258, -24.26986114477478],
                  [-53.6388615322425, -24.269626409740113],
                  [-53.634999151261056, -24.27158252177974]]]),
            {
              "reference": 11,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.673708791763985, -24.26727903554558],
                  [-53.674223775894845, -24.266261826596246],
                  [-53.675253744156564, -24.26641832081067],
                  [-53.6758545589759, -24.26837448223214]]]),
            {
              "reference": 11,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.43825302455049, -24.190299239532642],
                  [-53.44031296107393, -24.18920312087479],
                  [-53.44323120448213, -24.189907769664753],
                  [-53.439368823500686, -24.19116046901269]]]),
            {
              "reference": 11,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.710558978618316, -24.154299047850696],
                  [-53.709614841045074, -24.1515579606698],
                  [-53.71141728550308, -24.1504615093323],
                  [-53.7124472537648, -24.1543773637632]]]),
            {
              "reference": 11,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.71666139662241, -24.163484782900667],
                  [-53.72121042311167, -24.168496544055333],
                  [-53.71975130140757, -24.16943622737208],
                  [-53.71631807386851, -24.1663822313063]]]),
            {
              "reference": 11,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.638274272239116, -24.06162819474931],
                  [-53.638531764304545, -24.059825611368613],
                  [-53.63990505532017, -24.05974723760374],
                  [-53.63990505532017, -24.062098429727648]]]),
            {
              "reference": 11,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.74082013817657, -23.954129578868216],
                  [-53.74292295922792, -23.954639369834858],
                  [-53.74210756388791, -23.959541640279298],
                  [-53.743995873650206, -23.9620515896231],
                  [-53.74021932335724, -23.96032604458526]]]),
            {
              "reference": 11,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.91937674108616, -23.654175550087043],
                  [-53.925556550656474, -23.63514824338217],
                  [-53.93705786291233, -23.639708759023037],
                  [-53.921780000363505, -23.658892636101218]]]),
            {
              "reference": 11,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.387419373922135, -23.454517888823606],
                  [-53.382441193990495, -23.455698969155677],
                  [-53.38184037917116, -23.454596627841045],
                  [-53.38630357497194, -23.454202932284332]]]),
            {
              "reference": 11,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.77474578845238, -23.347204503760178],
                  [-53.77714904772972, -23.3648551767551],
                  [-53.76616271960472, -23.339639210952573]]]),
            {
              "reference": 11,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.72393402087425, -23.346258865735695],
                  [-53.7208441160891, -23.33774782039568],
                  [-53.730113830444566, -23.34562843664348]]]),
            {
              "reference": 11,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.30721171851494, -23.246204639485104],
                  [-53.29828532691338, -23.246046913939264],
                  [-53.30446513648369, -23.24478510285823]]]),
            {
              "reference": 11,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.99027951541092, -23.24729508630142],
                  [-52.98152478518631, -23.248714596215518],
                  [-52.97174008669998, -23.23972411162311]]]),
            {
              "reference": 11,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.726038303874425, -23.32685544754418],
                  [-52.72646745731681, -23.32929868895407],
                  [-52.72560915043204, -23.32843173746767],
                  [-52.725265827678136, -23.32685544754418]]]),
            {
              "reference": 11,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.67058497487431, -23.526915104526907],
                  [-52.67006999074345, -23.530771142792997],
                  [-52.66912585317021, -23.526364232693627]]]),
            {
              "reference": 11,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.652732191671184, -23.51046665232493],
                  [-52.64886981068974, -23.502517142394414],
                  [-52.652474699605754, -23.505350686104013],
                  [-52.65616541921025, -23.51156852673332]]]),
            {
              "reference": 11,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.719208559877615, -23.61306572010987],
                  [-52.72101100433562, -23.614402664792273],
                  [-52.72032435882781, -23.61998622750102]]]),
            {
              "reference": 11,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.662410458134914, -23.52258243953971],
                  [-52.666873653935696, -23.52683208464861],
                  [-52.66000719885757, -23.524628582090642]]]),
            {
              "reference": 11,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.354582968808636, -24.832275952849447],
                  [-54.352587405301556, -24.833970154745277],
                  [-54.35097807989262, -24.83451541019423],
                  [-54.35093516384642, -24.83225646257193],
                  [-54.34984082276411, -24.831165934416312],
                  [-54.35089224920414, -24.830464883807824],
                  [-54.35267323599003, -24.83108805033824],
                  [-54.35423964605473, -24.830776467465064]]]),
            {
              "reference": 11,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.35823077306889, -24.828478519562292],
                  [-54.35739392225344, -24.828459044841072],
                  [-54.35741538152836, -24.827504799961293],
                  [-54.35818785772465, -24.82653107270436]]]),
            {
              "reference": 11,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.30935019598149, -24.828517468187083],
                  [-54.30960768804692, -24.826803717108014],
                  [-54.31132430181645, -24.82516784168308],
                  [-54.31029433355473, -24.828829056744436]]]),
            {
              "reference": 11,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.20834893331669, -24.868783788767526],
                  [-54.20761937246464, -24.8696793122524],
                  [-54.206803980924114, -24.8696793122524],
                  [-54.207061472989544, -24.86905634008017]]]),
            {
              "reference": 11,
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.21431855347195, -24.88898701064368],
                  [-54.21406106140652, -24.888558784538073],
                  [-54.21556309845486, -24.88774125784958],
                  [-54.216378489995385, -24.888753432951972]]]),
            {
              "reference": 11,
              "system:index": "31"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.27359173497024, -24.897851842913866],
                  [-54.27352736195388, -24.896333689021112],
                  [-54.274192549789575, -24.896177979873926],
                  [-54.274192549789575, -24.897793452724763]]]),
            {
              "reference": 11,
              "system:index": "32"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.330819302087384, -24.895319723513236],
                  [-54.3283731274658, -24.89304243896634],
                  [-54.3319565587097, -24.893723682336525],
                  [-54.33390920687254, -24.8946190250495],
                  [-54.33418815661009, -24.895358651089055],
                  [-54.33124845552977, -24.894074034606145]]]),
            {
              "reference": 11,
              "system:index": "33"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.26013631805685, -24.9081727281674],
                  [-54.260050487368375, -24.906985554841608],
                  [-54.26067275985983, -24.906946630932612],
                  [-54.26043672546652, -24.907472102667942],
                  [-54.26060838684347, -24.90791972497373]]]),
            {
              "reference": 11,
              "system:index": "34"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.38066460934316, -24.89498533917927],
                  [-54.38384034481679, -24.893155724315296],
                  [-54.38435532894765, -24.894245710903306],
                  [-54.381737492949114, -24.895141049830656]]]),
            {
              "reference": 11,
              "system:index": "35"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.31952457662584, -24.878972753186822],
                  [-54.31973915334703, -24.87718183441201],
                  [-54.32055454488756, -24.87630583207927],
                  [-54.3209407829857, -24.87945941141186]]]),
            {
              "reference": 11,
              "system:index": "36"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.30839190433703, -24.789433505207672],
                  [-54.30706152866564, -24.789433505207672],
                  [-54.306761121255974, -24.788965973502055],
                  [-54.30787692020617, -24.788732206988524],
                  [-54.31040892551623, -24.789394544299498]]]),
            {
              "reference": 11,
              "system:index": "37"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.30820043208018, -24.792293512479944],
                  [-54.30614049555674, -24.79096886527733],
                  [-54.30768544794932, -24.791046786092576]]]),
            {
              "reference": 11,
              "system:index": "38"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.304041821932174, -24.831182289996995],
                  [-54.30408473727641, -24.830150169512144],
                  [-54.305221993898726, -24.830500701962297],
                  [-54.30507179019389, -24.831240711653958]]]),
            {
              "reference": 11,
              "system:index": "39"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.287753810718456, -24.81328129482572],
                  [-54.28882669432441, -24.814196696562767],
                  [-54.28809713347236, -24.81462518015883],
                  [-54.287303199603954, -24.813690304948178]]]),
            {
              "reference": 11,
              "system:index": "40"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.28917001707832, -24.812473008947222],
                  [-54.28742121680061, -24.809970210805755],
                  [-54.290017595127026, -24.811810794901085]]]),
            {
              "reference": 11,
              "system:index": "41"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.35669910802819, -25.10310434545544],
                  [-54.35944569005944, -25.10427019420839],
                  [-54.356527446651235, -25.104542223984836],
                  [-54.35519707097985, -25.103259792597996],
                  [-54.355797885799184, -25.102093934212757]]]),
            {
              "reference": 11,
              "system:index": "42"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.311342242288795, -25.047228351888084],
                  [-54.31016207032224, -25.04796706106443],
                  [-54.310376647043434, -25.04808369894859],
                  [-54.311556819009986, -25.047519948147286],
                  [-54.311857226419654, -25.047617146746237],
                  [-54.31048393540403, -25.048355853580055],
                  [-54.309346678781715, -25.04860856805405],
                  [-54.30919647507688, -25.04829753478132],
                  [-54.30990457825681, -25.047519948147286],
                  [-54.310333731699195, -25.047111713190226]]]),
            {
              "reference": 11,
              "system:index": "43"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.30419683747312, -25.047131152980903],
                  [-54.30222273163816, -25.047053393799672],
                  [-54.30381059937498, -25.046042519956092]]]),
            {
              "reference": 11,
              "system:index": "44"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.51179481607951, -25.395991809233422],
                  [-54.51130128962077, -25.39537151591607],
                  [-54.51119400126017, -25.394421685595496],
                  [-54.512395630898844, -25.395332747477884],
                  [-54.512395630898844, -25.396340722823407]]]),
            {
              "reference": 11,
              "system:index": "45"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.52234000464059, -25.39240569443201],
                  [-54.522747700410854, -25.39077736929598],
                  [-54.522726242738734, -25.389943813405004],
                  [-54.523176853853236, -25.389304103817704],
                  [-54.52405661841012, -25.389943813405004],
                  [-54.52352017660714, -25.391223222409838],
                  [-54.52306956549264, -25.391727228294727],
                  [-54.52306956549264, -25.393064772170884]]]),
            {
              "reference": 11,
              "system:index": "46"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.51980589421049, -25.394340935159523],
                  [-54.518722281768476, -25.394263397608604],
                  [-54.51835750134245, -25.393875709106883],
                  [-54.519258723571454, -25.39321663579603],
                  [-54.51980589421049, -25.393100328367595],
                  [-54.520492539718305, -25.393875709106883],
                  [-54.5196986058499, -25.393517096134097],
                  [-54.51961277516142, -25.394011400224137]]]),
            {
              "reference": 11,
              "system:index": "47"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.97006156310309, -24.040089629220137],
                  [-53.970834039299376, -24.041422180732074],
                  [-53.96980407103766, -24.04165733544611],
                  [-53.968602441398986, -24.040011243406564]]]),
            {
              "reference": 11,
              "system:index": "48"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.168566824212114, -24.036418713725798],
                  [-54.16865265490059, -24.03845678633148],
                  [-54.16633522631172, -24.036889041043167],
                  [-54.16994011522774, -24.033988661822733]]]),
            {
              "reference": 11,
              "system:index": "49"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.144791723504106, -24.03532127662246],
                  [-54.1459075224543, -24.034380608786893],
                  [-54.14547836901192, -24.036653877599722]]]),
            {
              "reference": 11,
              "system:index": "50"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.32819669907998, -24.12707929769941],
                  [-54.33128660386514, -24.12758845867062],
                  [-54.32944124406289, -24.12927259206028]]]),
            {
              "reference": 11,
              "system:index": "51"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.309218786644216, -24.122304237244013],
                  [-54.307759664940114, -24.12081585339085],
                  [-54.30840339510369, -24.120424170552052]]]),
            {
              "reference": 11,
              "system:index": "52"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.49132854595415, -25.54527607581212],
                  [-54.48806697979204, -25.544269347778144],
                  [-54.48926860943071, -25.54380470121878],
                  [-54.490899392511764, -25.544346788696288]]]),
            {
              "reference": 11,
              "system:index": "53"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.47347576275102, -25.55402650948956],
                  [-54.47150165691606, -25.552477806696654],
                  [-54.47493488445512, -25.553097290215558]]]),
            {
              "reference": 11,
              "system:index": "54"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.07504970684282, -25.412625075176134],
                  [-54.07410556926958, -25.410144224830947],
                  [-54.0754788602852, -25.411074549690703]]]),
            {
              "reference": 11,
              "system:index": "55"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.98939067974321, -25.429834569121688],
                  [-53.98844654216997, -25.429602024769743],
                  [-53.99033481731645, -25.42890438902133]]]),
            {
              "reference": 11,
              "system:index": "56"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.367560693170944, -24.928521103777292],
                  [-54.36644489422075, -24.926964409675538],
                  [-54.36841900005571, -24.927120079970287]]]),
            {
              "reference": 11,
              "system:index": "57"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.32541782512895, -24.926808739184214],
                  [-54.32404453411333, -24.92688657445445],
                  [-54.324817010309616, -24.925407695916874]]]),
            {
              "reference": 11,
              "system:index": "58"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.29252382163195, -24.096499998280446],
                  [-54.3004202449718, -24.10135768842658],
                  [-54.29707284812121, -24.104569930713147],
                  [-54.29183717612414, -24.09994741026542],
                  [-54.2938112819591, -24.097988664837413]]]),
            {
              "reference": 11,
              "system:index": "59"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.30229133004494, -24.107745517123412],
                  [-54.29920142525978, -24.107353794287587],
                  [-54.297141488736344, -24.105551853807505],
                  [-54.29928725594826, -24.103279805755975],
                  [-54.302377160733414, -24.10500343210655]]]),
            {
              "reference": 11,
              "system:index": "60"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.701476510709, -24.12430807188541],
                  [-53.703879769986344, -24.13245458070833],
                  [-53.701133187955094, -24.13245458070833],
                  [-53.69975989693947, -24.127128075959117]]]),
            {
              "reference": 11,
              "system:index": "61"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.482737277368905, -23.94769936816713],
                  [-53.481964801172616, -23.946993387606852],
                  [-53.48368141494215, -23.944404759166556]]]),
            {
              "reference": 11,
              "system:index": "62"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.47818825087965, -23.93271606294805],
                  [-53.477501605371835, -23.932323806463085],
                  [-53.48007652602613, -23.928401176064273],
                  [-53.48136398635328, -23.929185711678098]]]),
            {
              "reference": 11,
              "system:index": "63"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.49243614516676, -23.933735924231033],
                  [-53.49252197585523, -23.93161774178669],
                  [-53.49458191237867, -23.93326522002469]]]),
            {
              "reference": 11,
              "system:index": "64"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.72031662307203, -23.941423849959644],
                  [-53.719715808252694, -23.944247870925157],
                  [-53.71585342727125, -23.941423849959644],
                  [-53.717913363794686, -23.939462687927094]]]),
            {
              "reference": 11,
              "system:index": "65"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.729929660181405, -23.94895443517929],
                  [-53.729672168115975, -23.950131049413205],
                  [-53.728213046411874, -23.94950352315737],
                  [-53.72855636916578, -23.948170019727634]]]),
            {
              "reference": 11,
              "system:index": "66"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.74297592482984, -23.965896644503633],
                  [-53.740401004175546, -23.96346526054268],
                  [-53.743662570337655, -23.96479860581315]]]),
            {
              "reference": 11,
              "system:index": "67"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.74658081374586, -23.970602418653613],
                  [-53.74632332168043, -23.96785740461365],
                  [-53.75001404128492, -23.970053420523147]]]),
            {
              "reference": 11,
              "system:index": "68"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.831295703272225, -24.00643909119313],
                  [-53.83095238051832, -24.008007207870563],
                  [-53.82451507888258, -24.007223151921174],
                  [-53.82511589370191, -24.005811839170164]]]),
            {
              "reference": 11,
              "system:index": "69"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.8464019044441, -24.016631507889795],
                  [-53.842539523462655, -24.016161106437462],
                  [-53.84262535415113, -24.01459308916853]]]),
            {
              "reference": 11,
              "system:index": "70"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.89820328843418, -23.66202898724624],
                  [-53.89416924607578, -23.663050975613178],
                  [-53.89425507676426, -23.660456681853674],
                  [-53.898374949811135, -23.659906370499918]]]),
            {
              "reference": 11,
              "system:index": "71"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.865673457501565, -23.663050975613178],
                  [-53.86258355271641, -23.661478682509333],
                  [-53.86558762681309, -23.66116422161987]]]),
            {
              "reference": 11,
              "system:index": "72"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.732703533213034, -25.765533975672728],
                  [-53.73302539829482, -25.766538838106488],
                  [-53.73246749881972, -25.765978435106064]]]),
            {
              "reference": 11,
              "system:index": "73"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.73107275013198, -25.763872069133917],
                  [-53.731137123148336, -25.764374508448224],
                  [-53.73083671573867, -25.764219911962634]]]),
            {
              "reference": 11,
              "system:index": "74"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.72506460193862, -25.766171677818875],
                  [-53.72500022892226, -25.766983293777244],
                  [-53.72433504108657, -25.766538838106488]]]),
            {
              "reference": 11,
              "system:index": "75"
            })]),
    agro = /* color: #ff0000 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.78355740831479, -25.687155553767777],
                  [-52.7827849321185, -25.685840623653462],
                  [-52.78458737657651, -25.68661411371384],
                  [-52.78432988451108, -25.687619643283828]]]),
            {
              "reference": 21,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.83977650926694, -25.691951058239272],
                  [-52.84097813890561, -25.692801853381546],
                  [-52.83994817064389, -25.693807330713383]]]),
            {
              "reference": 21,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.847415440541354, -25.63918989480894],
                  [-52.847672932606784, -25.635707765544048],
                  [-52.848617070180026, -25.63864823692731]]]),
            {
              "reference": 21,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.92306207234571, -25.618055529737376],
                  [-52.92392037923047, -25.616739837824277],
                  [-52.924607024738286, -25.61766856303146]]]),
            {
              "reference": 21,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.8978278499336, -25.61457278427066],
                  [-52.89954446370313, -25.614108410539426],
                  [-52.89971612508008, -25.615578921164822]]]),
            {
              "reference": 21,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.934391723224614, -25.6342296168727],
                  [-52.93645165974805, -25.63322363705676],
                  [-52.93525003010938, -25.63523558821323]]]),
            {
              "reference": 21,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.07309411580274, -25.628890088656927],
                  [-53.07086251790235, -25.6271875801904],
                  [-53.071463332721684, -25.62502071613475],
                  [-53.07300828511426, -25.627264967465376]]]),
            {
              "reference": 21,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.17669175679395, -25.604144768856177],
                  [-53.17815087849805, -25.603835159560845],
                  [-53.1794383388252, -25.60391256195985],
                  [-53.17875169331739, -25.605383198020153],
                  [-53.177550063678716, -25.605073591931777]]]),
            {
              "reference": 21,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.20561669881055, -25.64013138369151],
                  [-53.20484422261426, -25.63664928188806],
                  [-53.20810578877637, -25.640054004754898]]]),
            {
              "reference": 21,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.31231559489169, -25.641591341446183],
                  [-53.310770642499115, -25.64182347511588],
                  [-53.311028134564545, -25.640817559286784]]]),
            {
              "reference": 21,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.43127692912021, -25.633698528084718],
                  [-53.43368018839755, -25.632460392369996],
                  [-53.43393768046298, -25.63338899535962],
                  [-53.43230689738193, -25.634240208422884]]]),
            {
              "reference": 21,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.43041862223544, -25.651804795801795],
                  [-53.4309336063663, -25.650179986536095],
                  [-53.43247855875888, -25.651650053015512]]]),
            {
              "reference": 21,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.53102469422168, -25.58508183732237],
                  [-53.53454375244922, -25.58446251923828],
                  [-53.532827138679686, -25.58717201219235]]]),
            {
              "reference": 21,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.57848906494922, -25.596461236507494],
                  [-53.57934737183398, -25.594603449350668],
                  [-53.580034017341795, -25.595919384900824]]]),
            {
              "reference": 21,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.622613744614696, -25.448718473355594],
                  [-53.62085421550093, -25.450384766815283],
                  [-53.62029631602583, -25.449687251429186],
                  [-53.62184126841841, -25.44852471680545]]]),
            {
              "reference": 21,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.62660471776414, -25.45952876114196],
                  [-53.62647612559614, -25.45894837629679],
                  [-53.62797816264448, -25.45743719536678],
                  [-53.62832148539839, -25.458793384254175],
                  [-53.626991109727, -25.459723333515566]]]),
            {
              "reference": 21,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.49785144418652, -25.37870001906446],
                  [-53.50064094156201, -25.379165303595464],
                  [-53.502057147921875, -25.380832558445434],
                  [-53.49819476694043, -25.37974690673857]]]),
            {
              "reference": 21,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.53158290475781, -25.377536799895143],
                  [-53.533256603183105, -25.380057093936365],
                  [-53.531239582003906, -25.37835105448993]]]),
            {
              "reference": 21,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.503649069154214, -25.336328994975858],
                  [-53.503649069154214, -25.33927679974007],
                  [-53.50133164056535, -25.339819808574287]]]),
            {
              "reference": 21,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.55033891890392, -25.1367513226621],
                  [-53.55849283430919, -25.130690398835597],
                  [-53.55205553267345, -25.138849264671045]]]),
            {
              "reference": 21,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.63711374495372, -25.150814615062497],
                  [-53.638572866657825, -25.152135393540952],
                  [-53.637027914265246, -25.15283462341846]]]),
            {
              "reference": 21,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.60578554365978, -25.09424081238916],
                  [-53.605871374348254, -25.0914425272874],
                  [-53.60853212569103, -25.09175345101464],
                  [-53.60793131087169, -25.094085353784724]]]),
            {
              "reference": 21,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.41471145948343, -25.237330070695702],
                  [-53.41556976636819, -25.232749336362904],
                  [-53.416256411876006, -25.23639840989934]]]),
            {
              "reference": 21,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.09219955338632, -24.863383179897998],
                  [-54.0937445057789, -24.862876989467637],
                  [-54.093358267680756, -24.863655743117512]]]),
            {
              "reference": 21,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.91842435062225, -25.660096929876],
                  [-52.91670773685272, -25.656383305756115],
                  [-52.92048428714569, -25.65700225113881]]]),
            {
              "reference": 21,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.946290322687545, -25.484779959025985],
                  [-52.94560367717973, -25.48013110937967],
                  [-52.95212680950395, -25.481370820196215]]]),
            {
              "reference": 21,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.55740482464067, -25.360749183850576],
                  [-53.55843479290239, -25.365092415013784],
                  [-53.55465824260942, -25.365092415013784],
                  [-53.55225498333208, -25.361059419823665]]]),
            {
              "reference": 21,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.3881894252958, -24.96166489943742],
                  [-54.39299594385049, -24.968201040861487],
                  [-54.38544284326455, -24.967578566158377]]]),
            {
              "reference": 21,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.05026065332314, -24.58697218467493],
                  [-53.03893100244424, -24.58166477534086],
                  [-53.039960970705955, -24.57885487934463],
                  [-53.050947298830955, -24.581352567787416]]]),
            {
              "reference": 21,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.33654161338, -24.274781512290737],
                  [-53.340661486426875, -24.26445316050784],
                  [-53.34546800498156, -24.266644093152724]]]),
            {
              "reference": 21,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.9350378052704, -23.847647001243992],
                  [-52.937097741793835, -23.855183049724186],
                  [-52.929887963961804, -23.854555062422968],
                  [-52.928857995700085, -23.849845060652633]]]),
            {
              "reference": 21,
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.95895806443516, -23.587716916610898],
                  [-52.952778254864846, -23.597784934623103],
                  [-52.95140496384922, -23.589919361572015]]]),
            {
              "reference": 21,
              "system:index": "31"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.87724724900547, -23.492976847575182],
                  [-52.875873957989846, -23.499273984515806],
                  [-52.870380793927346, -23.49738487502586]]]),
            {
              "reference": 21,
              "system:index": "32"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.26425782334629, -23.20471987053053],
                  [-53.262884532330666, -23.218287785799063],
                  [-53.255674754498635, -23.2179722685357]]]),
            {
              "reference": 21,
              "system:index": "33"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.2426284898502, -23.212608361028238],
                  [-53.240225230572854, -23.21954984739895],
                  [-53.231985484479104, -23.216394671038998]]]),
            {
              "reference": 21,
              "system:index": "34"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.295156871197854, -23.203457668837114],
                  [-53.29927674424473, -23.207559780756824],
                  [-53.2865738023502, -23.216394671038998]]]),
            {
              "reference": 21,
              "system:index": "35"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.441412364361916, -23.207244238156346],
                  [-53.442442332623635, -23.21292389096129],
                  [-53.435232554791604, -23.214817054909815]]]),
            {
              "reference": 21,
              "system:index": "36"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.45583192002598, -23.2179722685357],
                  [-53.45102540147129, -23.229014929221126],
                  [-53.446905528424416, -23.21923433311703]]]),
            {
              "reference": 21,
              "system:index": "37"
            })]),
    solo = /* color: #8673ff */ee.FeatureCollection([]),
    flo = /* color: #dde601 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.73090795402232, -25.91280541307973],
                  [-53.727818049237165, -25.907864427503082],
                  [-53.733311213299665, -25.908482062019996]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.9482934302121, -25.694751844103067],
                  [-52.9482934302121, -25.691039299666066],
                  [-52.95138333499725, -25.692895586351593]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.2947060889035, -25.69320496465286],
                  [-53.289899570348815, -25.68949237199347],
                  [-53.2943627661496, -25.68887359529885]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.728666049841, -25.64431322893947],
                  [-53.72179959476288, -25.64462273334042],
                  [-53.7283227270871, -25.641837164837582]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.44518063724335, -25.6494309463566],
                  [-54.44518063724335, -25.65407322898348],
                  [-54.44140408695038, -25.65531114050986]]]),
            {
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.991021462824264, -25.46463364575666],
                  [-53.99479801311723, -25.473312471405478],
                  [-53.97797519817583, -25.473622417882964]]]),
            {
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.98714573040239, -25.551703447794825],
                  [-52.9878323759102, -25.556659258302435],
                  [-52.983025857355514, -25.555110589535673]]]),
            {
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.61258060589067, -25.539622801149633],
                  [-52.60605747356645, -25.540861897857656],
                  [-52.606744119074264, -25.53559564842014]]]),
            {
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.809991189386764, -25.285959112016126],
                  [-52.80690128460161, -25.294650786131474],
                  [-52.80037815227739, -25.292788336981737]]]),
            {
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.32978183880083, -25.30303145323416],
                  [-53.3284085477852, -25.307066382577553],
                  [-53.3229153837227, -25.307687129013377]]]),
            {
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.51723606243364, -25.317928986038236],
                  [-53.512086221125045, -25.316997943909474],
                  [-53.512086221125045, -25.313584061539217]]]),
            {
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.77644474163286, -25.328790615313736],
                  [-53.775758096125045, -25.33344530099392],
                  [-53.77232486858598, -25.330031882330445]]]),
            {
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.52514583721391, -25.439446009686005],
                  [-54.525832482721725, -25.434485361917332],
                  [-54.52926571026079, -25.434485361917332]]]),
            {
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.194526025202194, -25.210423997921424],
                  [-54.19418270244829, -25.213840782224807],
                  [-54.19109279766313, -25.212598326305184]]]),
            {
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.29502040996782, -25.252040106782587],
                  [-53.293647118952194, -25.247071768123106],
                  [-53.30223018779985, -25.24676124021068]]]),
            {
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.803725549127975, -25.26787532999536],
                  [-52.80303890362016, -25.26135519405832],
                  [-52.81127864971391, -25.262597151709755]]]),
            {
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.68846828594438, -25.08828874802976],
                  [-53.6894982542061, -25.083624677123677],
                  [-53.69670803203813, -25.084868446743897]]]),
            {
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.16568691387407, -25.044439467263384],
                  [-54.171523400690475, -25.04723882639719],
                  [-54.16946346416704, -25.051904282921345]]]),
            {
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.193525423830955, -24.778200545245458],
                  [-54.197301974123924, -24.770095679437297],
                  [-54.20073520166299, -24.773836452482264]]]),
            {
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.95937930566689, -24.8476936087366],
                  [-53.958349337405174, -24.852989686983456],
                  [-53.955602755373924, -24.849562838711993]]]),
            {
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.910871615237205, -24.741100868091877],
                  [-52.90469180566689, -24.737982743630436],
                  [-52.90881167871377, -24.734552716415514]]]),
            {
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.142614474123924, -24.53263866402992],
                  [-53.13918124658486, -24.53263866402992],
                  [-53.14055453760049, -24.529202995209896]]]),
            {
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.19661532861611, -24.643154476302577],
                  [-54.199018587893455, -24.63909771217002],
                  [-54.202795138186424, -24.642218311658723]]]),
            {
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.17017947656533, -24.390448531592998],
                  [-54.17086612207314, -24.38638359941798],
                  [-54.17601596338174, -24.387008982109013]]]),
            {
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.733129610842674, -24.48492130908742],
                  [-53.7290097377958, -24.48492130908742],
                  [-53.73175631982705, -24.48148433560145]]]),
            {
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.1577206752958, -24.501792362405137],
                  [-53.15394412500283, -24.498668264034066],
                  [-53.16218387109658, -24.497731019385085]]]),
            {
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.18719621543078, -24.242541757362094],
                  [-53.186852892676875, -24.235028407358893],
                  [-53.19097276572375, -24.239411248769482]]]),
            {
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.575837572852656, -24.210293831286396],
                  [-53.58167405966906, -24.209667577146863],
                  [-53.58270402793078, -24.213425055816458]]]),
            {
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.072625597755, -24.35550148182628],
                  [-54.068505724708125, -24.352060981806954],
                  [-54.071252306739375, -24.348620388277638]]]),
            {
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-54.26042314414172, -24.321092274867574],
                  [-54.25904985312609, -24.32547214752136],
                  [-54.25561662558703, -24.32578498977697]]]),
            {
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.96137183541603, -24.186379161842314],
                  [-53.962745126431656, -24.180115307312885],
                  [-53.969268258755875, -24.179802106514337]]]),
            {
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.30150550240822, -24.095791206675777],
                  [-53.29841559762306, -24.09265709793514],
                  [-53.304595407193375, -24.089836334521344]]]),
            {
              "system:index": "31"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.7482702271454, -23.866486300617737],
                  [-52.7482702271454, -23.87464914609494],
                  [-52.74071712655946, -23.86962591747326]]]),
            {
              "system:index": "32"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.33837005935133, -23.849531054448],
                  [-53.33562347732008, -23.844820870088665],
                  [-53.33837005935133, -23.841366626114567]]]),
            {
              "system:index": "33"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.65422699294508, -23.94322809270614],
                  [-53.65319702468336, -23.93914889923613],
                  [-53.65869018874586, -23.9378937368429]]]),
            {
              "system:index": "34"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.4280838120242, -23.72693212810407],
                  [-53.42430726173123, -23.725046297051698],
                  [-53.42602387550076, -23.72096023618938]]]),
            {
              "system:index": "35"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.53081215586891, -23.7071425132628],
                  [-52.52669228282203, -23.706199458061153],
                  [-52.53149880137672, -23.70179844367019]]]),
            {
              "system:index": "36"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.04272881638828, -23.55247277153471],
                  [-53.04135552537266, -23.557822938039795],
                  [-53.0382656205875, -23.554675807649012]]]),
            {
              "system:index": "37"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.4557460893375, -23.596526474627993],
                  [-53.453686152814065, -23.593380271816475],
                  [-53.46020928513828, -23.596526474627993]]]),
            {
              "system:index": "38"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-53.44656220567051, -23.430461463071175],
                  [-53.44450226914707, -23.436761583148883],
                  [-53.44003907334629, -23.43361156064268]]]),
            {
              "system:index": "39"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.611257945416604, -23.47770504126907],
                  [-52.611944590924416, -23.47361126687138],
                  [-52.618467723248635, -23.47235161842344]]]),
            {
              "system:index": "40"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-52.945310984967385, -23.24668128636036],
                  [-52.9459976304752, -23.250151188779853],
                  [-52.94222108018223, -23.24952030414576]]]),
            {
              "system:index": "41"
            })]);

// Define the region ID (reg_14)
var regiaoID = 'reg_14'; // old 8

// Define whether to collect data (false)
var coleta = false;   // true or false

// Define the years to process (2016-2023)
var anos = [2016,2017,2018,2019,2020,2021,2022,2023]

// If collecting data, only process 2023
if (coleta) {var anos = [2023]}

// Define the number of trees for the Random Forest classifier (100)
var RFtrees = 100;

// If collecting data, use 200 trees
if (coleta) {var RFtrees = 200}

// Define the output version (1)
var versao_out = 1;

// Define the version of the point data (S2_v1)
var versao_pt = 'S2_v1';

// Define the stable version (3)
var versao_estavel = '3'

// Define the input directory for point data
var dir_pt_in = 'projects/mapbiomas-workspace/AMOSTRAS/col9/MATA_ATLANTICA/teste/';

// Load the 250,000 biomes feature collection
var bioma250mil = ee.FeatureCollection('projects/mapbiomas-workspace/AUXILIAR/biomas_IBGE_250mil');

// Filter the collection to only include the Atlantic Forest biome
var bioma250mil_MA_vetor = bioma250mil.filterMetadata('Bioma','equals', 'Mata Atlntica');

// Load the biomes raster
var biomes = ee.Image('projects/mapbiomas-workspace/AUXILIAR/biomas-raster-41');

// Mask the biomes raster to only include the Atlantic Forest biome
var bioma250mil_MA = biomes.mask(biomes.eq(2));

// Add the Atlantic Forest biome layer to the map
Map.addLayer(bioma250mil_MA,{},'layer bioma',false)

// Import the palettes module
var palettes = require('users/mapbiomas/modules:Palettes.js');

// Define the visualization parameters for the classification
var vis = {
    'min': 0,
    'max': 62,
    'palette': palettes.get('classification7')
};

// Load the Atlantic Forest regions feature collection
var regioesCollection = ee.FeatureCollection('projects/mapbiomas-workspace/AUXILIAR/Mata_Atlantica_col6_PLANET');

// Define the visualization parameters for the median composite
var visParMedian2 = {bands: ['swir1_median', 'nir_median', 'red_median'],gain: [0.08, 0.06, 0.2],gamma: 0.85}

// Define the biome name (MATAATLANTICA)
var bioma = "MATAATLANTICA";

// Define the output directory
var dirout = 'projects/mapbiomas-workspace/COLECAO7/classificacao-ma/';

// Load the S2 cluster image
var S2_cluster = ee.Image('projects/mapbiomas-workspace/AMOSTRAS/S2_2024/MATA_ATLANTICA/mosaicos_MA_S2_clusters_2106_2023')

// Filter the regions collection to only include the specified region ID
var limite = regioesCollection.filterMetadata('reg_id', "equals", regiaoID);
//var limite = reg_04_rev

// Load the stable map from collection 6
var mapa_estavel_col6 = ee.Image('projects/mapbiomas-workspace/AMOSTRAS/col7/MATA_ATLANTICA/MA_amostras_estaveis85a20_col6_v1')

// Add the stable map layer to the map
Map.addLayer(mapa_estavel_col6, vis, 'mapa_estavel_col6', false);

// Create a blank image
var blank = ee.Image(0).mask(0);
// Paint the region boundary on the blank image
var outline = blank.paint(limite, 'AA0000', 2); 
// Define the visualization parameters for the outline
var visPar = {'palette':'000000','opacity': 0.6};
// Add the outline layer to the map
Map.addLayer(outline, visPar, regiaoID, false);

// Define a function to shuffle a feature collection
var shuffle = function (collection, seed) {
    // Add a random column to the collection
    collection = collection.randomColumn('random', seed || 1)
        // Sort the collection by the random column
        .sort('random', true)
        // Map over the collection and set a new ID based on the random value
        .map(function (feature) {
                var rescaled = ee.Number(feature.get('random')).multiply(1000000000).round();
                return feature.set('new_id', rescaled)});
    // Get a list of the new IDs
    var randomIdList = ee.List(collection.reduceColumns(ee.Reducer.toList(), ['new_id']).get('list'));
    // Create a sequential list of IDs
    var sequentialIdList = ee.List.sequence(1, collection.size());
    // Remap the collection using the random and sequential IDs
    var shuffled = collection.remap(randomIdList, sequentialIdList, 'new_id');
    // Return the shuffled collection
    return shuffled;
};

// Define the visualization parameters for the hand-labeled data
var vis_hand = {
    'min': 0,
    'max': 60,
    'palette': 'blue,white,green,orange,red,brown'
};

// Loop through the years
for (var i_ano=0;i_ano<anos.length; i_ano++){
  // Get the current year
  var ano = anos[i_ano];

  // Define the asset path for the Sentinel-2 mosaics
  var asset = 'projects/mapbiomas-mosaics/assets/SENTINEL/BRAZIL/mosaics-3';
  // Define the band names to use for classification
  var bandNames = ee.List([
  //  THE 60 MOST IMPORTANT BANDS FOR THIS REGION
  'osavi_median_dry','rvi_median_1','green_median_texture','awei_median_wet','ndvi_median_dry_'+ano,'ratio_median','msi_median_wet','ri_median_wet','red_edge_1_median_dry','ndwi_median_dry','blue_median','red_edge_1_median_wet','awei_median_dry','gli_median_dry','ratio_median_wet','ratio_median_dry','nddi_median_wet','spri_median','osavi_median','red_edge_4_median_wet','ndwi_median','afvi_median_wet','brightness_median','spri_median_1','awei_median','ui_median_wet','iia_median_wet','swir2_median','swir1_stdDev','swir1_median','mbi_median_dry','avi_median','iia_median','brba_median_wet','ndwi_median_'+ano,'gemi_median_wet','dswi5_median_wet','evi_median_wet','green_median_wet','swir2_stdDev','blue_median_dry','bsi_median','afvi_median','ndvi_median_dry','green_median_texture_'+ano,'red_edge_1_median','red_median_wet','red_edge_3_median','longitude','red_edge_4_stdDev','latitude','spri_median_wet','gli_median_wet','bsi_median_1','mbi_median_wet','mbi_median','red_edge_3_stdDev','ui_median','evi_median','green_median',

  // ALL 143 BANDS TO FEATURE IMPORTANCE
  //    'blue_median','afvi_median','afvi_median_dry','afvi_median_wet','avi_median','avi_median_dry','avi_median_wet','awei_median','awei_median_dry','awei_median_wet','blue_median_dry','blue_median_wet','blue_stdDev','brba_median','brba_median_dry','brba_median_wet','brightness_median','brightness_median_dry','brightness_median_wet','bsi_median','bsi_median_1','bsi_median_2','clusters_2023','co2flux_median','cvi_median','cvi_median_dry','cvi_median_wet','dswi5_median','dswi5_median_dry','dswi5_median_wet','evi_median','evi_median_dry','evi_median_wet','gcvi_median','gcvi_median_dry','gcvi_median_wet','gemi_median','gemi_median_dry','gemi_median_wet','gli_median','gli_median_dry','gli_median_wet','green_median','green_median_dry','green_median_texture','green_median_texture_2023','green_median_wet','green_min','green_stdDev','gvmi_median','gvmi_median_1','gvmi_median_dry','gvmi_median_dry_1','gvmi_median_wet','gvmi_median_wet_1','iia_median','iia_median_dry','iia_median_wet','lai_median','latitude','longitude','lswi_median','lswi_median_dry','lswi_median_wet','mbi_median','mbi_median_dry','mbi_median_wet','msi_median','msi_median_dry','msi_median_wet','nddi_median','nddi_median_dry','nddi_median_wet','ndvi_median','ndvi_median_dry','ndvi_median_dry_2023','ndvi_median_wet','ndvi_median_wet_2023','ndwi_median','ndwi_median_2023','ndwi_median_dry','ndwi_median_wet','nir_median','nir_median_contrast','nir_median_dry','nir_median_dry_contrast','nir_median_wet','nir_stdDev','osavi_median','osavi_median_dry','osavi_median_wet','ratio_median','ratio_median_dry','ratio_median_wet','red_edge_1_median','red_edge_1_median_dry','red_edge_1_median_wet','red_edge_1_stdDev','red_edge_2_median','red_edge_2_median_dry','red_edge_2_median_wet','red_edge_2_stdDev','red_edge_3_median','red_edge_3_median_dry','red_edge_3_median_wet','red_edge_3_stdDev','red_edge_4_median','red_edge_4_median_dry','red_edge_4_median_wet','red_edge_4_stdDev','red_median','red_median_contrast','red_median_dry','red_median_dry_contrast','red_median_wet','red_min','red_stdDev','ri_median','ri_median_dry','ri_median_wet','rvi_median','rvi_median_1','rvi_median_wet','shape_median','shape_median_dry','shape_median_wet','spri_median','spri_median_1','spri_median_wet','swir1_median','swir1_median_dry','swir1_median_wet','swir1_stdDev','swir2_median','swir2_median_dry','swir2_median_wet','swir2_stdDev','ui_median','ui_median_dry','ui_median_wet','wetness_median','wetness_median_dry','wetness_median_wet',
  ])

  // Filter the Sentinel-2 collection by version, year, and biome
  var collection = ee.ImageCollection(asset)
        .filter(ee.Filter.eq('version', '3'))
        .filter(ee.Filter.eq('year', ano))
        .filter(ee.Filter.inList('biome', [
            'MATAATLANTICA',
        ])); 

  // Create a mosaic of the filtered collection
  var mosaicoTotal = collection.mosaic()

  // Add indices for the Caatinga biome
  var addIndexCaatinga = require('users/marcosrosaUSP/MapBiomas_col9_MataAtlan:Mata_Atlantica_SENTINEL2/processa_Bandas_Sentinel2_CAATINGA');
  mosaicoTotal = addIndexCaatinga.get(mosaicoTotal);

  // Add bands from the S2 cluster image
  mosaicoTotal = mosaicoTotal.addBands(S2_cluster.select([
    'clusters_'+ano, 'ndvi_median_dry_'+ano,'ndvi_median_wet_'+ano,'ndwi_median_'+ano, 'green_median_texture_'+ano
    ]))
    
  // Add the Sentinel-2 mosaic layer to the map
  Map.addLayer(mosaicoTotal, {'bands': ['swir1_median', 'nir_median', 'red_median'],
    'gain': [0.08, 0.07, 0.2],'gamma': 0.85}, 'Sentinel 2 '+ano, false);
  //print(mosaicoTotal)
  //var BDamostras = ee.FeatureCollection('projects/mapbiomas-workspace/AMOSTRAS/col9/MATA_ATLANTICA/teste/REGIONs_'+regiaoID+'_'+ano)

  // Load the training points for the current year
  var BDamostras = ee.FeatureCollection('projects/mapbiomas-workspace/AMOSTRAS/S2_2024/MATA_ATLANTICA/pontos_train_v1_'+ano)
                    .filterMetadata('reg_id', 'equals', regiaoID)

   // Filter the training points by reference class
   var BDflo = BDamostras.filterMetadata("reference", "equals", 3)
    var BDsav = BDamostras.filterMetadata("reference", "equals", 4)//.limit(100)
    var BDreflo = BDamostras.filterMetadata("reference", "equals", 9)
    var BDvarzea = BDamostras.filterMetadata("reference", "equals", 11)
    var BDcampo = BDamostras.filterMetadata("reference", "equals", 12)
    var BDOutroNFlo = BDamostras.filterMetadata("reference", "equals", 13)
    var BDagro = BDamostras.filterMetadata("reference", "equals", 21)
    // BDagro = shuffle(BDagro, 2).limit(1000)
    var BDNaoVeg = BDamostras.filterMetadata("reference", "equals", 22)
    var BDAflora = BDamostras.filterMetadata("reference", "equals", 29)
    var BDagua = BDamostras.filterMetadata("reference", "equals", 33)

  // Complementary samples
  // Merge the training points for different classes
  var amostraTotal = varzea.merge(agro).merge(flo)//.merge(solo)//.merge(agua).merge(varzea)
  
  // Reduce the training points to an image
  var amostraTotalimg = amostraTotal.reduceToImage({properties: ['reference'],reducer: ee.Reducer.first()})

  // Rename the band
  amostraTotalimg = amostraTotalimg.select([0],['reference'])

  // Sample the mosaic using the training points
  var training_flo = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 300, 'region': flo.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_nflo = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 300, 'region': nao_flo.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_sav = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 1500, 'region': sav.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_afl = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 1000, 'region': aflora.filterBounds(limite), 'scale': 10, 'seed': 1});
  var training_var = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 650, 'region': varzea.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_agu = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 100, 'region': agua.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_cam = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 800, 'region': campo.filterBounds(limite), 'scale': 10, 'seed': 1});
  var training_solo = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 300, 'region': solo.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_nflo = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 200, 'region': n_flo.filterBounds(limite), 'scale': 10, 'seed': 1});
  var training_agr = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 800, 'region': agro.filterBounds(limite), 'scale': 10, 'seed': 1});

// If collecting data, print the size of each training set
if (coleta) {
// print('BDflo',BDflo.size())
// print('BDsav',BDsav.size())
// print('BDvar',BDvarzea.size())
// print('BDcam',BDcampo.size())
// print('BDOut',BDOutroNFlo.size())
// print('BDAfl',BDAflora.size())
// print('BDagr',BDagro.size())
// print('BDNao',BDNaoVeg.size())
// print('BDagu',BDagua.size())
//print('training_flo',training_flo.size())
//print('training_cam',training_cam.size())
//print('training_sav',training_sav.size())
//print('training_afl',training_afl.size())
//print('training_cam',training_cam.size())
// print('training_agr',training_agr.size())
//print('training_var',training_var.size())
//print('training_solo',training_solo.size())
}

  // Merge all the training points
  var training = BDflo.merge(BDreflo).merge(BDcampo)//.merge(BDsav).merge(BDOutroNFlo).merge(BDAflora)
                      .merge(BDagro).merge(BDNaoVeg).merge(BDagua)
                      //complementares
                      // .merge(training_afl)
                      .merge(training_var).merge(training_agr)//.merge(training_solo)
                      // .merge(training_sav)
                      .merge(training_flo)//.merge(training_agu).merge(training_agr)

  // Train a Random Forest classifier
  var classifierRF = ee.Classifier.smileRandomForest({numberOfTrees: RFtrees, variablesPerSplit:1}).train(training, 'reference', bandNames);

  // If collecting data, print the classifier explanation
  if (coleta) {print(classifierRF.explain())}

  // Train a Gradient Tree Boost classifier
  var classifierGTB = ee.Classifier.smileGradientTreeBoost({numberOfTrees: 30, shrinkage: 0.1, samplingRate: 0.8, loss: 'LeastSquares'}).train(training, 'reference', bandNames);

  // print(classifier.explain())

  // Classify the mosaic using the Random Forest classifier
  var classifiedRF = mosaicoTotal.classify(classifierRF).mask(mosaicoTotal.select('blue_median'));

  // Classify the mosaic using the Gradient Tree Boost classifier
  var classifiedGTB = mosaicoTotal.classify(classifierGTB).mask(mosaicoTotal.select('blue_median'));

  // Rename the classification band and clip the image to the region boundary
  classifiedRF = classifiedRF.select(['classification'],['classification_'+ano]).clip(limite.geometry()).toInt8()
  // classifiedGTB = classifiedGTB.select(['classification'],['classification_'+ano]).clip(limite.geometry()).toInt8()

  // If collecting data, add the classified layers to the map
  if (coleta) {  
    Map.addLayer(classifiedRF, vis, 'RF'+ano+"_"+regiaoID, false);
//    Map.addLayer(classifiedGTB, vis, 'GTB'+ano+"_"+regiaoID, false);
  }

  // If it's the first year, initialize the combined classification image
  if (i_ano == 0){ var classified16a23RF = classifiedRF;}//  var classified16a23GTB = classifiedGTB}  
  // Otherwise, add the current year's classification to the combined image
  else {classified16a23RF = classified16a23RF.addBands(classifiedRF);}// classified16a23GTB = classified16a23GTB.addBands(classifiedGTB)}
}

// If collecting data, do nothing
if (coleta) {}
// Otherwise, export the combined classification image to an asset
   else 
   {
     // Set metadata for the combined classification image
     classified16a23RF = classified16a23RF
     .set('territory', 'BRAZIL')
     .set('biome', 'MATA ATNTICA')
     .set('source', 'arcplan')
     .set('version', '1')
     .set('collection_id',versao_out)

//     classified16a23GTB = classified16a23GTB
//     .set('territory', 'BRAZIL')
//     .set('biome', 'MATA ATNTICA')
//     .set('source', 'arcplan')
//     .set('version', '1')
//     .set('collection_id',versao_out)
     
    // Export the Random Forest classification to an asset
    Export.image.toAsset({
       "image": classified16a23RF.toInt8(),
       "description": regiaoID+'-'+'RF_SENTINEL2_v'+versao_out,
       "assetId": dirout + regiaoID+'-'+'RF_SENTINEL2_v'+versao_out,
       "scale": 10,
       "pyramidingPolicy": {
           '.default': 'mode'
       },
       "maxPixels": 1e13,
       "region": limite
     });    
     
//    // Export the Gradient Tree Boost classification to an asset
//    Export.image.toAsset({
//       "image": classified16a23GTB.toInt8(),
//       "description": regiaoID+'-'+'GTB_SENTINEL2_v'+versao_out,
//       "assetId": dirout + regiaoID+'-'+'GTB_SENTINEL2_v'+versao_out,
//       "scale": 10,
//       "pyramidingPolicy": {
//           '.default': 'mode'
//       },
//       "maxPixels": 1e13,
//       "region": limite
//     });    
}
