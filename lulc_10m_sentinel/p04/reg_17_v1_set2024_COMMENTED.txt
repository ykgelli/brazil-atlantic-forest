var varzea = /* color: #ffc82d */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.98359395434208, -22.685500152072414],
                  [-42.98359395434208, -22.69167686869919],
                  [-42.97998906542607, -22.687242331101757]]]),
            {
              "reference": 11,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.0201578276331, -22.680115095076907],
                  [-43.01535130907841, -22.680907028489923],
                  [-43.01243306567021, -22.677580877416172],
                  [-43.01809789110966, -22.677264096915238]]]),
            {
              "reference": 11,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.96705955399438, -22.731843527774334],
                  [-42.96362632645532, -22.737543192396373],
                  [-42.96242469681665, -22.731526872773927]]]),
            {
              "reference": 11,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.97581428421899, -22.74213441610501],
                  [-42.978732527627194, -22.743875874414027],
                  [-42.978217543496335, -22.745775621808804],
                  [-42.973239363564694, -22.744667439037705]]]),
            {
              "reference": 11,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.91704419281699, -22.66854000070204],
                  [-42.9287171664498, -22.678994035874194],
                  [-42.92597058441855, -22.682478537166464],
                  [-42.91567090180136, -22.67012399664464]]]),
            {
              "reference": 11,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.83136744528152, -22.53528777894981],
                  [-42.82896418600418, -22.534653561718446],
                  [-42.8303374770198, -22.525615649700057]]]),
            {
              "reference": 11,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.802049072645914, -22.48748789978298],
                  [-42.80840054359318, -22.492563287504062],
                  [-42.80119076576115, -22.489549798493353]]]),
            {
              "reference": 11,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.58035460234999, -22.584341005216274],
                  [-42.587049396051164, -22.587986400868303],
                  [-42.58018294097304, -22.58608446734786],
                  [-42.57589140654921, -22.582756020493257]]]),
            {
              "reference": 11,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.39427845082065, -22.540824349607636],
                  [-42.396681710097994, -22.535750733640484],
                  [-42.396681710097994, -22.54129999154514]]]),
            {
              "reference": 11,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.26628132980249, -22.577306105347354],
                  [-42.260616504363036, -22.575404024375434],
                  [-42.26507970016382, -22.571124246203468]]]),
            {
              "reference": 11,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.309539996794676, -22.58459717250291],
                  [-42.30353184860132, -22.58364618562595],
                  [-42.302330218962645, -22.581902692633857],
                  [-42.30490513961694, -22.581902692633857]]]),
            {
              "reference": 11,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.33940907638452, -22.697559306506804],
                  [-42.341812335661864, -22.702468594925314],
                  [-42.33563252609155, -22.699618061782342]]]),
            {
              "reference": 11,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.3574335209646, -22.641644362713382],
                  [-42.35108205001733, -22.643070239236927],
                  [-42.35297032516382, -22.639743170991267]]]),
            {
              "reference": 11,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.35571690719507, -22.73081233385591],
                  [-42.35537358444116, -22.739520124685832],
                  [-42.35314198654077, -22.73698700636918]]]),
            {
              "reference": 11,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.56436339159378, -22.791411200037995],
                  [-42.556981952384795, -22.791569458214106],
                  [-42.560758502677764, -22.79014512801694]]]),
            {
              "reference": 11,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.440374581144816, -22.91165190739608],
                  [-42.450159279631144, -22.908647625122395],
                  [-42.44106122665263, -22.914814237861982]]]),
            {
              "reference": 11,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.457884041594035, -22.923352161568815],
                  [-42.45307752303935, -22.923826474890134],
                  [-42.45633908920146, -22.920822462478075]]]),
            {
              "reference": 11,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.537534920500285, -22.874647162180917],
                  [-42.54216977767802, -22.873223701248516],
                  [-42.53890821151591, -22.8776521973742]]]),
            {
              "reference": 11,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.07439078824442, -22.606859071640816],
                  [-42.076279063390906, -22.613039326736665],
                  [-42.072845835851844, -22.610979272552907]]]),
            {
              "reference": 11,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.11110972972596, -22.603674283777938],
                  [-42.11334132762635, -22.608586930580888],
                  [-42.10956477733338, -22.606209865319073]]]),
            {
              "reference": 11,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.2450056037494, -22.62728507811294],
                  [-42.244318958241585, -22.633464415256043],
                  [-42.24225902171815, -22.629027996205693]]]),
            {
              "reference": 11,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.036485770709184, -22.360485628701944],
                  [-42.03734407759395, -22.37128047694871],
                  [-42.03408251143184, -22.37350284181255],
                  [-42.03288088179317, -22.360803136182703]]]),
            {
              "reference": 11,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.949623216428655, -22.30195524498574],
                  [-41.96627436999311, -22.315295534128545],
                  [-41.96404277209272, -22.320377213769802],
                  [-41.95030986193647, -22.308149109149088]]]),
            {
              "reference": 11,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.96868878972012, -22.205450666491448],
                  [-41.96319562565762, -22.201636293504436],
                  [-41.9650839008041, -22.19623242103046]]]),
            {
              "reference": 11,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.084402965269746, -22.93024293018815],
                  [-44.0900677907092, -22.932614359548072],
                  [-44.082171367369355, -22.933879104894036]]]),
            {
              "reference": 11,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.80136258381479, -22.89908746392535],
                  [-43.79020459431284, -22.900510653630025],
                  [-43.794839451490574, -22.896241039719605]]]),
            {
              "reference": 11,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.74497182148569, -22.93165895285038],
                  [-43.74617345112436, -22.927232219897693],
                  [-43.75346905964487, -22.930710379397496]]]),
            {
              "reference": 11,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.70913977315051, -22.94865844881265],
                  [-43.71592039754016, -22.94589210505717],
                  [-43.705534884234496, -22.95466517195022]]]),
            {
              "reference": 11,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.69738096882922, -22.95577164449252],
                  [-43.697810122271605, -22.951898951000615],
                  [-43.69909758259875, -22.95490227397118]]]),
            {
              "reference": 11,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.59146940815303, -23.026504668181943],
                  [-43.58983862507198, -23.029901283236914],
                  [-43.58820784199092, -23.02761055224763]]]),
            {
              "reference": 11,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.60580313312862, -23.01315435202168],
                  [-43.61266958820674, -23.010468329916847],
                  [-43.60717642414424, -23.01426034557866]]]),
            {
              "reference": 11,
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.572157503245805, -23.00699222192656],
                  [-43.572672487376664, -23.003990056594823],
                  [-43.57747900593135, -23.011100339929357]]]),
            {
              "reference": 11,
              "system:index": "31"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.627345419229016, -22.78480726868021],
                  [-43.62648711234425, -22.790029944423278],
                  [-43.62442717582081, -22.786389918812784]]]),
            {
              "reference": 11,
              "system:index": "32"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.58872028104223, -22.56035934285139],
                  [-43.586832005895744, -22.56146901436863],
                  [-43.583570439733634, -22.55734733229783]]]),
            {
              "reference": 11,
              "system:index": "33"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.58940692655004, -22.5479938276863],
                  [-43.59146686307348, -22.55132311387641],
                  [-43.58597369901098, -22.548152366945395]]]),
            {
              "reference": 11,
              "system:index": "34"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.90458043280061, -18.894555176146618],
                  [-50.90183385076936, -18.8916317418436],
                  [-50.90603955450471, -18.891712949041345]]]),
            {
              "reference": 11,
              "system:index": "35"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.85531361761506, -18.92386790171312],
                  [-50.853940326599435, -18.92232525478126],
                  [-50.85780270758088, -18.92191929269576]]]),
            {
              "reference": 11,
              "system:index": "36"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.87681126334892, -18.509703632062156],
                  [-50.87681126334892, -18.513528950262668],
                  [-50.874922988202435, -18.511901165735605]]]),
            {
              "reference": 11,
              "system:index": "37"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.29446673177018, -18.54038515835763],
                  [-50.2929217793776, -18.54038515835763],
                  [-50.29489588521256, -18.538594875752583]]]),
            {
              "reference": 11,
              "system:index": "38"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.29137682698502, -19.01146613736099],
                  [-50.28974604390397, -19.010979243148995],
                  [-50.29189181111588, -19.010330048648783]]]),
            {
              "reference": 11,
              "system:index": "39"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.45698555570036, -19.233423530644224],
                  [-50.458444677404465, -19.23164064109645],
                  [-50.46024712186247, -19.233342490630136]]]),
            {
              "reference": 11,
              "system:index": "40"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.40917786221892, -19.219240919437162],
                  [-50.40780457120329, -19.216485298663887],
                  [-50.41020783048064, -19.217701019405766]]]),
            {
              "reference": 11,
              "system:index": "41"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.42179497342497, -19.222644857781855],
                  [-50.42291077237517, -19.225400375274162],
                  [-50.41990669827849, -19.225076199144194]]]),
            {
              "reference": 11,
              "system:index": "42"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.51097305875212, -19.280176945540973],
                  [-50.510887228063645, -19.277665402529042],
                  [-50.514148794225754, -19.27742234793592]]]),
            {
              "reference": 11,
              "system:index": "43"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.50256165128142, -19.28114914540044],
                  [-50.5000725613156, -19.282769465675358],
                  [-50.49998673062712, -19.28114914540044]]]),
            {
              "reference": 11,
              "system:index": "44"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.49775513272673, -19.288602485918606],
                  [-50.49809845548064, -19.286577155216612],
                  [-50.49955757718474, -19.28754931708031]]]),
            {
              "reference": 11,
              "system:index": "45"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.50951393704802, -19.274019545768997],
                  [-50.50745400052458, -19.272642200990383],
                  [-50.508655630163254, -19.27004952058869]]]),
            {
              "reference": 11,
              "system:index": "46"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.75344475369841, -19.46723026380817],
                  [-50.751813970617356, -19.46650194669838],
                  [-50.75241478543669, -19.46229382821586],
                  [-50.7556763515988, -19.46723026380817]]]),
            {
              "reference": 11,
              "system:index": "47"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.74202927213103, -19.462212901789965],
                  [-50.74348839383513, -19.464721602209558],
                  [-50.740827642492356, -19.46407419936596]]]),
            {
              "reference": 11,
              "system:index": "48"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.66685349039667, -18.81658428980655],
                  [-49.66582352213495, -18.81439069970117],
                  [-49.66676765970819, -18.81390323134738],
                  [-49.66762596659296, -18.816421802631925]]]),
            {
              "reference": 11,
              "system:index": "49"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.62986046366327, -18.80455981485456],
                  [-49.62908798746698, -18.805859799531373],
                  [-49.62857300333612, -18.804966061145013]]]),
            {
              "reference": 11,
              "system:index": "50"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.67011505655878, -18.901624741325865],
                  [-49.6700292258703, -18.90389839221837],
                  [-49.667196813150575, -18.902436763048435]]]),
            {
              "reference": 11,
              "system:index": "51"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.65766960672968, -18.89269224233172],
                  [-49.65638214640253, -18.893098275354543],
                  [-49.656725469156434, -18.89147413735481]]]),
            {
              "reference": 11,
              "system:index": "52"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.36163956217401, -18.826739426588876],
                  [-49.36163956217401, -18.82795800177189],
                  [-49.35966545633905, -18.828526667166493]]]),
            {
              "reference": 11,
              "system:index": "53"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.70075661234491, -19.0018795709608],
                  [-49.70255905680292, -19.00017533676772],
                  [-49.70521980814569, -19.001636110001932]]]),
            {
              "reference": 11,
              "system:index": "54"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.70101410441034, -19.025980441830335],
                  [-49.700155797525575, -19.028576960134426],
                  [-49.69698006205194, -19.026305008837497]]]),
            {
              "reference": 11,
              "system:index": "55"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.80507665403558, -18.54675028601236],
                  [-48.804218347150815, -18.55073751760163],
                  [-48.79966932066156, -18.548296366455492]]]),
            {
              "reference": 11,
              "system:index": "56"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.7980385375805, -18.55488739444663],
                  [-48.79494863279535, -18.553910961911726],
                  [-48.795463616926206, -18.55024929016447]]]),
            {
              "reference": 11,
              "system:index": "57"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.78344732053949, -18.57750651743995],
                  [-48.77992826231195, -18.579703178911707],
                  [-48.781473214704526, -18.576692931933653]]]),
            {
              "reference": 11,
              "system:index": "58"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.551284924249074, -18.62537689095401],
                  [-48.550254955987356, -18.623994182139835],
                  [-48.55214323113384, -18.624563534189974]]]),
            {
              "reference": 11,
              "system:index": "59"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.02559472598514, -19.425194239758216],
                  [-51.025637641329375, -19.426489353091767],
                  [-51.023148551363555, -19.424910932340307]]]),
            {
              "reference": 11,
              "system:index": "60"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.99388028659305, -19.428512947006297],
                  [-50.99276448764285, -19.429079548785154],
                  [-50.993665709871856, -19.427784456100934]]]),
            {
              "reference": 11,
              "system:index": "61"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.00555326022586, -19.42122789095528],
                  [-51.00456620730838, -19.42175404483548],
                  [-51.00456620730838, -19.42122789095528]]]),
            {
              "reference": 11,
              "system:index": "62"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.01761247195682, -19.422482562780292],
                  [-51.016410842318145, -19.421834991435087],
                  [-51.01756955661258, -19.421875464719758]]]),
            {
              "reference": 11,
              "system:index": "63"
            })]),
    agro = /* color: #cbd223 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.96261436173943, -17.99155338973359],
                  [-48.9634726686242, -17.98983907276506],
                  [-48.96587592790154, -17.98967580361363],
                  [-48.9634726686242, -17.99294115793627]]]),
            {
              "reference": 21,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.930599514937676, -17.99604318856042],
                  [-48.92725211808709, -17.99677787203375],
                  [-48.928625409102715, -17.994573812433195],
                  [-48.93017036149529, -17.994492180067233]]]),
            {
              "reference": 21,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.93815261552361, -18.00118590860289],
                  [-48.94055587480096, -17.99759418341482],
                  [-48.94081336686639, -18.001512425446883]]]),
            {
              "reference": 21,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.87973353702327, -17.987471655283194],
                  [-48.87750193912288, -17.985430752652128],
                  [-48.88127848941585, -17.986002207767882]]]),
            {
              "reference": 21,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.801198457067215, -18.011062775594187],
                  [-48.80179927188655, -18.007961009207516],
                  [-48.80265757877132, -18.010899526092743]]]),
            {
              "reference": 21,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.78592059451839, -17.998410491017566],
                  [-48.78592059451839, -18.00053287310098],
                  [-48.78463313419124, -18.001838941686227],
                  [-48.78463313419124, -17.99906353437925]]]),
            {
              "reference": 21,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.783002351110184, -17.99979820527051],
                  [-48.78188655215999, -18.00175731268308],
                  [-48.78137156802913, -17.9995533153135]]]),
            {
              "reference": 21,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.72486654117227, -18.006083597770488],
                  [-48.725724848057034, -18.003634770194147],
                  [-48.72812810733438, -18.0077977568329]]]),
            {
              "reference": 21,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.73774114444375, -17.985594025731153],
                  [-48.73405042483926, -17.984859295686057],
                  [-48.73456540897012, -17.982818362846366],
                  [-48.73774114444375, -17.984696021927334]]]),
            {
              "reference": 21,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.70366636111856, -18.025591375401806],
                  [-48.70727125003457, -18.026162700340254],
                  [-48.7086445410502, -18.02567299336366],
                  [-48.7101036627543, -18.026244318037268],
                  [-48.70787206485391, -18.027631813097504],
                  [-48.70366636111856, -18.027142110207205]]]),
            {
              "reference": 21,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.678517969394925, -18.07023074667662],
                  [-48.68066373660684, -18.06990435732005],
                  [-48.68014875247598, -18.071862684359626],
                  [-48.67843213870645, -18.072597051368742]]]),
            {
              "reference": 21,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.72397714283807, -18.08801814517051],
                  [-48.72526460316522, -18.085570458267384],
                  [-48.72852616932733, -18.08720225333067],
                  [-48.72432046559198, -18.089731505682114]]]),
            {
              "reference": 21,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.77504640248163, -18.13272321209055],
                  [-48.77641969349725, -18.131336547588283],
                  [-48.77753549244745, -18.134273000587363]]]),
            {
              "reference": 21,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.819077545670105, -18.15311406754604],
                  [-48.81890588429315, -18.15123820817831],
                  [-48.820536667374206, -18.150096370878963],
                  [-48.821566635635925, -18.152135360822896]]]),
            {
              "reference": 21,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.796332413223816, -18.11983496556798],
                  [-48.79504495289667, -18.11844819895633],
                  [-48.796589905289245, -18.117714023950885]]]),
            {
              "reference": 21,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.853401597452574, -18.180766154484466],
                  [-48.84971087784808, -18.18043997118004],
                  [-48.85048335404437, -18.17954296394843],
                  [-48.854603227091246, -18.179053685332853]]]),
            {
              "reference": 21,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.87915080399554, -18.16910472261492],
                  [-48.87975161881488, -18.166413512311703],
                  [-48.88189738602679, -18.1661688547727],
                  [-48.88069575638812, -18.168615414736173]]]),
            {
              "reference": 21,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.83494799943011, -18.205717368766255],
                  [-48.835634644937926, -18.204494353277347],
                  [-48.836922105265074, -18.206125038687894],
                  [-48.8357204756264, -18.20702190915732]]]),
            {
              "reference": 21,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.82207339615863, -18.20742957602602],
                  [-48.81932681412738, -18.20783724194063],
                  [-48.81949847550433, -18.20661424133457],
                  [-48.82198756547015, -18.206125038687894]]]),
            {
              "reference": 21,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.058258159111475, -18.312393444521742],
                  [-49.06057558770034, -18.310030392076097],
                  [-49.06357966179702, -18.310030392076097],
                  [-49.06306467766616, -18.312393444521742],
                  [-49.06031809563491, -18.312393444521742]]]),
            {
              "reference": 21,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.17617438056489, -18.36848296177903],
                  [-49.179264285350044, -18.366690885891643],
                  [-49.182697512889106, -18.369297535575356],
                  [-49.180980899119575, -18.371904145881064]]]),
            {
              "reference": 21,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.32998297431489, -18.412627313721725],
                  [-49.327837207102974, -18.40896262282499],
                  [-49.33144209601899, -18.41124288410863]]]),
            {
              "reference": 21,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.299598910594185, -18.405705054310427],
                  [-49.30328963019868, -18.409532690977713],
                  [-49.2991697571518, -18.41132432145294]]]),
            {
              "reference": 21,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.29127333381196, -18.41425604018576],
                  [-49.29101584174653, -18.41205725581788],
                  [-49.29273245551606, -18.41344167888046]]]),
            {
              "reference": 21,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.36268550598789, -18.421366461366524],
                  [-49.361827199103125, -18.419004900553734],
                  [-49.36689120972324, -18.42112216347543]]]),
            {
              "reference": 21,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.43450755872032, -18.42246400438088],
                  [-49.43570918835899, -18.419288124998783],
                  [-49.43742580212852, -18.4214053844348],
                  [-49.43596668042442, -18.42197541136915]]]),
            {
              "reference": 21,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.45011286234884, -18.453459416769668],
                  [-49.44556383585958, -18.45248240557926],
                  [-49.447709603071495, -18.45077262261977]]]),
            {
              "reference": 21,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.117097217468576, -19.87010269049083],
                  [-51.11649640264924, -19.86372561818829],
                  [-51.1210454291385, -19.865340091117734]]]),
            {
              "reference": 21,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.30983042500748, -18.53273563789334],
                  [-50.30922961018815, -18.536234929111238],
                  [-50.30425143025651, -18.53704870749702],
                  [-50.30425143025651, -18.53371219148742]]]),
            {
              "reference": 21,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.53200157742888, -19.27726031134015],
                  [-50.530628286413254, -19.286577155216612],
                  [-50.52822502713591, -19.286658168925722],
                  [-50.529340826086106, -19.27790845676155]]]),
            {
              "reference": 21,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.260445180460145, -18.83827491746408],
                  [-49.259672704263856, -18.829176568118054],
                  [-49.26473671488397, -18.833563333787488],
                  [-49.26636749796503, -18.839006013429753]]]),
            {
              "reference": 21,
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.335890355631044, -18.83364456910851],
                  [-49.33923775248163, -18.831694910561655],
                  [-49.34069687418573, -18.83315715659311],
                  [-49.33992439798944, -18.835106798169]]]),
            {
              "reference": 21,
              "system:index": "31"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.70028699944439, -17.97313368093229],
                  [-48.70054449150982, -17.97607277796055],
                  [-48.697111263970754, -17.976970825629277],
                  [-48.696081295709035, -17.975093084385968]]]),
            {
              "reference": 21,
              "system:index": "32"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.69728292534771, -17.97084768276249],
                  [-48.69616712639751, -17.967500274924593],
                  [-48.698570385674856, -17.969786316412847]]]),
            {
              "reference": 21,
              "system:index": "33"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.71041502068462, -17.81001902625363],
                  [-48.70869840691509, -17.807567489447365],
                  [-48.71170248101177, -17.807567489447365]]]),
            {
              "reference": 21,
              "system:index": "34"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.72088636467876, -17.833552064461394],
                  [-48.721058026055715, -17.830774020352806],
                  [-48.72191633294048, -17.831999633388996]]]),
            {
              "reference": 21,
              "system:index": "35"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.73041357109966, -17.813369405391185],
                  [-48.73075689385357, -17.81230709686996],
                  [-48.73213018486919, -17.813696268278346]]]),
            {
              "reference": 21,
              "system:index": "36"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.707325115899465, -17.847686735233044],
                  [-48.70698179314556, -17.848830532331462],
                  [-48.70543684075298, -17.84850373391072]]]),
            {
              "reference": 21,
              "system:index": "37"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.688614025811574, -17.85316055473952],
                  [-48.68904317925396, -17.85405922542899],
                  [-48.68827070305767, -17.85520298155825]]]),
            {
              "reference": 21,
              "system:index": "38"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.534805432061574, -18.03149824371455],
                  [-48.5336038024229, -18.032804082745404],
                  [-48.53317464898052, -18.031824704380558]]]),
            {
              "reference": 21,
              "system:index": "39"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.49395002434673, -18.031090167030527],
                  [-48.49377836296978, -18.03321215545559],
                  [-48.49274839470806, -18.031987934486498]]]),
            {
              "reference": 21,
              "system:index": "40"
            })]),
    flo = /* color: #ff00ff */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.95002566094253, -18.2553452488138],
                  [-48.948652369926904, -18.257138477638566],
                  [-48.94702158684585, -18.255834313056603],
                  [-48.94856653923843, -18.25355200147609]]]),
            {
              "reference": 3,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.9402409624562, -18.260887896260698],
                  [-48.93826685662124, -18.25836112304031],
                  [-48.94101343865249, -18.25852414177689]]]),
            {
              "reference": 3,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.11911211724136, -18.281834245015933],
                  [-49.119197947929834, -18.27759627732893],
                  [-49.121172053764795, -18.278981778157334],
                  [-49.12100039238784, -18.281915743379706]]]),
            {
              "reference": 3,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.04143534417007, -18.322008290768107],
                  [-49.04117785210464, -18.320786094186133],
                  [-49.04263697380874, -18.31964536958762],
                  [-49.04332361931655, -18.320704614107047],
                  [-49.042293651054834, -18.321356453665373]]]),
            {
              "reference": 3,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.30639719746842, -18.539245889779544],
                  [-50.3064830281569, -18.540629286350246],
                  [-50.305023906452796, -18.540141030016184]]]),
            {
              "reference": 3,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.744604192785324, -19.463022164231198],
                  [-50.74400337796599, -19.461484562139326],
                  [-50.74623497586638, -19.46188919568248]]]),
            {
              "reference": 3,
              "system:index": "5"
            })]);

// Define the region ID (reg_17)
var regiaoID = 'reg_17'; // old 11

// Define whether to collect data (false)
var coleta = false;   // true or false

// Define the years to process (2016-2023)
var anos = [2016,2017,2018,2019,2020,2021,2022,2023]

// If collecting data, only process 2023
if (coleta) {var anos = [2023]}

// Define the number of random forest trees (100)
var RFtrees = 100;

// If collecting data, use 200 trees
if (coleta) {var RFtrees = 200}

// Define output version (1)
var versao_out = 1;

// Define Sentinel-2 version (S2_v1)
var versao_pt = 'S2_v1';

// Define stable version (3)
var versao_estavel = '3'

// Define input directory for Sentinel-2 data
var dir_pt_in = 'projects/mapbiomas-workspace/AMOSTRAS/col9/MATA_ATLANTICA/teste/';

// Load the 250,000 biomes feature collection
var bioma250mil = ee.FeatureCollection('projects/mapbiomas-workspace/AUXILIAR/biomas_IBGE_250mil');

// Filter the collection to only include the Atlantic Forest biome
var bioma250mil_MA_vetor = bioma250mil.filterMetadata('Bioma','equals', 'Mata Atlântica');

// Load the biomes raster
var biomes = ee.Image('projects/mapbiomas-workspace/AUXILIAR/biomas-raster-41');

// Mask the biomes raster to only include the Atlantic Forest biome
var bioma250mil_MA = biomes.mask(biomes.eq(2));

// Add the Atlantic Forest biome layer to the map
Map.addLayer(bioma250mil_MA,{},'layer bioma',false)

// Import the palettes module
var palettes = require('users/mapbiomas/modules:Palettes.js');

// Define visualization parameters for the classification
var vis = {
    'min': 0,
    'max': 62,
    'palette': palettes.get('classification7')
};

// Load the Atlantic Forest regions feature collection
var regioesCollection = ee.FeatureCollection('projects/mapbiomas-workspace/AUXILIAR/Mata_Atlantica_col6_PLANET');

// Define visualization parameters for the median composite
var visParMedian2 = {bands: ['swir1_median', 'nir_median', 'red_median'],gain: [0.08, 0.06, 0.2],gamma: 0.85}

// Define the biome name (MATAATLANTICA)
var bioma = "MATAATLANTICA";

// Define the output directory for the classification
var dirout = 'projects/mapbiomas-workspace/COLECAO7/classificacao-ma/';

// Load the Sentinel-2 clusters image
var S2_cluster = ee.Image('projects/mapbiomas-workspace/AMOSTRAS/S2_2024/MATA_ATLANTICA/mosaicos_MA_S2_clusters_2106_2023')

// Filter the regions collection to only include the specified region ID
var limite = regioesCollection.filterMetadata('reg_id', "equals", regiaoID);
//var limite = reg_04_rev

// Load the stable map from collection 6
var mapa_estavel_col6 = ee.Image('projects/mapbiomas-workspace/AMOSTRAS/col7/MATA_ATLANTICA/MA_amostras_estaveis85a20_col6_v1')

// Add the stable map layer to the map
Map.addLayer(mapa_estavel_col6, vis, 'mapa_estavel_col6', false);

// Create a blank image
var blank = ee.Image(0).mask(0);
// Outline the region boundary
var outline = blank.paint(limite, 'AA0000', 2); 
// Define visualization parameters for the outline
var visPar = {'palette':'000000','opacity': 0.6};
// Add the outline layer to the map
Map.addLayer(outline, visPar, regiaoID, false);

// Define a function to shuffle a feature collection
var shuffle = function (collection, seed) {
    // Add a random column to the collection
    collection = collection.randomColumn('random', seed || 1)
        // Sort the collection by the random column
        .sort('random', true)
        // Map over the collection and set a new ID based on the random column
        .map(function (feature) {
                var rescaled = ee.Number(feature.get('random')).multiply(1000000000).round();
                return feature.set('new_id', rescaled)});
    // Get a list of the new IDs
    var randomIdList = ee.List(collection.reduceColumns(ee.Reducer.toList(), ['new_id']).get('list'));
    // Create a sequential list of IDs
    var sequentialIdList = ee.List.sequence(1, collection.size());
    // Remap the collection using the new and sequential IDs
    var shuffled = collection.remap(randomIdList, sequentialIdList, 'new_id');
    // Return the shuffled collection
    return shuffled;
};

// Define visualization parameters for the hand-labeled data
var vis_hand = {
    'min': 0,
    'max': 60,
    'palette': 'blue,white,green,orange,red,brown'
};

// Loop through each year
for (var i_ano=0;i_ano<anos.length; i_ano++){
  // Get the current year
  var ano = anos[i_ano];

  // Define the asset path for the Sentinel-2 mosaics
  var asset = 'projects/mapbiomas-mosaics/assets/SENTINEL/BRAZIL/mosaics-3';
  // Define the band names to use for classification
  var bandNames = ee.List([
  //  THE 60 MOST IMPORTANT BANDS FOR THIS REGION
  'red_median','longitude','brba_median_dry','brightness_median_wet','ndvi_median_dry_'+ano,'wetness_median','blue_median_wet','green_median','lai_median','evi_median','red_edge_3_median_dry','rvi_median_wet','green_median_texture_'+ano,'evi_median_dry','red_edge_2_median_wet','ri_median','gvmi_median_dry','osavi_median_dry','evi_median_wet','red_edge_1_median_dry','ri_median_wet','swir1_median_dry','red_median_dry','wetness_median_wet','swir2_median','swir2_median_wet','iia_median_dry','awei_median_dry','blue_median','wetness_median_dry','dswi5_median','afvi_median_wet','nir_stdDev','green_median_texture','red_edge_1_median','ndvi_median_wet_'+ano,'green_median_dry','ndwi_median_wet','gemi_median_dry','osavi_median_wet','swir1_median','cvi_median_dry','red_edge_1_median_wet','ndwi_median_'+ano,'mbi_median_wet','nir_median_wet','rvi_median','red_stdDev','brightness_median','bsi_median_1','latitude','osavi_median','brightness_median_dry','swir2_stdDev','red_min','iia_median_wet','spri_median_1','green_stdDev','spri_median','green_median_wet',

  // ALL 143 BANDS TO FEATURE IMPORTANCE
  //    'blue_median','afvi_median','afvi_median_dry','afvi_median_wet','avi_median','avi_median_dry','avi_median_wet','awei_median','awei_median_dry','awei_median_wet','blue_median_dry','blue_median_wet','blue_stdDev','brba_median','brba_median_dry','brba_median_wet','brightness_median','brightness_median_dry','brightness_median_wet','bsi_median','bsi_median_1','bsi_median_2','clusters_2023','co2flux_median','cvi_median','cvi_median_dry','cvi_median_wet','dswi5_median','dswi5_median_dry','dswi5_median_wet','evi_median','evi_median_dry','evi_median_wet','gcvi_median','gcvi_median_dry','gcvi_median_wet','gemi_median','gemi_median_dry','gemi_median_wet','gli_median','gli_median_dry','gli_median_wet','green_median','green_median_dry','green_median_texture','green_median_texture_2023','green_median_wet','green_min','green_stdDev','gvmi_median','gvmi_median_1','gvmi_median_dry','gvmi_median_dry_1','gvmi_median_wet','gvmi_median_wet_1','iia_median','iia_median_dry','iia_median_wet','lai_median','latitude','longitude','lswi_median','lswi_median_dry','lswi_median_wet','mbi_median','mbi_median_dry','mbi_median_wet','msi_median','msi_median_dry','msi_median_wet','nddi_median','nddi_median_dry','nddi_median_wet','ndvi_median','ndvi_median_dry','ndvi_median_dry_2023','ndvi_median_wet','ndvi_median_wet_2023','ndwi_median','ndwi_median_2023','ndwi_median_dry','ndwi_median_wet','nir_median','nir_median_contrast','nir_median_dry','nir_median_dry_contrast','nir_median_wet','nir_stdDev','osavi_median','osavi_median_dry','osavi_median_wet','ratio_median','ratio_median_dry','ratio_median_wet','red_edge_1_median','red_edge_1_median_dry','red_edge_1_median_wet','red_edge_1_stdDev','red_edge_2_median','red_edge_2_median_dry','red_edge_2_median_wet','red_edge_2_stdDev','red_edge_3_median','red_edge_3_median_dry','red_edge_3_median_wet','red_edge_3_stdDev','red_edge_4_median','red_edge_4_median_dry','red_edge_4_median_wet','red_edge_4_stdDev','red_median','red_median_contrast','red_median_dry','red_median_dry_contrast','red_median_wet','red_min','red_stdDev','ri_median','ri_median_dry','ri_median_wet','rvi_median','rvi_median_1','rvi_median_wet','shape_median','shape_median_dry','shape_median_wet','spri_median','spri_median_1','spri_median_wet','swir1_median','swir1_median_dry','swir1_median_wet','swir1_stdDev','swir2_median','swir2_median_dry','swir2_median_wet','swir2_stdDev','ui_median','ui_median_dry','ui_median_wet','wetness_median','wetness_median_dry','wetness_median_wet',
  ])

  // Load the Sentinel-2 mosaics for the current year
  var collection = ee.ImageCollection(asset)
        // Filter the collection to only include version 3
        .filter(ee.Filter.eq('version', '3'))
        // Filter the collection to only include the current year
        .filter(ee.Filter.eq('year', ano))
        // Filter the collection to only include the Atlantic Forest biome
        .filter(ee.Filter.inList('biome', [
            'MATAATLANTICA',
        ])); 

  // Create a mosaic of the Sentinel-2 images
  var mosaicoTotal = collection.mosaic()

  // Add indices for the Caatinga biome
  var addIndexCaatinga = require('users/marcosrosaUSP/MapBiomas_col9_MataAtlan:Mata_Atlantica_SENTINEL2/processa_Bandas_Sentinel2_CAATINGA');
  mosaicoTotal = addIndexCaatinga.get(mosaicoTotal);

  // Add bands from the Sentinel-2 clusters image
  mosaicoTotal = mosaicoTotal.addBands(S2_cluster.select([
    'clusters_'+ano, 'ndvi_median_dry_'+ano,'ndvi_median_wet_'+ano,'ndwi_median_'+ano, 'green_median_texture_'+ano
    ]))
    
  // Add the Sentinel-2 mosaic layer to the map
  Map.addLayer(mosaicoTotal, {'bands': ['swir1_median', 'nir_median', 'red_median'],
    'gain': [0.08, 0.07, 0.2],'gamma': 0.85}, 'Sentinel 2 '+ano, false);
  //print(mosaicoTotal)
  //var BDamostras = ee.FeatureCollection('projects/mapbiomas-workspace/AMOSTRAS/col9/MATA_ATLANTICA/teste/REGIONs_'+regiaoID+'_'+ano)

  // Load the training points for the current year
  var BDamostras = ee.FeatureCollection('projects/mapbiomas-workspace/AMOSTRAS/S2_2024/MATA_ATLANTICA/pontos_train_v1_'+ano)
                    // Filter the training points to only include the specified region ID
                    .filterMetadata('reg_id', 'equals', regiaoID)
          
    // Filter the training points by reference class
    var BDflo = BDamostras.filterMetadata("reference", "equals", 3)
    var BDsav = BDamostras.filterMetadata("reference", "equals", 4)//.limit(100)
    var BDreflo = BDamostras.filterMetadata("reference", "equals", 9)
    var BDvarzea = BDamostras.filterMetadata("reference", "equals", 11)
    var BDcampo = BDamostras.filterMetadata("reference", "equals", 12)
    var BDOutroNFlo = BDamostras.filterMetadata("reference", "equals", 13)
    var BDagro = BDamostras.filterMetadata("reference", "equals", 21)
    // BDagro = shuffle(BDagro, 2).limit(1000)
    var BDNaoVeg = BDamostras.filterMetadata("reference", "equals", 22)
    var BDAflora = BDamostras.filterMetadata("reference", "equals", 29)
    var BDagua = BDamostras.filterMetadata("reference", "equals", 33)

  // Complementary samples
  // Merge the training points for different classes
  var amostraTotal = varzea.merge(agro).merge(flo)//flo.merge(agr).merge(agua).merge(varzea)
  
  // Reduce the training points to an image
  var amostraTotalimg = amostraTotal.reduceToImage({properties: ['reference'],reducer: ee.Reducer.first()})

  // Rename the band
  amostraTotalimg = amostraTotalimg.select([0],['reference'])

   // Sample the mosaic using the training points for the forest class
   var training_flo = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 600, 'region': flo.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_nflo = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 300, 'region': nao_flo.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_sav = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 1500, 'region': sav.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_afl = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 1000, 'region': aflora.filterBounds(limite), 'scale': 10, 'seed': 1});

  // Sample the mosaic using the training points for the varzea class
  var training_var = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 1200, 'region': varzea.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_agu = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 100, 'region': agua.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_cam = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 800, 'region': campo.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_nflo = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 200, 'region': n_flo.filterBounds(limite), 'scale': 10, 'seed': 1});

  // Sample the mosaic using the training points for the agriculture class
  var training_agr = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 200, 'region': agro.filterBounds(limite), 'scale': 10, 'seed': 1});

// If collecting data, print the size of each training set
if (coleta) {
// print('BDflo',BDflo.size())
// print('BDsav',BDsav.size())
// print('BDvar',BDvarzea.size())
// print('BDcam',BDcampo.size())
// print('BDOut',BDOutroNFlo.size())
// print('BDAfl',BDAflora.size())
// print('BDagr',BDagro.size())
// print('BDNao',BDNaoVeg.size())
// print('BDagu',BDagua.size())
print('training_flo',training_flo.size())
//print('training_cam',training_cam.size())
//print('training_sav',training_sav.size())
//print('training_afl',training_afl.size())
//print('training_cam',training_cam.size())
 print('training_agr',training_agr.size())
}

  // Merge the training points for different classes
  var training = BDflo.merge(BDreflo).merge(BDcampo)//.merge(BDsav).merge(BDOutroNFlo).merge(BDAflora)
                      .merge(BDagro).merge(BDNaoVeg).merge(BDagua)
                      //complementares
                      // .merge(training_afl)
                      .merge(training_var).merge(training_agr).merge(training_flo)
                      // .merge(training_sav)
                      // //.merge(training_agu).merge(training_agr)

  // Train a random forest classifier
  var classifierRF = ee.Classifier.smileRandomForest({numberOfTrees: RFtrees, variablesPerSplit:1}).train(training, 'reference', bandNames);

  // If collecting data, print the classifier explanation
  if (coleta) {print(classifierRF.explain())}

  // Train a gradient tree boosting classifier
  var classifierGTB = ee.Classifier.smileGradientTreeBoost({numberOfTrees: 30, shrinkage: 0.1, samplingRate: 0.8, loss: 'LeastSquares'}).train(training, 'reference', bandNames);

  // print(classifier.explain())

  // Classify the mosaic using the random forest classifier
  var classifiedRF = mosaicoTotal.classify(classifierRF).mask(mosaicoTotal.select('blue_median'));

  // Classify the mosaic using the gradient tree boosting classifier
  var classifiedGTB = mosaicoTotal.classify(classifierGTB).mask(mosaicoTotal.select('blue_median'));

  // Rename the classification band and clip the image to the region boundary
  classifiedRF = classifiedRF.select(['classification'],['classification_'+ano]).clip(limite.geometry()).toInt8()
  // classifiedGTB = classifiedGTB.select(['classification'],['classification_'+ano]).clip(limite.geometry()).toInt8()

  // If collecting data, add the classification layers to the map
  if (coleta) {  
    Map.addLayer(classifiedRF, vis, 'RF'+ano+"_"+regiaoID, false);
    // Map.addLayer(classifiedGTB, vis, 'GTB'+ano+"_"+regiaoID, false);
  }

  // If this is the first year, initialize the combined classification image
  if (i_ano == 0){ var classified16a23RF = classifiedRF;}//  var classified16a23GTB = classifiedGTB}  
  // Otherwise, add the current year's classification to the combined image
  else {classified16a23RF = classified16a23RF.addBands(classifiedRF);}// classified16a23GTB = classified16a23GTB.addBands(classifiedGTB)}
}

// If collecting data, do nothing
if (coleta) {}
   // Otherwise, export the classification image to an asset
   else 
   {
     // Set metadata for the classification image
     classified16a23RF = classified16a23RF
     .set('territory', 'BRAZIL')
     .set('biome', 'MATA ATÂNTICA')
     .set('source', 'arcplan')
     .set('version', '1')
     .set('collection_id',versao_out)

//     classified16a23GTB = classified16a23GTB
//     .set('territory', 'BRAZIL')
//     .set('biome', 'MATA ATÂNTICA')
//     .set('source', 'arcplan')
//     .set('version', '1')
//     .set('collection_id',versao_out)
     
    // Export the classification image to an asset
    Export.image.toAsset({
       "image": classified16a23RF.toInt8(),
       "description": regiaoID+'-'+'RF_SENTINEL2_v'+versao_out,
       "assetId": dirout + regiaoID+'-'+'RF_SENTINEL2_v'+versao_out,
       "scale": 10,
       "pyramidingPolicy": {
           '.default': 'mode'
       },
       "maxPixels": 1e13,
       "region": limite
     });    
     
//    Export.image.toAsset({
//       "image": classified16a23GTB.toInt8(),
//       "description": regiaoID+'-'+'GTB_SENTINEL2_v'+versao_out,
//       "assetId": dirout + regiaoID+'-'+'GTB_SENTINEL2_v'+versao_out,
//       "scale": 10,
//       "pyramidingPolicy": {
//           '.default': 'mode'
//       },
//       "maxPixels": 1e13,
//       "region": limite
//     });    
}
