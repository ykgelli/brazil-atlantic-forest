var flo = /* color: #009999 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.40334418569216, -20.375324616603947],
                  [-42.404524357658715, -20.374640701384017],
                  [-42.40473893437991, -20.3751234653834],
                  [-42.404309780937524, -20.37550565247816],
                  [-42.40433123860964, -20.375928068691824],
                  [-42.40373042379031, -20.375928068691824]]]),
            {
              "reference": 3,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.41945889745364, -20.371583160973668],
                  [-42.418278725487085, -20.370758419302778],
                  [-42.4189653709949, -20.369953789034167],
                  [-42.419265778404565, -20.370315873174256],
                  [-42.419244320732446, -20.37101992323667]]]),
            {
              "reference": 3,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.57780085187267, -21.546838742425923],
                  [-41.57664213757823, -21.545760997811794],
                  [-41.57762919049571, -21.543485732896457],
                  [-41.57823000531505, -21.543246229251345],
                  [-41.57891665082286, -21.544523577457976],
                  [-41.57814417462657, -21.54572108119088]]]),
            {
              "reference": 3,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.535915475896104, -21.54643957868733],
                  [-41.53608713727306, -21.54524208088354],
                  [-41.53780375104259, -21.54667907706225]]]),
            {
              "reference": 3,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.54769803228601, -21.472590300719585],
                  [-41.54383565130456, -21.471791564329475],
                  [-41.54482270422204, -21.470713263255348],
                  [-41.54804135503991, -21.470753200474512]]]),
            {
              "reference": 3,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.558984767820675, -21.471232446250394],
                  [-41.55928517523034, -21.47031389046155],
                  [-41.56031514349206, -21.4696748917141],
                  [-41.56155968847497, -21.469515141589277],
                  [-41.56117345037683, -21.470673326025242],
                  [-41.560229312803585, -21.471152572063907]]]),
            {
              "reference": 3,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.561516773130734, -21.482254663867973],
                  [-41.560272228147824, -21.48309327670535],
                  [-41.559714328672726, -21.482933541299246],
                  [-41.559757244016964, -21.4811764402647],
                  [-41.5609159583114, -21.480377750966007],
                  [-41.559456836607296, -21.478980034151014],
                  [-41.5603580588363, -21.477742045196155],
                  [-41.55958558264001, -21.47714301450403],
                  [-41.5603580588363, -21.475226099730445],
                  [-41.56138802709802, -21.476104688800426],
                  [-41.561473857786496, -21.480737161692595]]]),
            {
              "reference": 3,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.569756519224484, -21.478780359225023],
                  [-41.56735325994714, -21.478740424206983],
                  [-41.56709576788171, -21.477262820839584],
                  [-41.57001401128991, -21.475226099730445],
                  [-41.57366181555017, -21.476064753048604],
                  [-41.57162335414375, -21.47971882899633],
                  [-41.57035733404382, -21.47913977389464]]]),
            {
              "reference": 3,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.57314683141931, -21.464243289201775],
                  [-41.57284642400964, -21.462765538776505],
                  [-41.57460595312341, -21.461647231196594],
                  [-41.57533551397546, -21.462965235655602],
                  [-41.574005138304074, -21.463843898672692]]]),
            {
              "reference": 3,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.57555009069665, -21.460608795045875],
                  [-41.573962222959835, -21.459730112523992],
                  [-41.5739193076156, -21.459290769276596],
                  [-41.575206767942746, -21.458731603228262],
                  [-41.575979244139035, -21.458931305634625],
                  [-41.575936328794796, -21.460169454447087]]]),
            {
              "reference": 3,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.59838105383142, -21.470433702414656],
                  [-41.59636403265222, -21.470633388784183],
                  [-41.59606362524255, -21.469794704192743],
                  [-41.59713650884851, -21.468956014772907],
                  [-41.598681461241085, -21.469275516073594]]]),
            {
              "reference": 3,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.01503430571756, -21.362996414182525],
                  [-42.01310311522684, -21.363236214099285],
                  [-42.00992737975321, -21.361038033501675],
                  [-42.011472332145786, -21.36119790229374],
                  [-42.01353226866922, -21.362117144462392],
                  [-42.014519321586704, -21.36219707829139]]]),
            {
              "reference": 3,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.119361507560825, -21.340053740783603],
                  [-42.12082062926493, -21.338774601056357],
                  [-42.12155019011698, -21.339054413825018],
                  [-42.12300931182108, -21.339534091614947],
                  [-42.1209064599534, -21.34153273218528]]]),
            {
              "reference": 3,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.106615650322055, -21.344210867842452],
                  [-42.10652981963358, -21.342811847854918],
                  [-42.10923348632059, -21.34153273218528],
                  [-42.11000596251688, -21.340893170166385],
                  [-42.11082135405741, -21.340733279225827],
                  [-42.11043511595926, -21.342452097700605],
                  [-42.108847248222446, -21.34365126144926]]]),
            {
              "reference": 3,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.172496168406724, -21.38995338872056],
                  [-42.17481359699559, -21.38735600947497],
                  [-42.175242750437974, -21.383959367033945],
                  [-42.17803224781346, -21.383959367033945],
                  [-42.17575773456883, -21.385877480692432],
                  [-42.17489942768407, -21.388834523315094]]]),
            {
              "reference": 3,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.19730123737645, -21.40066209600901],
                  [-42.19910368183446, -21.398784133152947],
                  [-42.20185026386571, -21.398784133152947],
                  [-42.20185026386571, -21.399823009203413],
                  [-42.1991465971787, -21.40006274878213],
                  [-42.19854578235936, -21.4009018342118]]]),
            {
              "reference": 3,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.016271581073745, -19.19788987444579],
                  [-42.014554967304214, -19.19691718140847],
                  [-42.0149841207466, -19.195377072340932]]]),
            {
              "reference": 3,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.81215612930358, -19.645607557555465],
                  [-41.809795785370476, -19.643182504367324],
                  [-41.8131860975653, -19.643748353388286]]]),
            {
              "reference": 3,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.953473494068454, -19.699336924963408],
                  [-41.955233023182224, -19.696993493209252],
                  [-41.95454637767441, -19.699740961452722]]]),
            {
              "reference": 3,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.041697380621706, -19.709074087385687],
                  [-42.04461562402991, -19.706690396410366],
                  [-42.04358565576819, -19.709114488621495]]]),
            {
              "reference": 3,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.15831131497125, -19.886065731880247],
                  [-42.15788216152887, -19.88844673804335],
                  [-42.15603680172662, -19.888285315027783]]]),
            {
              "reference": 3,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.16826767483453, -19.895024585959543],
                  [-42.16758102932672, -19.896800154509744],
                  [-42.1659931615899, -19.89506494001139]]]),
            {
              "reference": 3,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.76246216109846, -20.494648877357946],
                  [-41.76074554732893, -20.484518391418828],
                  [-41.774650118862134, -20.486448059389048],
                  [-41.775851748500806, -20.49625682944094]]]),
            {
              "reference": 3,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.39325146429793, -20.59705450295136],
                  [-42.397714660098714, -20.594483467296463],
                  [-42.39479641669051, -20.600589606181575]]]),
            {
              "reference": 3,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.429643676211995, -20.64396828318414],
                  [-42.42003063910262, -20.644289560590572],
                  [-42.42483715765731, -20.64155868100218]]]),
            {
              "reference": 3,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.43324856512801, -20.63392802226378],
                  [-42.4365959619786, -20.631678912980277],
                  [-42.43831257574813, -20.634490294390368]]]),
            {
              "reference": 3,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.110828218796776, -19.83786125255728],
                  [-42.11614972148232, -19.83560059446882],
                  [-42.114604769089745, -19.840929237064206]]]),
            {
              "reference": 3,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.98177349717661, -19.829791641242675],
                  [-41.9845629945521, -19.83007423559674],
                  [-41.984648825240576, -19.83330384965897],
                  [-41.9825459733729, -19.832779041841466]]]),
            {
              "reference": 3,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.82795908356494, -19.731426318400644],
                  [-41.81551363373584, -19.730618404524837],
                  [-41.816371940620606, -19.728437016651522],
                  [-41.828130744941895, -19.728356223936082]]]),
            {
              "reference": 3,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.49340424332959, -19.7828622561814],
                  [-41.49340424332959, -19.787546565241417],
                  [-41.48722443375928, -19.782943021297847]]]),
            {
              "reference": 3,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.439846420808124, -22.512393625619566],
                  [-44.43538322500734, -22.516675225226546],
                  [-44.43452491812258, -22.513186524441526],
                  [-44.438301468415546, -22.50890481677632]]]),
            {
              "reference": 3,
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.46339992620737, -21.623170877236223],
                  [-43.463571587584326, -21.624327835893318],
                  [-43.462842026732275, -21.624487415670966]]]),
            {
              "reference": 3,
              "system:index": "31"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.462584534666846, -21.623170877236223],
                  [-43.46078209020884, -21.62424804593844],
                  [-43.461339989683935, -21.62309108664265]]]),
            {
              "reference": 3,
              "system:index": "32"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.470566788695166, -21.62319082487773],
                  [-43.47091011144907, -21.624706837577524],
                  [-43.4697084818104, -21.624228098442817]]]),
            {
              "reference": 3,
              "system:index": "33"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.45645314668012, -21.016207329631662],
                  [-42.45696813081098, -21.015726601976546],
                  [-42.4574401995976, -21.016487753381526]]]),
            {
              "reference": 3,
              "system:index": "34"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.452075781567814, -21.017048599299386],
                  [-42.45198995087934, -21.01604708725213],
                  [-42.45297700379682, -21.016647995287578]]]),
            {
              "reference": 3,
              "system:index": "35"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.799849831697706, -20.3445019978518],
                  [-41.797360741731886, -20.344180091515927],
                  [-41.7980473872397, -20.342087683987256],
                  [-41.80156644546724, -20.342972936783937]]]),
            {
              "reference": 3,
              "system:index": "36"
            })]),
    agro = /* color: #ff00ff */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.44928506169924, -20.369853209955576],
                  [-42.44930651937136, -20.368364631927832],
                  [-42.45010045323977, -20.36916927048267]]]),
            {
              "reference": 21,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.45108750615725, -20.371643507752122],
                  [-42.45162394796023, -20.370698072178165],
                  [-42.45209601674685, -20.370858997791338],
                  [-42.451473744255395, -20.37168373892465]]]),
            {
              "reference": 21,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.45735314641604, -20.36359706242588],
                  [-42.45788958821902, -20.362872861770235],
                  [-42.45808270726809, -20.363395895917897],
                  [-42.45752480779299, -20.363959161479624]]]),
            {
              "reference": 21,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.82691900772155, -19.624912593037582],
                  [-41.82734816116393, -19.622648919525396],
                  [-41.82812063736022, -19.62584230684901]]]),
            {
              "reference": 21,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.850737023773796, -19.632107629195453],
                  [-41.85116617721618, -19.630652479339712],
                  [-41.852239060822136, -19.630490795208672],
                  [-41.85245363754333, -19.63267351724587]]]),
            {
              "reference": 21,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.84940664810241, -19.64091908833741],
                  [-41.846488404694206, -19.639666112169984],
                  [-41.85022203964294, -19.6399894617945]]]),
            {
              "reference": 21,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.84331266922057, -19.648194240570334],
                  [-41.84095232528747, -19.647224239325418],
                  [-41.84241144699157, -19.646900904274244],
                  [-41.843741822662956, -19.6474263234016]]]),
            {
              "reference": 21,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.95197882468941, -19.65856013891933],
                  [-41.95124926383736, -19.659812967563095],
                  [-41.94901766593697, -19.659125933712243]]]),
            {
              "reference": 21,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.95974650199654, -19.658479310928826],
                  [-41.96124853904488, -19.660257517310015],
                  [-41.959145687177205, -19.660661652374223]]]),
            {
              "reference": 21,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.91614451225045, -19.663207679859116],
                  [-41.915672443463826, -19.660863719524418],
                  [-41.917217395856404, -19.66276313829055]]]),
            {
              "reference": 21,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.96030440147164, -19.664783771852996],
                  [-41.96051897819283, -19.666804379949987],
                  [-41.958416126325154, -19.666036551873106]]]),
            {
              "reference": 21,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.95652785117867, -19.672623588968907],
                  [-41.95455374534371, -19.67161332478088],
                  [-41.956914089276815, -19.671370860428148]]]),
            {
              "reference": 21,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.959660671308065, -19.68878694967707],
                  [-41.961634777143026, -19.690201166133733],
                  [-41.958931110456014, -19.68947385637329]]]),
            {
              "reference": 21,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.96352305228951, -19.685433186434235],
                  [-41.96523966605904, -19.687857600632963],
                  [-41.96232142265084, -19.685675629505784]]]),
            {
              "reference": 21,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.966913364484334, -19.685473593638317],
                  [-41.966913364484334, -19.688261666097514],
                  [-41.9642955284858, -19.685150335720223]]]),
            {
              "reference": 21,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.017565273943475, -19.70495534617649],
                  [-42.018037342730096, -19.7027332052781],
                  [-42.02018310994201, -19.703945285957932]]]),
            {
              "reference": 21,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.986096777544994, -19.70495534617649],
                  [-41.982835211382884, -19.70746026799881],
                  [-41.98210565053083, -19.704430115658717]]]),
            {
              "reference": 21,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.96231405498154, -19.704104490530717],
                  [-41.958709166065525, -19.705356963006402],
                  [-41.96175615550644, -19.703417646623034]]]),
            {
              "reference": 21,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.06238257654456, -19.717840916351825],
                  [-42.060923454840456, -19.71901248381063],
                  [-42.060923454840456, -19.716871336789406]]]),
            {
              "reference": 21,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.03740584619788, -19.715174558405973],
                  [-42.04032408960608, -19.7146493614474],
                  [-42.0407961583927, -19.715740153201285]]]),
            {
              "reference": 21,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.04740413900636, -19.80838597374954],
                  [-42.04787620779298, -19.805680752451995],
                  [-42.049292414152845, -19.807982212297432]]]),
            {
              "reference": 21,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.037015805749924, -19.800773571369746],
                  [-42.0341833930302, -19.79911806370062],
                  [-42.03740204384807, -19.79883541432871],
                  [-42.038260350732834, -19.80057168111261]]]),
            {
              "reference": 21,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.06010426095012, -19.782319744014014],
                  [-42.06134880593303, -19.785106126356926],
                  [-42.059932599573166, -19.78559070961481]]]),
            {
              "reference": 21,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.065168271570236, -19.785429182026],
                  [-42.06812943032268, -19.787044450542307],
                  [-42.06636990120891, -19.78748864651226]]]),
            {
              "reference": 21,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.021574575275224, -19.815399498290176],
                  [-42.02359159645442, -19.813057770866283],
                  [-42.02595194038753, -19.8156417439865]]]),
            {
              "reference": 21,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.01256060934022, -19.82819764049319],
                  [-42.01028609609559, -19.82783430051163],
                  [-42.01200270986512, -19.826461675305893]]]),
            {
              "reference": 21,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.07390435915857, -19.84065600634556],
                  [-42.0776379941073, -19.83940459661684],
                  [-42.076736771878295, -19.842472551306308]]]),
            {
              "reference": 21,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.08227285128503, -19.84521751314904],
                  [-42.08364614230066, -19.843118428950724],
                  [-42.08351739626794, -19.845298246602404]]]),
            {
              "reference": 21,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.070866400770115, -19.851612318226863],
                  [-42.072840506605075, -19.850724283307834],
                  [-42.07266884522812, -19.852903996511053]]]),
            {
              "reference": 21,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.080608183912204, -19.856456057577983],
                  [-42.08223896699326, -19.859039324769213],
                  [-42.079578215650486, -19.859442956467962]]]),
            {
              "reference": 21,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.08700993755354, -19.86845181735154],
                  [-42.09104397991194, -19.869259031810987],
                  [-42.090571911125316, -19.870550566397515]]]),
            {
              "reference": 21,
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.16091454862887, -19.882370441271394],
                  [-42.16306031584078, -19.883339013063818],
                  [-42.16233075498873, -19.884630432908832]]]),
            {
              "reference": 21,
              "system:index": "31"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.14940816484255, -19.868921357420806],
                  [-42.152240577562274, -19.871302621202528],
                  [-42.15138227067751, -19.872271260642215]]]),
            {
              "reference": 21,
              "system:index": "32"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.18182141514777, -19.874748732587676],
                  [-42.18388135167121, -19.8737397488131],
                  [-42.18315179081916, -19.87535411976932]]]),
            {
              "reference": 21,
              "system:index": "33"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.6222435353662, -20.45722556650687],
                  [-41.62026942953124, -20.455938878928492],
                  [-41.620956075039054, -20.45525532176854],
                  [-41.6228014348413, -20.45634096995458]]]),
            {
              "reference": 21,
              "system:index": "34"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.63898051961913, -20.453124212275245],
                  [-41.64322913869872, -20.45268190282668],
                  [-41.64108337148681, -20.453847988626006]]]),
            {
              "reference": 21,
              "system:index": "35"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.648817449115256, -20.44667321155027],
                  [-41.650877385638694, -20.447356806893115],
                  [-41.64873161842678, -20.44972926125698]]]),
            {
              "reference": 21,
              "system:index": "36"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.65654221107815, -20.452222309421963],
                  [-41.659074216388206, -20.454031754527982],
                  [-41.65645638038967, -20.45475552660295]]]),
            {
              "reference": 21,
              "system:index": "37"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.63778820564602, -20.443818162837932],
                  [-41.63971939613674, -20.443979012062506],
                  [-41.6376594596133, -20.444984315902374]]]),
            {
              "reference": 21,
              "system:index": "38"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.607179200633865, -20.43459128215306],
                  [-41.61048368214021, -20.43543578938715],
                  [-41.60765126942049, -20.436843291137365]]]),
            {
              "reference": 21,
              "system:index": "39"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.637251211150314, -20.426022194494248],
                  [-41.63484795187297, -20.426464580649938],
                  [-41.63587792013469, -20.424815680331584]]]),
            {
              "reference": 21,
              "system:index": "40"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.64134069559593, -20.40638298708224],
                  [-41.64413019297142, -20.40614165421833],
                  [-41.642671071267316, -20.407750532834598]]]),
            {
              "reference": 21,
              "system:index": "41"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.64812674398715, -20.40009203087213],
                  [-41.649972103789395, -20.40057471517839],
                  [-41.64877047415072, -20.401459632478716]]]),
            {
              "reference": 21,
              "system:index": "42"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.629243992522305, -20.398563520592347],
                  [-41.62679781790072, -20.39896576160988],
                  [-41.6277848708182, -20.39715566876143]]]),
            {
              "reference": 21,
              "system:index": "43"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.671619376778395, -20.40435568992032],
                  [-41.672091445565016, -20.40129873880219],
                  [-41.67372222864607, -20.402988114024552],
                  [-41.672863921761305, -20.404717693272048]]]),
            {
              "reference": 21,
              "system:index": "44"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.72026108336508, -20.401735879603486],
                  [-41.718158231497405, -20.402138112338317],
                  [-41.71944569182455, -20.400448727794387]]]),
            {
              "reference": 21,
              "system:index": "45"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.32708682518269, -22.580124011380892],
                  [-44.32434024315144, -22.581946777063227],
                  [-44.32502688865925, -22.57988625755748]]]),
            {
              "reference": 21,
              "system:index": "46"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.87745825086898, -22.017802529046893],
                  [-43.875140822280116, -22.019513291659536],
                  [-43.87526956831283, -22.018558449957855],
                  [-43.87698618208236, -22.017683172744906]]]),
            {
              "reference": 21,
              "system:index": "47"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.8750120762474, -22.022139073156172],
                  [-43.87436834608383, -22.02225842570414],
                  [-43.87428251539535, -22.021860583486514]]]),
            {
              "reference": 21,
              "system:index": "48"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.48399929144175, -21.624208150944458],
                  [-43.48468593694956, -21.625045943505175],
                  [-43.48391346075327, -21.625365101298488]]]),
            {
              "reference": 21,
              "system:index": "49"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.47528747656138, -21.626043309269143],
                  [-43.475072899840185, -21.627280033257367],
                  [-43.47163967230112, -21.62712045656327]]]),
            {
              "reference": 21,
              "system:index": "50"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.02625380451928, -21.590382264119484],
                  [-43.02539549763451, -21.589504366213422],
                  [-43.02668295796166, -21.587828364520924]]]),
            {
              "reference": 21,
              "system:index": "51"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.410072374807136, -22.45336240738042],
                  [-44.40904240654542, -22.452688152369646],
                  [-44.40942864464356, -22.45217254338426]]]),
            {
              "reference": 21,
              "system:index": "52"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.281535769356424, -22.361693446122064],
                  [-44.28130509938114, -22.362189546940435],
                  [-44.28116562451237, -22.36141066786487]]]),
            {
              "reference": 21,
              "system:index": "53"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.28033950413578, -22.360463108467012],
                  [-44.279985452545816, -22.360845109628112],
                  [-44.28010346974247, -22.360239860550134]]]),
            {
              "reference": 21,
              "system:index": "54"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.278526330841714, -22.361981184811945],
                  [-44.27812399948948, -22.36179762744049],
                  [-44.27843513573521, -22.36141066786487]]]),
            {
              "reference": 21,
              "system:index": "55"
            })]),
    sav = /* color: #d63000 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.938637723346694, -19.17417884424741],
                  [-41.94125555934523, -19.175232740303176],
                  [-41.93756483974074, -19.177340512190668]]]),
            {
              "reference": 4,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.940869321247085, -19.161166726138745],
                  [-41.941641797443374, -19.15654535294237],
                  [-41.94353007258986, -19.162869304668945]]]),
            {
              "reference": 4,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.017516126056655, -19.185001225167426],
                  [-42.020262708087905, -19.179083457035215],
                  [-42.02017687739943, -19.1850822890079]]]),
            {
              "reference": 4,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.038029660602554, -19.212236428744674],
                  [-42.041462888141616, -19.22042231976769],
                  [-42.03717135371779, -19.217180431482262]]]),
            {
              "reference": 4,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.97992228450392, -19.226257557522338],
                  [-41.98189639033888, -19.229742392337307],
                  [-41.97863482417677, -19.228121548130826]]]),
            {
              "reference": 4,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.97417162837599, -19.216937287283155],
                  [-41.97314166011427, -19.21847719446981],
                  [-41.970309247394546, -19.217666718801524]]]),
            {
              "reference": 4,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.05485247554396, -19.24846198345015],
                  [-42.049702634235366, -19.248786113410727],
                  [-42.050990094562515, -19.247327523545966]]]),
            {
              "reference": 4,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.07133196773146, -19.222772648786663],
                  [-42.07090281428908, -19.220503366155512],
                  [-42.073735227008804, -19.222124285518294]]]),
            {
              "reference": 4,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.083691586872085, -19.225933383083717],
                  [-42.0843782323799, -19.228931972233248],
                  [-42.08240412654494, -19.227635291750246]]]),
            {
              "reference": 4,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.031920926788644, -19.460388996372245],
                  [-42.027886884430245, -19.460388996372245],
                  [-42.03174926541169, -19.458689512982446]]]),
            {
              "reference": 4,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.724592445618946, -19.028208147916324],
                  [-41.719356773621875, -19.033198228664986],
                  [-41.718112228638965, -19.033279366950733],
                  [-41.72171711755498, -19.026666466644922]]]),
            {
              "reference": 4,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.79322665007698, -19.031783961766163],
                  [-41.797861507254716, -19.025617283576647],
                  [-41.79743235381233, -19.031783961766163]]]),
            {
              "reference": 4,
              "system:index": "11"
            })]),
    agua = /* color: #0b4a8b */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.4566865326669, -19.6451302481007],
                  [-41.45391849296353, -19.64270518770127],
                  [-41.45265249124857, -19.64268498294418],
                  [-41.45142940299771, -19.64294769538987],
                  [-41.45214823689991, -19.64239195354644],
                  [-41.45428327338956, -19.64252330669439],
                  [-41.45651487128995, -19.644564403951225],
                  [-41.45818856971524, -19.644625030205518],
                  [-41.458832299878814, -19.643998557806984],
                  [-41.45923999564908, -19.64424106354163],
                  [-41.45786670463345, -19.645029204648885]]]),
            {
              "reference": 33,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.58947782530206, -19.715311737505676],
                  [-41.58853368772882, -19.71143332262637],
                  [-41.587889957565245, -19.708686055175033],
                  [-41.588404941696105, -19.707878026355566],
                  [-41.58857660307306, -19.710342501493155],
                  [-41.58977823271173, -19.714342142605044]]]),
            {
              "reference": 33,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.55664758695978, -19.705049893343013],
                  [-41.556218433517394, -19.704241846155895],
                  [-41.555918026107726, -19.70137324568083],
                  [-41.55548887266534, -19.700241952479878],
                  [-41.55360059751886, -19.699312669938703],
                  [-41.555188465255675, -19.69947428468134],
                  [-41.55613260282892, -19.700565179924862],
                  [-41.55651884092706, -19.70141364886151]]]),
            {
              "reference": 33,
              "system:index": "2"
            })]),
    aflora = /* color: #0b4a8b */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.35602726645078, -19.368950526069433],
                  [-41.34950413412656, -19.373323003365716],
                  [-41.35482563681211, -19.366521321325934],
                  [-41.345899245210546, -19.363930129696655],
                  [-41.34761585898008, -19.357128055728772],
                  [-41.35173573202695, -19.362472566305772],
                  [-41.35722889608945, -19.365225730659773]]]),
            {
              "reference": 29,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.358945509858984, -19.396964736322538],
                  [-41.35328068441953, -19.396317063351173],
                  [-41.353452345796484, -19.392916737962352],
                  [-41.36031880087461, -19.393240581536336]]]),
            {
              "reference": 29,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.34332432455625, -19.454921018857014],
                  [-41.343152663179296, -19.450065141081698],
                  [-41.34761585898008, -19.456054036089224]]]),
            {
              "reference": 29,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.43001331991758, -19.4299926381052],
                  [-41.43567814535703, -19.437115423236783],
                  [-41.42864002890195, -19.43371595112173]]]),
            {
              "reference": 29,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.198807943457425, -19.454117551822183],
                  [-41.19837879001504, -19.450394706756214],
                  [-41.202327001684964, -19.454764994416763]]]),
            {
              "reference": 29,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.80651255683699, -20.446667727759916],
                  [-41.7903763874034, -20.434764638740276],
                  [-41.81028910712996, -20.405807333294614],
                  [-41.81681223945418, -20.446667727759916]]]),
            {
              "reference": 29,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.80998335734619, -20.368149064298745],
                  [-41.79075728312744, -20.389711956845762],
                  [-41.76603804484619, -20.385206526970347],
                  [-41.79453383342041, -20.35784930592655]]]),
            {
              "reference": 29,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.82920943156494, -20.39518265894854],
                  [-41.81925307170166, -20.41448946673218],
                  [-41.80723677531494, -20.389390144792753],
                  [-41.82920943156494, -20.390033768226935]]]),
            {
              "reference": 29,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.772904499924316, -20.42092453141078],
                  [-41.77805434123291, -20.415132985306403],
                  [-41.784920796311035, -20.4141677064363],
                  [-41.7773676957251, -20.431220075192478],
                  [-41.7663813676001, -20.431863523800956],
                  [-41.76603804484619, -20.42092453141078]]]),
            {
              "reference": 29,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.742692097580566, -20.441836632958264],
                  [-41.757454975998535, -20.42188976790661],
                  [-41.750931843674316, -20.441836632958264]]]),
            {
              "reference": 29,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.7906971202465, -20.352565303018654],
                  [-41.78211405139884, -20.34644928715246],
                  [-41.79790689807853, -20.344839769050825],
                  [-41.800310157355874, -20.350955848635643]]]),
            {
              "reference": 29,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.83050028416883, -20.49186318318683],
                  [-41.82586542699109, -20.478355474503296],
                  [-41.83290354344617, -20.479641974202124]]]),
            {
              "reference": 29,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.75531260106336, -20.478033847892963],
                  [-41.758917489979375, -20.472244453620878],
                  [-41.75823084447156, -20.478998725701253]]]),
            {
              "reference": 29,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.80114618870984, -20.465329057569317],
                  [-41.80217615697156, -20.476908149447215],
                  [-41.797884622547734, -20.47932035028882]]]),
            {
              "reference": 29,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.74913279149305, -20.462112488146296],
                  [-41.75170771214734, -20.45278405581445],
                  [-41.75599924657117, -20.450532280376056],
                  [-41.75256601903211, -20.460986672929167]]]),
            {
              "reference": 29,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.89073966084677, -21.89202349032516],
                  [-43.89417288838583, -21.888200657616302],
                  [-43.89451621113974, -21.892660619145968]]]),
            {
              "reference": 29,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.957800932381055, -21.945956740834525],
                  [-43.9492178635334, -21.940065395875802],
                  [-43.955569334480664, -21.942135355697452]]]),
            {
              "reference": 29,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.89535319767498, -21.69429170072848],
                  [-43.888486742596854, -21.679457204505418],
                  [-43.899473070721854, -21.69349418602357]]]),
            {
              "reference": 29,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.87784373722576, -21.713111765532563],
                  [-43.878187059979666, -21.70481848089329],
                  [-43.882993578534354, -21.715503970356778]]]),
            {
              "reference": 29,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.41004483570694, -20.67109791172526],
                  [-42.40712659229874, -20.673185829947396],
                  [-42.39390866627335, -20.673747956871296],
                  [-42.404208348890535, -20.671378979311935]]]),
            {
              "reference": 29,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.41059311409931, -20.653665517057398],
                  [-42.407331547937204, -20.658243363999038],
                  [-42.40252502938252, -20.65398677397293]]]),
            {
              "reference": 29,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.43788727303486, -20.664346945403175],
                  [-42.43865974923115, -20.67302003397607],
                  [-42.43393906136494, -20.673341249966704]]]),
            {
              "reference": 29,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.38780487840034, -20.562253222473615],
                  [-42.38548744981147, -20.56811957318797],
                  [-42.38445748154975, -20.565869492705875]]]),
            {
              "reference": 29,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.343172920392526, -20.581056892413258],
                  [-42.338967216657174, -20.578485587090466],
                  [-42.3388813859687, -20.574789259786392],
                  [-42.34128464524604, -20.577923108275673]]]),
            {
              "reference": 29,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.432645317191, -20.558002317166572],
                  [-42.42955541240585, -20.556153916769897],
                  [-42.43049954997909, -20.551090792477797],
                  [-42.43144368755233, -20.555430623570913]]]),
            {
              "reference": 29,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.46260022746932, -20.541205161629954],
                  [-42.46637677776229, -20.539115434244472],
                  [-42.46337270366561, -20.544259327205307]]]),
            {
              "reference": 29,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.42577266242516, -20.4737027803186],
                  [-42.42903422858727, -20.472255411376768],
                  [-42.426373477244496, -20.48045698820561]]]),
            {
              "reference": 29,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.436399862055296, -20.434470628231907],
                  [-42.439918920282835, -20.438170342763804],
                  [-42.437429830317015, -20.438331197898]]]),
            {
              "reference": 29,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.42490102902144, -20.355887822591747],
                  [-42.42618848934859, -20.351300932061072],
                  [-42.42670347347945, -20.356209704531057]]]),
            {
              "reference": 29,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.12245858047417, -20.117252333250832],
                  [-42.113017204741745, -20.11797767955661],
                  [-42.12460434768608, -20.114270318656985]]]),
            {
              "reference": 29,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.12245858047417, -20.108225520104085],
                  [-42.119969490508346, -20.10653293466516],
                  [-42.121514442900924, -20.099198186261773],
                  [-42.12486183975151, -20.101455068526956],
                  [-42.12460434768608, -20.105243333473286]]]),
            {
              "reference": 29,
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.117995384673385, -20.1388500927477],
                  [-42.12245858047417, -20.137077254771885],
                  [-42.12469017837456, -20.141751056953083],
                  [-42.12314522598198, -20.14457138717256]]]),
            {
              "reference": 29,
              "system:index": "31"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.16073906753471, -20.143685003162208],
                  [-42.1626273426812, -20.140864656938824],
                  [-42.16305649612358, -20.13691608668574],
                  [-42.165202263335495, -20.140703492759506],
                  [-42.16254151199272, -20.145135447105602]]]),
            {
              "reference": 29,
              "system:index": "32"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.92907402250585, -20.050839200801708],
                  [-41.92581245634374, -20.05712808885535],
                  [-41.92203590605077, -20.05229050502464]]]),
            {
              "reference": 29,
              "system:index": "33"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.92409584257421, -20.096307019502525],
                  [-41.93027565214452, -20.09485612265139],
                  [-41.92735740873632, -20.09904756576655]]]),
            {
              "reference": 29,
              "system:index": "34"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.778092308844364, -20.021943493860373],
                  [-41.77877895435218, -20.017427408924405],
                  [-41.7827271660221, -20.022588638263247]]]),
            {
              "reference": 29,
              "system:index": "35"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.77637569507483, -20.050649856651244],
                  [-41.776547356451786, -20.04613459671214],
                  [-41.77946559985999, -20.050649856651244]]]),
            {
              "reference": 29,
              "system:index": "36"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.685075603943986, -20.20965587792105],
                  [-41.679067455750626, -20.20160101888169],
                  [-41.692113720399064, -20.203856421421303],
                  [-41.69571860931508, -20.211911163761904]]]),
            {
              "reference": 29,
              "system:index": "37"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.63683875702016, -20.20772274976138],
                  [-41.63203223846547, -20.19998999706622],
                  [-41.637182079774064, -20.197573433093446],
                  [-41.64233192108266, -20.204017520352547]]]),
            {
              "reference": 29,
              "system:index": "38"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.6363237728893, -20.24090478352242],
                  [-41.64473518036, -20.23703927993686],
                  [-41.646623455506486, -20.241710084666344],
                  [-41.64250358245961, -20.244125963054884],
                  [-41.64456351898305, -20.250407071038737],
                  [-41.642160259705705, -20.250729172293592]]]),
            {
              "reference": 29,
              "system:index": "39"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-41.699838482361955, -20.291275472065024],
                  [-41.70189841888539, -20.283224844341582],
                  [-41.70739158294789, -20.28966537997383]]]),
            {
              "reference": 29,
              "system:index": "40"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.66479904760576, -22.124808055397605],
                  [-42.66033585180498, -22.12393343607106],
                  [-42.66127998937822, -22.12289978805093]]]),
            {
              "reference": 29,
              "system:index": "41"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.86675865759111, -22.153508458339687],
                  [-42.86632950414873, -22.15788058233564],
                  [-42.86452705969072, -22.152236542215334]]]),
            {
              "reference": 29,
              "system:index": "42"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.87208016027666, -22.151918561388086],
                  [-42.86976273168779, -22.151839066069027],
                  [-42.87259514440752, -22.1490567016136]]]),
            {
              "reference": 29,
              "system:index": "43"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.85208160986162, -22.153349469452806],
                  [-42.851223302976855, -22.15819854969045],
                  [-42.850450826780566, -22.15295199644979]]]),
            {
              "reference": 29,
              "system:index": "44"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.03292687048174, -22.133156421204863],
                  [-43.03211147894121, -22.13430925189526],
                  [-43.03060944189287, -22.132639631970697]]]),
            {
              "reference": 29,
              "system:index": "45"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.88213710703553, -21.682441008482687],
                  [-43.88076381601991, -21.680367290494285],
                  [-43.88368205942811, -21.6812446363618]]]),
            {
              "reference": 29,
              "system:index": "46"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.87475566782655, -21.7010233797711],
                  [-43.87527065195741, -21.69942842050765],
                  [-43.876300620219126, -21.70078413700797]]]),
            {
              "reference": 29,
              "system:index": "47"
            })]),
    urban = /* color: #d387d6 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.46773437597544, -21.623849095503232],
                  [-43.469064751646826, -21.627280033257367],
                  [-43.46653274633677, -21.626362464859945]]]),
            {
              "reference": 24,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.474085846922705, -21.622293178284348],
                  [-43.474085846922705, -21.623888990596306],
                  [-43.471854249022314, -21.623849095503232]]]),
            {
              "reference": 24,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.47378543951304, -21.624327835893318],
                  [-43.4737425241688, -21.625045943505175],
                  [-43.471339264891455, -21.624806574697654]]]),
            {
              "reference": 24,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.46580318548472, -21.624646995272403],
                  [-43.46515945532114, -21.627639080174795],
                  [-43.463314095518896, -21.627599186116914]]]),
            {
              "reference": 24,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.47048095800669, -21.62771886825754],
                  [-43.470352211973974, -21.628676321814055],
                  [-43.46854976751597, -21.62915504621334],
                  [-43.4682493601063, -21.62815770192508]]]),
            {
              "reference": 24,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.461082497618506, -21.632027359301645],
                  [-43.46043876745493, -21.632865106529657],
                  [-43.45880798437388, -21.631468858450887]]]),
            {
              "reference": 24,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.46245578863413, -21.631069927949987],
                  [-43.461339989683935, -21.631269393338137],
                  [-43.46125415899546, -21.62859653425997]]]),
            {
              "reference": 24,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.46026710607798, -21.62632257044963],
                  [-43.46069625952036, -21.627958232241397],
                  [-43.45846466161997, -21.62783855029903]]]),
            {
              "reference": 24,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.465588608763525, -21.62783855029903],
                  [-43.46588901617319, -21.628676321814055],
                  [-43.46314243414194, -21.62991302326856],
                  [-43.46254161932261, -21.628915684211943]]]),
            {
              "reference": 24,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.46739105322153, -21.62195406589834],
                  [-43.46777729131968, -21.62319082487773],
                  [-43.46563152410776, -21.624188203443353],
                  [-43.465073624632666, -21.62271208072165]]]),
            {
              "reference": 24,
              "system:index": "9"
            })]),
    varzea = /* color: #17d2d6 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.51949478565357, -22.548971375236064],
                  [-44.5191943782439, -22.547623793726032],
                  [-44.52000976978443, -22.548733567690537]]]),
            {
              "reference": 11,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.52472284135375, -22.564835068654453],
                  [-44.52420785722289, -22.5641613570294],
                  [-44.52429368791137, -22.563665978734445]]]),
            {
              "reference": 11,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.520817545028066, -22.55702773789128],
                  [-44.520581510634756, -22.55861301847627],
                  [-44.52030256089721, -22.557424059745653]]]),
            {
              "reference": 11,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.55155997049295, -22.55979015488044],
                  [-44.551479504222506, -22.560221146210754],
                  [-44.55137221586191, -22.559928864880845]]]),
            {
              "reference": 11,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.53539697896921, -22.555777412335964],
                  [-44.53512875806772, -22.556253002735485],
                  [-44.53486053716623, -22.554598337399014]]]),
            {
              "reference": 11,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.528976849399136, -22.497869584559233],
                  [-44.528504780612515, -22.497631689041903],
                  [-44.528762272677945, -22.49719554619761]]]),
            {
              "reference": 11,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.49872787271816, -22.533783309699356],
                  [-44.497418954718896, -22.533981504146098],
                  [-44.497955396521874, -22.533069807335853]]]),
            {
              "reference": 11,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.503055746837504, -22.56576662481587],
                  [-44.502497847362406, -22.566004402996974],
                  [-44.50232618598545, -22.564458837489944]]]),
            {
              "reference": 11,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.20193458422369, -22.39789844681243],
                  [-44.20101190432257, -22.39698585416169],
                  [-44.20221353396124, -22.39754134605382]]]),
            {
              "reference": 11,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.54475447332977, -20.36778350675184],
                  [-42.544346777559504, -20.368366872319037],
                  [-42.54443260824798, -20.36766281015227]]]),
            {
              "reference": 11,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.54469010031341, -20.36635525760674],
                  [-42.544089285494074, -20.366214443594963],
                  [-42.54387470877288, -20.365409789634523]]]),
            {
              "reference": 11,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.54417130226067, -20.360175014113278],
                  [-42.542840926589285, -20.360335950698325],
                  [-42.542840926589285, -20.359692203351596]]]),
            {
              "reference": 11,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.30734999408741, -22.532737026066116],
                  [-44.30629856815357, -22.53275684567374],
                  [-44.30638439884205, -22.532439731610257]]]),
            {
              "reference": 11,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.30954552397536, -22.51938715769614],
                  [-44.3084726403694, -22.51938715769614],
                  [-44.30907345518874, -22.518990726638922]]]),
            {
              "reference": 11,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-44.29918270369861, -22.505278057511404],
                  [-44.2979381587157, -22.505198763298424],
                  [-44.29720859786365, -22.504009344647656]]]),
            {
              "reference": 11,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.83197485365587, -22.566330561597855],
                  [-43.83094488539415, -22.566964633242662],
                  [-43.83073030867296, -22.56593426533903]]]),
            {
              "reference": 11,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.8401190094151, -22.58177535203597],
                  [-43.83947527925152, -22.579437449642132],
                  [-43.84033358613629, -22.580031835367524]]]),
            {
              "reference": 11,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.82695307433909, -22.5621611338329],
                  [-43.8270818203718, -22.563072638467567],
                  [-43.8261805981428, -22.562597071583802]]]),
            {
              "reference": 11,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.81779028764671, -22.264923843849694],
                  [-43.81748988023704, -22.264943701675975],
                  [-43.81723238817161, -22.264189102296218]]]),
            {
              "reference": 11,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.82042958131736, -22.267525195099243],
                  [-43.81978585115379, -22.267763484398962],
                  [-43.81942107072776, -22.266691179354606]]]),
            {
              "reference": 11,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.3770107900639, -21.626686604613344],
                  [-43.37769743557171, -21.63051640813356],
                  [-43.373835054590266, -21.62501103365668]]]),
            {
              "reference": 11,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.39829680080609, -21.63075576748325],
                  [-43.39597937221722, -21.63298976895851],
                  [-43.396065202905696, -21.629160030995436]]]),
            {
              "reference": 11,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.39168783779339, -21.61471781450529],
                  [-43.39220282192425, -21.618547935152513],
                  [-43.389112917139094, -21.612722919820946]]]),
            {
              "reference": 11,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.141307780345706, -21.155051136197656],
                  [-42.13967699726465, -21.157532551291666],
                  [-42.14070696552637, -21.15429069421453]]]),
            {
              "reference": 11,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.138046214183596, -21.148807391684137],
                  [-42.135600039562014, -21.14848719256184],
                  [-42.13667292316797, -21.14744654063365]]]),
            {
              "reference": 11,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.27719921787622, -21.15381041305506],
                  [-42.275439688762454, -21.15308998839492],
                  [-42.27722067554834, -21.15345020116312]]]),
            {
              "reference": 11,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.12744288262352, -21.16166382752074],
                  [-42.12701372918114, -21.162224125664338],
                  [-42.12649874505028, -21.16210406195497],
                  [-42.12619833764061, -21.161143548773946]]]),
            {
              "reference": 11,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.13847212609276, -21.15954267962103],
                  [-42.13821463402733, -21.159982920364016],
                  [-42.13692717370018, -21.160823376328462],
                  [-42.137013004388656, -21.1600629639948]]]),
            {
              "reference": 11,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.13495306786522, -21.147655684716092],
                  [-42.13460974511131, -21.14833611084348],
                  [-42.13259272393211, -21.147655684716092]]]),
            {
              "reference": 11,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.357900831395106, -20.98257004313649],
                  [-42.35785791605087, -20.984293026091688],
                  [-42.356441709691005, -20.98461357886759]]]),
            {
              "reference": 11,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.356699201756435, -20.98220941628218],
                  [-42.356656286412196, -20.98321115539474],
                  [-42.35588381021591, -20.982049137400843]]]),
            {
              "reference": 11,
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-42.75832470684629, -20.961889100633773],
                  [-42.755148971372655, -20.96052653945146],
                  [-42.75645788937192, -20.95980517850605]]]),
            {
              "reference": 11,
              "system:index": "31"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.01632569191783, -20.14398793527986],
                  [-43.015896538475445, -20.14431025669505],
                  [-43.01503823159068, -20.143665613199552]]]),
            {
              "reference": 11,
              "system:index": "32"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.01778481362193, -20.14588156406887],
                  [-43.01731274483531, -20.146042722905694],
                  [-43.01735566017955, -20.14511605732299]]]),
            {
              "reference": 11,
              "system:index": "33"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.04504435964664, -20.140918655734385],
                  [-43.04519456335147, -20.141805055442266],
                  [-43.044658121548494, -20.14112011065509]]]),
            {
              "reference": 11,
              "system:index": "34"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-43.05493634649356, -20.13735286064688],
                  [-43.05349868246158, -20.13688950276844],
                  [-43.0540780396088, -20.13666789634086]]]),
            {
              "reference": 11,
              "system:index": "35"
            })]);

// Define the region ID (reg_09)
var regiaoID = 'reg_09'; // old 11

// Define whether to collect data (false)
var coleta = false;   // true or false

// Define the years to process (2016-2023)
var anos = [2016,2017,2018,2019,2020,2021,2022,2023]

// If collecting data, only process 2023
if (coleta) {var anos = [2023]}

// Define the number of trees for the Random Forest classifier (100)
var RFtrees = 100;

// If collecting data, use 200 trees
if (coleta) {var RFtrees = 200}

// Define the output version (1)
var versao_out = 1;

// Define the version of the point data (S2_v1)
var versao_pt = 'S2_v1';

// Define the stable version (3)
var versao_estavel = '3'

// Define the input directory for point data
var dir_pt_in = 'projects/mapbiomas-workspace/AMOSTRAS/col9/MATA_ATLANTICA/teste/';

// Load the 250k biome collection
var bioma250mil = ee.FeatureCollection('projects/mapbiomas-workspace/AUXILIAR/biomas_IBGE_250mil');

// Filter the collection to only include the Mata Atlântica biome
var bioma250mil_MA_vetor = bioma250mil.filterMetadata('Bioma','equals', 'Mata Atlântica');

// Load the biome raster
var biomes = ee.Image('projects/mapbiomas-workspace/AUXILIAR/biomas-raster-41');

// Mask the biome raster to only include the Mata Atlântica biome
var bioma250mil_MA = biomes.mask(biomes.eq(2));

// Add the Mata Atlântica biome layer to the map
Map.addLayer(bioma250mil_MA,{},'layer bioma',false)

// Import the palettes module
var palettes = require('users/mapbiomas/modules:Palettes.js');

// Define the visualization parameters for the classification
var vis = {
    'min': 0,
    'max': 62,
    'palette': palettes.get('classification7')
};

// Load the Mata Atlântica region collection
var regioesCollection = ee.FeatureCollection('projects/mapbiomas-workspace/AUXILIAR/Mata_Atlantica_col6_PLANET');

// Define the visualization parameters for the median composite
var visParMedian2 = {bands: ['swir1_median', 'nir_median', 'red_median'],gain: [0.08, 0.06, 0.2],gamma: 0.85}

// Define the biome name (MATAATLANTICA)
var bioma = "MATAATLANTICA";

// Define the output directory
var dirout = 'projects/mapbiomas-workspace/COLECAO7/classificacao-ma/';

// Load the S2 cluster image
var S2_cluster = ee.Image('projects/mapbiomas-workspace/AMOSTRAS/S2_2024/MATA_ATLANTICA/mosaicos_MA_S2_clusters_2106_2023')

// Filter the region collection to only include the specified region ID
var limite = regioesCollection.filterMetadata('reg_id', "equals", regiaoID);
//var limite = reg_04_rev

// Load the stable map from collection 6
var mapa_estavel_col6 = ee.Image('projects/mapbiomas-workspace/AMOSTRAS/col7/MATA_ATLANTICA/MA_amostras_estaveis85a20_col6_v1')

// Add the stable map layer to the map
Map.addLayer(mapa_estavel_col6, vis, 'mapa_estavel_col6', false);

// Create a blank image
var blank = ee.Image(0).mask(0);
// Outline the region boundary
var outline = blank.paint(limite, 'AA0000', 2); 
// Define the visualization parameters for the outline
var visPar = {'palette':'000000','opacity': 0.6};
// Add the outline layer to the map
Map.addLayer(outline, visPar, regiaoID, false);

// Define a function to shuffle a feature collection
var shuffle = function (collection, seed) {
    // Add a random column to the collection
    collection = collection.randomColumn('random', seed || 1)
        // Sort the collection by the random column
        .sort('random', true)
        // Map over the collection and set a new ID based on the random value
        .map(function (feature) {
                var rescaled = ee.Number(feature.get('random')).multiply(1000000000).round();
                return feature.set('new_id', rescaled)});
    // Get a list of the new IDs
    var randomIdList = ee.List(collection.reduceColumns(ee.Reducer.toList(), ['new_id']).get('list'));
    // Create a sequential list of IDs
    var sequentialIdList = ee.List.sequence(1, collection.size());
    // Remap the collection using the new and sequential IDs
    var shuffled = collection.remap(randomIdList, sequentialIdList, 'new_id');
    // Return the shuffled collection
    return shuffled;
};

// Define the visualization parameters for the hand-labeled data
var vis_hand = {
    'min': 0,
    'max': 60,
    'palette': 'blue,white,green,orange,red,brown'
};

// Loop through the years
for (var i_ano=0;i_ano<anos.length; i_ano++){
  // Get the current year
  var ano = anos[i_ano];

  // Define the asset path for the Sentinel-2 mosaics
  var asset = 'projects/mapbiomas-mosaics/assets/SENTINEL/BRAZIL/mosaics-3';
  // Define the band names to use for classification
  var bandNames = ee.List([
  //  THE 60 MOST IMPORTANT BANDS FOR THIS REGION
  'latitude','longitude','blue_median','brba_median','ndvi_median_wet_'+ano,'ui_median_wet','avi_median','swir2_median_wet','gemi_median_wet','blue_median_wet','ndvi_median_wet','mbi_median','nddi_median_wet','rvi_median_wet','red_min','rvi_median_1','brba_median_wet','ndwi_median_wet','green_median_texture_'+ano,'mbi_median_wet','nddi_median','swir2_median','red_median','gli_median_dry','awei_median_wet','spri_median_1','ndvi_median','afvi_median_dry','red_edge_1_median','ndwi_median_'+ano,'nir_stdDev','swir1_median_wet','ratio_median_wet','afvi_median_wet','ndwi_median','brightness_median_dry','nddi_median_dry','lai_median','green_min','rvi_median','bsi_median','mbi_median_dry','shape_median_dry','wetness_median','ri_median','brightness_median','red_edge_2_median_wet','red_edge_1_median_wet','swir2_stdDev','lswi_median_dry','shape_median_wet','ndwi_median_dry','lswi_median_wet','awei_median_dry','evi_median_wet','swir1_stdDev','ui_median','red_median_wet','dswi5_median','afvi_median',

  // ALL 143 BANDS TO FEATURE IMPORTANCE
  //    'blue_median','afvi_median','afvi_median_dry','afvi_median_wet','avi_median','avi_median_dry','avi_median_wet','awei_median','awei_median_dry','awei_median_wet','blue_median_dry','blue_median_wet','blue_stdDev','brba_median','brba_median_dry','brba_median_wet','brightness_median','brightness_median_dry','brightness_median_wet','bsi_median','bsi_median_1','bsi_median_2','clusters_2023','co2flux_median','cvi_median','cvi_median_dry','cvi_median_wet','dswi5_median','dswi5_median_dry','dswi5_median_wet','evi_median','evi_median_dry','evi_median_wet','gcvi_median','gcvi_median_dry','gcvi_median_wet','gemi_median','gemi_median_dry','gemi_median_wet','gli_median','gli_median_dry','gli_median_wet','green_median','green_median_dry','green_median_texture','green_median_texture_2023','green_median_wet','green_min','green_stdDev','gvmi_median','gvmi_median_1','gvmi_median_dry','gvmi_median_dry_1','gvmi_median_wet','gvmi_median_wet_1','iia_median','iia_median_dry','iia_median_wet','lai_median','latitude','longitude','lswi_median','lswi_median_dry','lswi_median_wet','mbi_median','mbi_median_dry','mbi_median_wet','msi_median','msi_median_dry','msi_median_wet','nddi_median','nddi_median_dry','nddi_median_wet','ndvi_median','ndvi_median_dry','ndvi_median_dry_2023','ndvi_median_wet','ndvi_median_wet_2023','ndwi_median','ndwi_median_2023','ndwi_median_dry','ndwi_median_wet','nir_median','nir_median_contrast','nir_median_dry','nir_median_dry_contrast','nir_median_wet','nir_stdDev','osavi_median','osavi_median_dry','osavi_median_wet','ratio_median','ratio_median_dry','ratio_median_wet','red_edge_1_median','red_edge_1_median_dry','red_edge_1_median_wet','red_edge_1_stdDev','red_edge_2_median','red_edge_2_median_dry','red_edge_2_median_wet','red_edge_2_stdDev','red_edge_3_median','red_edge_3_median_dry','red_edge_3_median_wet','red_edge_3_stdDev','red_edge_4_median','red_edge_4_median_dry','red_edge_4_median_wet','red_edge_4_stdDev','red_median','red_median_contrast','red_median_dry','red_median_dry_contrast','red_median_wet','red_min','red_stdDev','ri_median','ri_median_dry','ri_median_wet','rvi_median','rvi_median_1','rvi_median_wet','shape_median','shape_median_dry','shape_median_wet','spri_median','spri_median_1','spri_median_wet','swir1_median','swir1_median_dry','swir1_median_wet','swir1_stdDev','swir2_median','swir2_median_dry','swir2_median_wet','swir2_stdDev','ui_median','ui_median_dry','ui_median_wet','wetness_median','wetness_median_dry','wetness_median_wet',
  ])

  // Load the Sentinel-2 mosaic collection
  var collection = ee.ImageCollection(asset)
        // Filter the collection by version and year
        .filter(ee.Filter.eq('version', '3'))
        .filter(ee.Filter.eq('year', ano))
        // Filter the collection by biome
        .filter(ee.Filter.inList('biome', [
            'MATAATLANTICA',
        ])); 

  // Create a mosaic from the collection
  var mosaicoTotal = collection.mosaic()

  // Import the function to add indices for the Caatinga biome
  var addIndexCaatinga = require('users/marcosrosaUSP/MapBiomas_col9_MataAtlan:Mata_Atlantica_SENTINEL2/processa_Bandas_Sentinel2_CAATINGA');

  // Add the Caatinga indices to the mosaic
  mosaicoTotal = addIndexCaatinga.get(mosaicoTotal);

  // Add bands from the S2 cluster image to the mosaic
  mosaicoTotal = mosaicoTotal.addBands(S2_cluster.select([
    'clusters_'+ano, 'ndvi_median_dry_'+ano,'ndvi_median_wet_'+ano,'ndwi_median_'+ano, 'green_median_texture_'+ano
    ]))
    
  // Add the mosaic layer to the map
  Map.addLayer(mosaicoTotal, {'bands': ['swir1_median', 'nir_median', 'red_median'],
    'gain': [0.08, 0.07, 0.2],'gamma': 0.85}, 'Sentinel 2 '+ano, false);
  //print(mosaicoTotal)
  //var BDamostras = ee.FeatureCollection('projects/mapbiomas-workspace/AMOSTRAS/col9/MATA_ATLANTICA/teste/REGIONs_'+regiaoID+'_'+ano)

  // Load the training point data
  var BDamostras = ee.FeatureCollection('projects/mapbiomas-workspace/AMOSTRAS/S2_2024/MATA_ATLANTICA/pontos_train_v1_'+ano)
                    // Filter the points by region ID
                    .filterMetadata('reg_id', 'equals', regiaoID)
          
    // Filter the points by reference class
    var BDflo = BDamostras.filterMetadata("reference", "equals", 3)
    var BDsav = BDamostras.filterMetadata("reference", "equals", 4)//.limit(100)
    var BDreflo = BDamostras.filterMetadata("reference", "equals", 9)
    var BDvarzea = BDamostras.filterMetadata("reference", "equals", 11)
    var BDcampo = BDamostras.filterMetadata("reference", "equals", 12)
    var BDOutroNFlo = BDamostras.filterMetadata("reference", "equals", 13)
    var BDagro = BDamostras.filterMetadata("reference", "equals", 21)
    // BDagro = shuffle(BDagro, 2).limit(1000)
    var BDNaoVeg = BDamostras.filterMetadata("reference", "equals", 22)
    var BDAflora = BDamostras.filterMetadata("reference", "equals", 29)
    var BDagua = BDamostras.filterMetadata("reference", "equals", 33)
    var BDurb = BDamostras.filterMetadata("reference", "equals", 24)

  // Complementary samples
  // Merge the complementary samples
  var amostraTotal = sav.merge(flo).merge(agro).merge(aflora).merge(agua).merge(urban).merge(varzea)
  
  // Reduce the complementary samples to an image
  var amostraTotalimg = amostraTotal.reduceToImage({properties: ['reference'],reducer: ee.Reducer.first()})

  // Rename the band
  amostraTotalimg = amostraTotalimg.select([0],['reference'])

  // Sample the mosaic using the complementary samples
  var training_flo = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 2500, 'region': flo.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_nflo = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 300, 'region': nao_flo.filterBounds(limite), 'scale': 10, 'seed': 1});
  var training_sav = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 1000, 'region': sav.filterBounds(limite), 'scale': 10, 'seed': 1});
  var training_afl = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 500, 'region': aflora.filterBounds(limite), 'scale': 10, 'seed': 1});
  var training_var = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 300, 'region': varzea.filterBounds(limite), 'scale': 10, 'seed': 1});
  var training_agu = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 100, 'region': agua.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_cam = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 800, 'region': campo.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_nflo = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 200, 'region': n_flo.filterBounds(limite), 'scale': 10, 'seed': 1});
  var training_agr = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 2000, 'region': agro.filterBounds(limite), 'scale': 10, 'seed': 1});
  var training_urb = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 500, 'region': urban.filterBounds(limite), 'scale': 10, 'seed': 1});

// If collecting data, print the size of the training samples
if (coleta) {
//print('BDflo',BDflo.size())
//print('BDsav',BDsav.size())
//print('BDvar',BDvarzea.size())
//print('BDcam',BDcampo.size())
//print('BDOut',BDOutroNFlo.size())
//print('BDAfl',BDAflora.size())
//print('BDagr',BDagro.size())
//print('BDNao',BDNaoVeg.size())
//print('BDagu',BDagua.size())
print('training_flo',training_flo.size())
//print('training_cam',training_cam.size())
//print('training_sav',training_sav.size())
//print('training_afl',training_afl.size())
//print('training_cam',training_cam.size())
print('training_agr',training_agr.size())
}

  // Merge the training samples
  var training = BDflo.merge(BDreflo).merge(BDcampo)//.merge(BDsav).merge(BDOutroNFlo).merge(BDAflora)
                      .merge(BDagro).merge(BDNaoVeg).merge(BDagua).merge(BDurb)
                      //complementares
                       .merge(training_var)
                      .merge(training_sav).merge(training_agr).merge(training_flo).merge(training_agu).merge(training_afl).merge(training_agr)

  // Train the Random Forest classifier
  var classifierRF = ee.Classifier.smileRandomForest({numberOfTrees: RFtrees, variablesPerSplit:1}).train(training, 'reference', bandNames);

  // If collecting data, print the classifier explanation
  if (coleta) {print(classifierRF.explain())}

  // Train the Gradient Tree Boost classifier
  var classifierGTB = ee.Classifier.smileGradientTreeBoost({numberOfTrees: 30, shrinkage: 0.1, samplingRate: 0.8, loss: 'LeastSquares'}).train(training, 'reference', bandNames);

  // print(classifier.explain())

  // Classify the mosaic using the Random Forest classifier
  var classifiedRF = mosaicoTotal.classify(classifierRF).mask(mosaicoTotal.select('blue_median'));

  // Classify the mosaic using the Gradient Tree Boost classifier
  var classifiedGTB = mosaicoTotal.classify(classifierGTB).mask(mosaicoTotal.select('blue_median'));

  // Rename the classification band and clip the image to the region boundary
  classifiedRF = classifiedRF.select(['classification'],['classification_'+ano]).clip(limite.geometry()).toInt8()
  //  classifiedGTB = classifiedGTB.select(['classification'],['classification_'+ano]).clip(limite.geometry()).toInt8()
  // If collecting data, add the classification layers to the map
  
  if (coleta) {  
    Map.addLayer(classifiedRF, vis, 'RF'+ano+"_"+regiaoID, false);
    // Map.addLayer(classifiedGTB, vis, 'GTB'+ano+"_"+regiaoID, false);
  }

  // If it's the first year, initialize the combined classification image
  if (i_ano == 0){ var classified16a23RF = classifiedRF;}//  var classified16a23GTB = classifiedGTB}  
  // Otherwise, add the current year's classification to the combined image
  else {classified16a23RF = classified16a23RF.addBands(classifiedRF);}// classified16a23GTB = classified16a23GTB.addBands(classifiedGTB)}
}

// If collecting data, do nothing
if (coleta) {}
// Otherwise, export the classification image to an asset
   else 
   {
     // Set the metadata for the classification image
     classified16a23RF = classified16a23RF
     .set('territory', 'BRAZIL')
     .set('biome', 'MATA ATÂNTICA')
     .set('source', 'arcplan')
     .set('version', '1')
     .set('collection_id',versao_out)

//     classified16a23GTB = classified16a23GTB
//     .set('territory', 'BRAZIL')
//     .set('biome', 'MATA ATÂNTICA')
//     .set('source', 'arcplan')
//     .set('version', '1')
//     .set('collection_id',versao_out)
     
    // Export the Random Forest classification image to an asset
    Export.image.toAsset({
       "image": classified16a23RF.toInt8(),
       "description": regiaoID+'-'+'RF_SENTINEL2_v'+versao_out,
       "assetId": dirout + regiaoID+'-'+'RF_SENTINEL2_v'+versao_out,
       "scale": 10,
       "pyramidingPolicy": {
           '.default': 'mode'
       },
       "maxPixels": 1e13,
       "region": limite
     });    
     
//    Export.image.toAsset({
//       "image": classified16a23GTB.toInt8(),
//       "description": regiaoID+'-'+'GTB_SENTINEL2_v'+versao_out,
//       "assetId": dirout + regiaoID+'-'+'GTB_SENTINEL2_v'+versao_out,
//       "scale": 10,
//       "pyramidingPolicy": {
//           '.default': 'mode'
//       },
//       "maxPixels": 1e13,
//       "region": limite
//     });    
}
