var agro = /* color: #bf04c2 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.9782983107213, -26.681634560774263],
                  [-48.978169564688585, -26.680484189385375],
                  [-48.98057282396593, -26.680522535285338],
                  [-48.98048699327745, -26.681327796205455]]]),
            {
              "reference": 21,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.98220360704698, -26.681672906287332],
                  [-48.98280442186632, -26.680407497546753],
                  [-48.98529351183214, -26.68063757290784],
                  [-48.984392289603136, -26.681634560774263]]]),
            {
              "reference": 21,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.98155987688341, -26.674195287312156],
                  [-48.98237526842394, -26.673274931088542],
                  [-48.98387730547228, -26.67358171732164],
                  [-48.98349106737413, -26.674502071069554]]]),
            {
              "reference": 21,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.98404896684923, -26.67281475019161],
                  [-48.984649781668566, -26.67204777790404],
                  [-48.98623764940538, -26.67177933638495],
                  [-48.98628056474962, -26.672776401699725],
                  [-48.98482144304552, -26.673505020840736]]]),
            {
              "reference": 21,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.98795426317491, -26.67634275628366],
                  [-48.990185861075304, -26.67626606165957],
                  [-48.9922028822545, -26.67745482253662],
                  [-48.99203122087755, -26.679142074762],
                  [-48.98735344835558, -26.677799944341057]]]),
            {
              "reference": 21,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.97104561754503, -26.6991187766131],
                  [-48.97053063341417, -26.697891901615638],
                  [-48.968899850333116, -26.697853561559068],
                  [-48.969157342398546, -26.69704841739091],
                  [-48.97083104082384, -26.69716343833472],
                  [-48.97104561754503, -26.698045261712853],
                  [-48.97259056993761, -26.69858202042744],
                  [-48.973191384756944, -26.699693869720022]]]),
            {
              "reference": 21,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.906028871024034, -26.692140748956067],
                  [-48.90735924669542, -26.692140748956067],
                  [-48.90843213030138, -26.69072208666968],
                  [-48.90937626787462, -26.690760429125827],
                  [-48.910492066824816, -26.68968683547733],
                  [-48.911994103873155, -26.689916892110517],
                  [-48.91289532610216, -26.691182195292164],
                  [-48.911736611807726, -26.69129722215753],
                  [-48.91062081285753, -26.690223633565754],
                  [-48.90963375994005, -26.6906070592238],
                  [-48.910234574759386, -26.69237080063569],
                  [-48.90611470171251, -26.692907586082057]]]),
            {
              "reference": 21,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.89418423601427, -26.698083601704898],
                  [-48.894270066702745, -26.697316799412498],
                  [-48.89542878099718, -26.69697173669719],
                  [-48.896802072012804, -26.69819862160364]]]),
            {
              "reference": 21,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.94633052756035, -26.74561155598526],
                  [-48.94860504080498, -26.746263061746575],
                  [-48.94937751700127, -26.747987617799293],
                  [-48.9444851677581, -26.747451092052923],
                  [-48.94607303549492, -26.7449600464906],
                  [-48.94409892965996, -26.741817418847997],
                  [-48.9450430672332, -26.74082095780122],
                  [-48.94731758047783, -26.743120470118473],
                  [-48.947145919100876, -26.74507501902564]]]),
            {
              "reference": 21,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.849368880395446, -26.78307858176894],
                  [-48.84799558937982, -26.780243507162353],
                  [-48.847394774560485, -26.775339427176487],
                  [-48.84584982216791, -26.772082694527437],
                  [-48.851900885705504, -26.771584597769927],
                  [-48.85027010262445, -26.77449651709677],
                  [-48.85069925606683, -26.782388975543668]]]),
            {
              "reference": 21,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.26823035479504, -26.38388606636843],
                  [-49.267028725156365, -26.38400140174153],
                  [-49.266513741025506, -26.384385852153418],
                  [-49.2670716405006, -26.385346972584596],
                  [-49.26664248705822, -26.38642341797218],
                  [-49.26488295794445, -26.384616521786313],
                  [-49.2670716405006, -26.381963793195112],
                  [-49.26895991564709, -26.38354005955813]]]),
            {
              "reference": 21,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.261091168036955, -26.381304095118562],
                  [-49.257100041022795, -26.383726167909764],
                  [-49.25675671826889, -26.382918815955744],
                  [-49.25954621564438, -26.381573216825576],
                  [-49.260318691840666, -26.380189155653134]]]),
            {
              "reference": 21,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.25915997754623, -26.37765166710218],
                  [-49.2565421415477, -26.379304885666944],
                  [-49.25671380292465, -26.378228373939546],
                  [-49.2580012632518, -26.377305641617983]]]),
            {
              "reference": 21,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.28027432691147, -26.398065336022782],
                  [-49.28237717877914, -26.39983358192874],
                  [-49.280360157599944, -26.400410177997813]]]),
            {
              "reference": 21,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.28525250684311, -26.4166690010382],
                  [-49.28516667615463, -26.41490101311541],
                  [-49.283321316352385, -26.413094562682954],
                  [-49.284308369269866, -26.412671772326245],
                  [-49.28649705182602, -26.4145166643288],
                  [-49.2883853269725, -26.414017008991596],
                  [-49.28997319470932, -26.415285360621304],
                  [-49.28628247510483, -26.415054752271445],
                  [-49.28641122113754, -26.416976474432285]]]),
            {
              "reference": 21,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.26480334531357, -26.425374024558515],
                  [-49.26295798551132, -26.423644601997026],
                  [-49.26403086911728, -26.422606936008805],
                  [-49.267592842689055, -26.423260282349478],
                  [-49.26639121305038, -26.424374805798216],
                  [-49.26626246701767, -26.425566181019597]]]),
            {
              "reference": 21,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.30450003873398, -26.43886263014106],
                  [-49.30720370542099, -26.437786673962865],
                  [-49.30544417630722, -26.44086080781644]]]),
            {
              "reference": 21,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.31966449506422, -26.464613083474564],
                  [-49.32185317762037, -26.46065593719881],
                  [-49.322968976570564, -26.46107855154192],
                  [-49.32206775434156, -26.464766756313892]]]),
            {
              "reference": 21,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.2995801139607, -26.489638969343783],
                  [-49.302155034615, -26.483570048406452],
                  [-49.30515910871168, -26.485682683811056],
                  [-49.30164005048414, -26.48990783817759]]]),
            {
              "reference": 21,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.99094114606419, -26.32991857324035],
                  [-48.99282942121067, -26.330957072000437],
                  [-48.99205694501438, -26.331995561445037],
                  [-48.9901686698679, -26.33114938556337]]]),
            {
              "reference": 21,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.331460053705484, -26.42139706187071],
                  [-49.33210378386906, -26.42324181430538],
                  [-49.331417138361246, -26.423741429677435],
                  [-49.32982927062443, -26.420897436340763]]]),
            {
              "reference": 21,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.02881452606311, -27.4088398405092],
                  [-49.028900356751585, -27.41017325740089],
                  [-49.02774164245715, -27.409144622931723]]]),
            {
              "reference": 21,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.02821371124377, -27.408115978886286],
                  [-49.02623960540881, -27.407582604129754],
                  [-49.02752706573596, -27.40723971899815]]]),
            {
              "reference": 21,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.055310587194285, -27.417684127852727],
                  [-49.05737052371772, -27.41863649388199],
                  [-49.055439333227, -27.41863649388199]]]),
            {
              "reference": 21,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.117064163657695, -27.434138434079177],
                  [-49.11860911605027, -27.435661988712653],
                  [-49.11637751814988, -27.434938302884078]]]),
            {
              "reference": 21,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.180947132455486, -27.428095838704646],
                  [-49.18167669330754, -27.426495996135092],
                  [-49.18210584674992, -27.428286294609197]]]),
            {
              "reference": 21,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.07984308525353, -26.65967778008106],
                  [-50.07915643974572, -26.658757306733907],
                  [-50.08258966728478, -26.65814365371127]]]),
            {
              "reference": 21,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.962586692595615, -26.669342301948326],
                  [-49.95966844918741, -26.67041608717573],
                  [-49.96215753915323, -26.668421906565495]]]),
            {
              "reference": 21,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.90142052076974, -26.656313226286755],
                  [-49.9004763831965, -26.657463841451033],
                  [-49.900304721819545, -26.656313226286755]]]),
            {
              "reference": 21,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.851255339304885, -26.66543856868564],
                  [-49.85189906946846, -26.666704143518032],
                  [-49.850525778452834, -26.665783726850393]]]),
            {
              "reference": 21,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.92715212970909, -26.630097903766377],
                  [-48.92698046833214, -26.628198927535717],
                  [-48.927838775216905, -26.63005954092253]]]),
            {
              "reference": 21,
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.92565009266075, -26.634068388451706],
                  [-48.92588612705406, -26.63510414437296],
                  [-48.92348286777672, -26.634164292172215]]]),
            {
              "reference": 21,
              "system:index": "31"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.91653058201012, -26.634624628910082],
                  [-48.91571519046959, -26.634931519038183],
                  [-48.91496417194542, -26.634797254708587],
                  [-48.915607902108995, -26.63414511143455]]]),
            {
              "reference": 21,
              "system:index": "32"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.91601559787926, -26.633281974906755],
                  [-48.91477105289635, -26.633588868641503],
                  [-48.91642329364952, -26.632438012885643],
                  [-48.91777512699303, -26.632955899410344]]]),
            {
              "reference": 21,
              "system:index": "33"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.72399119616925, -26.77423352454706],
                  [-48.722875397219056, -26.77618753833356],
                  [-48.7227037358421, -26.773697122723473]]]),
            {
              "reference": 21,
              "system:index": "34"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.732145111574525, -26.772547681712197],
                  [-48.73484877826154, -26.773735437223472],
                  [-48.73150138141095, -26.77358217914589]]]),
            {
              "reference": 21,
              "system:index": "35"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.826052506783746, -26.88379278117835],
                  [-48.8291424115689, -26.890988682345345],
                  [-48.826567490914606, -26.89144797962682]]]),
            {
              "reference": 21,
              "system:index": "36"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.832060654977106, -26.88563007610311],
                  [-48.83652385077789, -26.887773549095126],
                  [-48.83549388251617, -26.889610779297918]]]),
            {
              "reference": 21,
              "system:index": "37"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.86862452826812, -27.034198735090964],
                  [-48.87171443305328, -27.033587113972782],
                  [-48.86965449652984, -27.03649228461207]]]),
            {
              "reference": 21,
              "system:index": "38"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.996931735803706, -27.14874991427386],
                  [-48.99624509029589, -27.150812000868896],
                  [-48.99504346065722, -27.150353762692404]]]),
            {
              "reference": 21,
              "system:index": "39"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.05029793767546, -27.18862269207833],
                  [-49.049697122856124, -27.187477481068576],
                  [-49.051671228691085, -27.1882409563815]]]),
            {
              "reference": 21,
              "system:index": "40"
            })]),
    varzea = /* color: #ffff99 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.45088242503717, -28.96364622391762],
                  [-49.45294236156061, -28.977763233675788],
                  [-49.444187631336, -28.96589906736514]]]),
            {
              "reference": 11,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.445560922351625, -28.979114761248677],
                  [-49.44521759959772, -28.986022293088624],
                  [-49.43989609691217, -28.9770123773951]]]),
            {
              "reference": 11,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.68017104483638, -29.186436296749804],
                  [-49.66145995474849, -29.172048072489318],
                  [-49.671244653234815, -29.176244846312585]]]),
            {
              "reference": 11,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.706435235510206, -29.22060024068675],
                  [-49.69579223013911, -29.208014849303048],
                  [-49.70334533072505, -29.20966302423242]]]),
            {
              "reference": 11,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.72978118277583, -29.201272039492547],
                  [-49.73922255850825, -29.203070165479392],
                  [-49.743685754309034, -29.215955811947914]]]),
            {
              "reference": 11,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.90318910264275, -29.33409923903126],
                  [-49.89168779038689, -29.34427497118863],
                  [-49.89374772691033, -29.33873830173425]]]),
            {
              "reference": 11,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.89649430894158, -29.31913308201297],
                  [-49.90233079575798, -29.31539119963254],
                  [-49.89666597031853, -29.324970144482695]]]),
            {
              "reference": 11,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.87537995957634, -29.31628926391949],
                  [-49.873835007183764, -29.312098229622013],
                  [-49.87795488023064, -29.314792485716605]]]),
            {
              "reference": 11,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.03177223881002, -29.63563817390593],
                  [-50.02027092655416, -29.623104096176196],
                  [-50.040870291788536, -29.636234995848916]]]),
            {
              "reference": 11,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.02559242923971, -29.6404126504166],
                  [-50.02936897953268, -29.63847304663503],
                  [-50.03949700077291, -29.64817069191933]]]),
            {
              "reference": 11,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.557972926720005, -29.033040800520144],
                  [-49.55926038704715, -29.0345416936678],
                  [-49.557972926720005, -29.03499195735639]]]),
            {
              "reference": 11,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.104211674004524, -29.840154913676226],
                  [-50.104941234856575, -29.84194172153601],
                  [-50.10253797557923, -29.840638843961262]]]),
            {
              "reference": 11,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.113180980950325, -29.843505152190932],
                  [-50.11060606029603, -29.8443613062259],
                  [-50.112408504754036, -29.842537317052354]]]),
            {
              "reference": 11,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.118551497206255, -29.85113706373368],
                  [-50.11775756333785, -29.851285949234793],
                  [-50.11844420884566, -29.850820681306576]]]),
            {
              "reference": 11,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.10848784898238, -29.848978199017083],
                  [-50.108595137342974, -29.850039026306014],
                  [-50.10752225373702, -29.849424864512507]]]),
            {
              "reference": 11,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.10241330128699, -29.85057698350248],
                  [-50.10151207905798, -29.851581961964097],
                  [-50.10078251820593, -29.850502540251043]]]),
            {
              "reference": 11,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.11563122731238, -29.847673655566606],
                  [-50.115974550066284, -29.849125330087496],
                  [-50.1140862749198, -29.84782254623237]]]),
            {
              "reference": 11,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.13509545521334, -29.906723350624123],
                  [-50.136211254163534, -29.909848157202614],
                  [-50.13423714832857, -29.909848157202614]]]),
            {
              "reference": 11,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.13831410603121, -29.906090937365768],
                  [-50.13977322773531, -29.910815339371403],
                  [-50.1370695610483, -29.906909353759563]]]),
            {
              "reference": 11,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.11481002689243, -29.899498249040228],
                  [-50.11695579410434, -29.90340452523906],
                  [-50.112363852270846, -29.90147000759684]]]),
            {
              "reference": 11,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.141319931260526, -29.934865789496822],
                  [-50.13689965080398, -29.938101279723465],
                  [-50.13698548149246, -29.93356412581955]]]),
            {
              "reference": 11,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.145036721499935, -29.739332907732354],
                  [-50.14087393310882, -29.741531401520504],
                  [-50.13971521881439, -29.73612823724265]]]),
            {
              "reference": 11,
              "system:index": "21"
            })]),
    campo = /* color: #99ffff */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.07214284189241, -29.35688977039999],
                  [-50.08124089487092, -29.363771925658984],
                  [-50.07609105356233, -29.364669563798095]]]),
            {
              "reference": 12,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.07935261972444, -29.355543207369827],
                  [-50.07454610116975, -29.357189004211598],
                  [-50.07712102182405, -29.352999650858937]]]),
            {
              "reference": 12,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.23779607065217, -29.392342855781507],
                  [-50.24483418710725, -29.385761781890835],
                  [-50.24431920297639, -29.395184551522117]]]),
            {
              "reference": 12,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.25530553110139, -29.376786904164888],
                  [-50.26062703378694, -29.36900803658807],
                  [-50.26251530893342, -29.37693649194637]]]),
            {
              "reference": 12,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.24737703970628, -29.42097251494738],
                  [-50.250466944491436, -29.415440016781076],
                  [-50.25081026724534, -29.423514372560078]]]),
            {
              "reference": 12,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.24634707144456, -29.4272522829238],
                  [-50.24634707144456, -29.433830671065824],
                  [-50.24342882803636, -29.43024251217634]]]),
            {
              "reference": 12,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.22755354559899, -29.46380365042422],
                  [-50.21622389472008, -29.466792802950046],
                  [-50.21897047675133, -29.462607964744894]]]),
            {
              "reference": 12,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.20970076239586, -29.481438376621643],
                  [-50.20695418036461, -29.486518999613068],
                  [-50.20558088934899, -29.48233497565869]]]),
            {
              "reference": 12,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.04515540384049, -29.177615720442212],
                  [-50.04858863137955, -29.171920133317236],
                  [-50.04893195413346, -29.182112013297793]]]),
            {
              "reference": 12,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.96905203180762, -29.110713971717395],
                  [-49.97282858210059, -29.10681448727416],
                  [-49.97248525934668, -29.11521319321637]]]),
            {
              "reference": 12,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.09814138727637, -29.19286870489095],
                  [-50.10741110163184, -29.191669838458587],
                  [-50.10569448786231, -29.20215944450364]]]),
            {
              "reference": 12,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.16718124950059, -29.264952687669535],
                  [-50.16975617015488, -29.264503430769345],
                  [-50.17164444530137, -29.26884616478196]]]),
            {
              "reference": 12,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.220911260486915, -29.30103654162154],
                  [-50.21782135570176, -29.30672494864405],
                  [-50.215418096424415, -29.30163533623468]]]),
            {
              "reference": 12,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.965320425459154, -29.06678059409056],
                  [-49.97150023502947, -29.076982898973604],
                  [-49.96566374821306, -29.075782680233132]]]),
            {
              "reference": 12,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.937478696137056, -28.971956534215053],
                  [-49.94331518295346, -28.969854004912722],
                  [-49.93679205062924, -28.975861118157873]]]),
            {
              "reference": 12,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.94894620057271, -28.882650200261352],
                  [-49.952379428111776, -28.885956935957704],
                  [-49.94619961854146, -28.884453887329144]]]),
            {
              "reference": 12,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.97332211610006, -28.780214634266976],
                  [-49.969888888560995, -28.791347825423134],
                  [-49.96679898377584, -28.78202009735828]]]),
            {
              "reference": 12,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.9317800628774, -28.753128938376815],
                  [-49.933153353893026, -28.74951698120387],
                  [-49.94345303651021, -28.748011962178506],
                  [-49.9372732269399, -28.755536840419285]]]),
            {
              "reference": 12,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.87959500428365, -28.743195755563253],
                  [-49.88337155457662, -28.738981392621522],
                  [-49.88440152283834, -28.74409881121849]]]),
            {
              "reference": 12,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.84217282410787, -28.702550173692245],
                  [-49.84560605164693, -28.696226107757393],
                  [-49.84594937440084, -28.703152445754906]]]),
            {
              "reference": 12,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.68739016923813, -28.618837457031454],
                  [-49.68052371416, -28.617631940176363],
                  [-49.68533023271469, -28.61461808749217]]]),
            {
              "reference": 12,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.65889438066391, -28.59864322445048],
                  [-49.66507419023422, -28.601657535466522],
                  [-49.65511783037094, -28.601356108255747]]]),
            {
              "reference": 12,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.64481814775375, -28.535875574555543],
                  [-49.6527145710936, -28.540701308474063],
                  [-49.64584811601547, -28.541907707416083]]]),
            {
              "reference": 12,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.55284511185878, -28.446525168128687],
                  [-49.55799495316737, -28.455279055353834],
                  [-49.55215846635097, -28.450449414088226]]]),
            {
              "reference": 12,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.541416355175684, -28.348146203203708],
                  [-49.534893222851466, -28.349052652424483],
                  [-49.53386325458975, -28.34512464992232]]]),
            {
              "reference": 12,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.30040350089241, -29.403093459196356],
                  [-50.29079046378303, -29.4023457103845],
                  [-50.29834356436897, -29.40129885280917]]]),
            {
              "reference": 12,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.338512326576, -29.37991068925848],
                  [-50.3355940831678, -29.383650203051012],
                  [-50.33473577628303, -29.378564430653032]]]),
            {
              "reference": 12,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.31756963858772, -29.438978933318673],
                  [-50.319457913734205, -29.4341949358556],
                  [-50.32151785025764, -29.437184960685723]]]),
            {
              "reference": 12,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.356880093909986, -29.42343011747346],
                  [-50.362888242103345, -29.420888257752637],
                  [-50.35876836905647, -29.427168030937562]]]),
            {
              "reference": 12,
              "system:index": "28"
            })]),
    aflora = /* color: #0b4a8b */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.95256967971039, -26.022283571008092],
                  [-48.93111200759125, -26.00762805638571],
                  [-48.95411463210297, -26.006393824270777]]]),
            {
              "reference": 29,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.9584061665268, -26.042643984953997],
                  [-48.948278145286565, -26.041410121078844],
                  [-48.949994759056096, -26.033543933677535]]]),
            {
              "reference": 29,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.8176792550917, -27.823605274853577],
                  [-48.81785091646865, -27.83119577902236],
                  [-48.81304439791396, -27.83058855822276],
                  [-48.815962641322166, -27.828615067161234]]]),
            {
              "reference": 29,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.887888758265525, -27.820568924570306],
                  [-48.87484249361709, -27.81252218567045],
                  [-48.87999233492568, -27.80614510122231],
                  [-48.8839405465956, -27.811763028581915]]]),
            {
              "reference": 29,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.87707409151748, -27.781696143473987],
                  [-48.87072262057021, -27.7841260996356],
                  [-48.868147699915916, -27.77729170954579]]]),
            {
              "reference": 29,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.73751339205459, -27.78549292611544],
                  [-48.74094661959365, -27.800071339433618],
                  [-48.73579677828506, -27.796578772676636],
                  [-48.7352817941542, -27.787315334696252]]]),
            {
              "reference": 29,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.730818598353416, -27.799463944581984],
                  [-48.72772869356826, -27.797641739658168],
                  [-48.73167690523818, -27.792023082151143]]]),
            {
              "reference": 29,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.70918926485732, -27.766052001039164],
                  [-48.70953258761123, -27.773038983421],
                  [-48.707129328333885, -27.77425406499235]]]),
            {
              "reference": 29,
              "system:index": "7"
            })]),
    reg_04_rev = /* color: #98ff00 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.999244072119566, -29.945905717682546],
                  [-49.859168388525816, -29.68854439442801],
                  [-49.639441826025816, -29.408990750387492],
                  [-49.158789970557066, -28.91491431445153],
                  [-48.730323173682066, -28.67662695111871],
                  [-48.488623954932066, -28.38223295007087],
                  [-48.527076103369566, -28.176637633216174],
                  [-48.271643974463316, -27.63537516244261],
                  [-48.213965751807066, -27.272222887399174],
                  [-48.488623954932066, -26.89318382522384],
                  [-48.521582939307066, -26.60868036822565],
                  [-48.36365447251019, -26.170736964333784],
                  [-48.47626433579144, -25.964727053836192],
                  [-49.018714286963316, -25.994355549455786],
                  [-49.029700615088316, -25.98077674906923],
                  [-49.057166435400816, -26.077028884259935],
                  [-49.20960173813519, -26.272990072687225],
                  [-49.342810966650816, -26.309926895396895],
                  [-49.44580779282269, -26.496892330763103],
                  [-49.67102751938519, -26.618502672847974],
                  [-49.90448699204144, -26.46370350072683],
                  [-50.11322722641644, -26.484601288176847],
                  [-50.238196708838316, -26.69827759828134],
                  [-50.34598092921342, -27.04369607215225],
                  [-50.21559667858223, -27.311381678738353],
                  [-49.72670507701973, -27.61844615966467],
                  [-49.50148535045723, -27.628180211099778],
                  [-49.47951269420723, -27.44796037058701],
                  [-49.23781347545723, -27.413831509492297],
                  [-49.01259374889473, -27.58923881435097],
                  [-48.93019628795723, -27.71088468284357],
                  [-49.14992285045723, -27.890671772202268],
                  [-49.51247167858223, -28.273542208470964],
                  [-49.72121191295723, -28.611649146430583],
                  [-49.99037695201973, -28.77548159349757],
                  [-49.94643163951973, -29.05436710944466],
                  [-50.08925390514473, -29.15515768254453],
                  [-50.38588476451973, -29.4473691451645],
                  [-50.23756933483223, -29.97694235861922],
                  [-50.13319921764473, -30.15759391904428]]]),
            {
              "system:index": "0"
            })]),
    flo = /* color: #599500 */ee.FeatureCollection([]);

// Define the region ID (old ID 11)
var regiaoID = 'reg_04'; 

// Set the collection flag (true for collection, false for individual years)
var coleta = false;   

// Define the years to process
var anos = [2016,2017,2018,2019,2020,2021,2022,2023];

// If collecting data, only process 2023
if (coleta) {var anos = [2023]};

// Set the number of random forest trees
var RFtrees = 100;

// Increase the number of trees for collection
if (coleta) {var RFtrees = 200};

// Define output version and other parameters
var versao_out = 1;
var versao_pt = 'S2_v1';
var versao_estavel = '3';
var dir_pt_in = 'projects/mapbiomas-workspace/AMOSTRAS/col9/MATA_ATLANTICA/teste/';

// Load biomes data
var bioma250mil = ee.FeatureCollection('projects/mapbiomas-workspace/AUXILIAR/biomas_IBGE_250mil');
var bioma250mil_MA_vetor = bioma250mil.filterMetadata('Bioma','equals', 'Mata Atlântica');
var biomes = ee.Image('projects/mapbiomas-workspace/AUXILIAR/biomas-raster-41');
var bioma250mil_MA = biomes.mask(biomes.eq(2));

// Add the bioma layer to the map
Map.addLayer(bioma250mil_MA,{},'layer bioma',false);

// Load palettes and define visualization parameters
var palettes = require('users/mapbiomas/modules:Palettes.js');
var vis = {
    'min': 0,
    'max': 62,
    'palette': palettes.get('classification7')
};

// Load regions collection
var regioesCollection = ee.FeatureCollection('projects/mapbiomas-workspace/AUXILIAR/Mata_Atlantica_col6_PLANET');

// Define visualization parameters for median composites
var visParMedian2 = {bands: ['swir1_median', 'nir_median', 'red_median'],gain: [0.08, 0.06, 0.2],gamma: 0.85};

// Define biome and output directory
var bioma = "MATAATLANTICA";
var dirout = 'projects/mapbiomas-workspace/COLECAO7/classificacao-ma/';

// Load S2 cluster image
var S2_cluster = ee.Image('projects/mapbiomas-workspace/AMOSTRAS/S2_2024/MATA_ATLANTICA/mosaicos_MA_S2_clusters_2106_2023');

// Define the region boundary
//var limite = regioesCollection.filterMetadata('reg_id', "equals", regiaoID);
var limite = reg_04_rev;

// Load stable map from collection 6
var mapa_estavel_col6 = ee.Image('projects/mapbiomas-workspace/AMOSTRAS/col7/MATA_ATLANTICA/MA_amostras_estaveis85a20_col6_v1');

// Add the stable map to the map
Map.addLayer(mapa_estavel_col6, vis, 'mapa_estavel_col6', false);

// Create a blank image and outline the region
var blank = ee.Image(0).mask(0);
var outline = blank.paint(limite, 'AA0000', 2); 
// Define visualization parameters for the outline
var visPar = {'palette':'000000','opacity': 0.6};
// Add the outline to the map
Map.addLayer(outline, visPar, regiaoID, false);

// Define a function to shuffle a feature collection
var shuffle = function (collection, seed) {
    // Add a random column to the collection
    collection = collection.randomColumn('random', seed || 1)
        // Sort by the random column
        .sort('random', true)
        // Map over the collection to create a new ID
        .map(function (feature) {
                var rescaled = ee.Number(feature.get('random')).multiply(1000000000).round();
                return feature.set('new_id', rescaled)});
    // Get a list of the new IDs
    var randomIdList = ee.List(collection.reduceColumns(ee.Reducer.toList(), ['new_id']).get('list'));
    // Create a sequential list of IDs
    var sequentialIdList = ee.List.sequence(1, collection.size());
    // Remap the collection using the new and sequential IDs
    var shuffled = collection.remap(randomIdList, sequentialIdList, 'new_id');
    // Return the shuffled collection
    return shuffled;
};

// Define visualization parameters for hand-labeled data
var vis_hand = {
    'min': 0,
    'max': 60,
    'palette': 'blue,white,green,orange,red,brown'
};

// Loop through the years
for (var i_ano=0;i_ano<anos.length; i_ano++){
  // Get the current year
  var ano = anos[i_ano];

  // Define the asset path for Sentinel 2 mosaics
  var asset = 'projects/mapbiomas-mosaics/assets/SENTINEL/BRAZIL/mosaics-3';
  
  // Define the band names to use for classification
  var bandNames = ee.List([
  // THE 60 MOST IMPORTANT BANDS FOR THIS REGION
    'latitude','longitude','blue_median','green_median_texture','green_median','blue_median_wet','cvi_median','green_median_wet','red_edge_1_median','green_median_texture_'+ano,'gcvi_median','red_median_wet','spri_median','red_median','iia_median_wet','lai_median','gcvi_median_wet','iia_median','dswi5_median_wet','nddi_median_wet','green_median_dry','ndwi_median_'+ano,'spri_median_1','brightness_median_dry','spri_median_wet','gli_median_dry','swir1_median_wet','ndvi_median_wet_'+ano,'red_min','ui_median_dry','green_min','red_median_dry','msi_median_dry','nir_median_wet','avi_median_wet','awei_median_wet','blue_median_dry','brightness_median','gcvi_median_dry','swir2_stdDev','mbi_median_wet','shape_median_wet','afvi_median_wet','red_edge_1_median_wet','brba_median','osavi_median','gli_median_wet','shape_median_dry','swir2_median_dry','cvi_median_wet','red_edge_4_median','co2flux_median','gvmi_median_dry_1','ratio_median','swir2_median','red_edge_1_median_dry','dswi5_median_dry','ratio_median_wet','dswi5_median','ri_median',
  // ALL 143 BANDS TO FEATURE IMPORTANCE
  //    'blue_median','afvi_median','afvi_median_dry','afvi_median_wet','avi_median','avi_median_dry','avi_median_wet','awei_median','awei_median_dry','awei_median_wet','blue_median_dry','blue_median_wet','blue_stdDev','brba_median','brba_median_dry','brba_median_wet','brightness_median','brightness_median_dry','brightness_median_wet','bsi_median','bsi_median_1','bsi_median_2','clusters_2023','co2flux_median','cvi_median','cvi_median_dry','cvi_median_wet','dswi5_median','dswi5_median_dry','dswi5_median_wet','evi_median','evi_median_dry','evi_median_wet','gcvi_median','gcvi_median_dry','gcvi_median_wet','gemi_median','gemi_median_dry','gemi_median_wet','gli_median','gli_median_dry','gli_median_wet','green_median','green_median_dry','green_median_texture','green_median_texture_2023','green_median_wet','green_min','green_stdDev','gvmi_median','gvmi_median_1','gvmi_median_dry','gvmi_median_dry_1','gvmi_median_wet','gvmi_median_wet_1','iia_median','iia_median_dry','iia_median_wet','lai_median','latitude','longitude','lswi_median','lswi_median_dry','lswi_median_wet','mbi_median','mbi_median_dry','mbi_median_wet','msi_median','msi_median_dry','msi_median_wet','nddi_median','nddi_median_dry','nddi_median_wet','ndvi_median','ndvi_median_dry','ndvi_median_dry_2023','ndvi_median_wet','ndvi_median_wet_2023','ndwi_median','ndwi_median_2023','ndwi_median_dry','ndwi_median_wet','nir_median','nir_median_contrast','nir_median_dry','nir_median_dry_contrast','nir_median_wet','nir_stdDev','osavi_median','osavi_median_dry','osavi_median_wet','ratio_median','ratio_median_dry','ratio_median_wet','red_edge_1_median','red_edge_1_median_dry','red_edge_1_median_wet','red_edge_1_stdDev','red_edge_2_median','red_edge_2_median_dry','red_edge_2_median_wet','red_edge_2_stdDev','red_edge_3_median','red_edge_3_median_dry','red_edge_3_median_wet','red_edge_3_stdDev','red_edge_4_median','red_edge_4_median_dry','red_edge_4_median_wet','red_edge_4_stdDev','red_median','red_median_contrast','red_median_dry','red_median_dry_contrast','red_median_wet','red_min','red_stdDev','ri_median','ri_median_dry','ri_median_wet','rvi_median','rvi_median_1','rvi_median_wet','shape_median','shape_median_dry','shape_median_wet','spri_median','spri_median_1','spri_median_wet','swir1_median','swir1_median_dry','swir1_median_wet','swir1_stdDev','swir2_median','swir2_median_dry','swir2_median_wet','swir2_stdDev','ui_median','ui_median_dry','ui_median_wet','wetness_median','wetness_median_dry','wetness_median_wet',
  ])

  // Filter the Sentinel 2 collection
  var collection = ee.ImageCollection(asset)
        .filter(ee.Filter.eq('version', '3'))
        .filter(ee.Filter.eq('year', ano))
        .filter(ee.Filter.inList('biome', [
            'MATAATLANTICA',
        ])); 

  // Create a mosaic of the filtered collection
  var mosaicoTotal = collection.mosaic();

  // Add Caatinga indices to the mosaic
  var addIndexCaatinga = require('users/marcosrosaUSP/MapBiomas_col9_MataAtlan:Mata_Atlantica_SENTINEL2/processa_Bandas_Sentinel2_CAATINGA');
  mosaicoTotal = addIndexCaatinga.get(mosaicoTotal);

  // Add S2 cluster bands to the mosaic
  mosaicoTotal = mosaicoTotal.addBands(S2_cluster.select([
    'clusters_'+ano, 'ndvi_median_dry_'+ano,'ndvi_median_wet_'+ano,'ndwi_median_'+ano, 'green_median_texture_'+ano
    ]))
    
  // Add the mosaic to the map
  Map.addLayer(mosaicoTotal, {'bands': ['swir1_median', 'nir_median', 'red_median'],
    'gain': [0.08, 0.07, 0.2],'gamma': 0.85}, 'Sentinel 2 '+ano, false);
  // Print the mosaic
  //print(mosaicoTotal)

  // Load the training data
  //var BDamostras = ee.FeatureCollection('projects/mapbiomas-workspace/AMOSTRAS/col9/MATA_ATLANTICA/teste/REGIONs_'+regiaoID+'_'+ano)
  var BDamostras = ee.FeatureCollection('projects/mapbiomas-workspace/AMOSTRAS/S2_2024/MATA_ATLANTICA/pontos_train_v1_'+ano)
                    .filterMetadata('reg_id', 'equals', regiaoID);

  // Filter the training data by reference class
  var BDflo = BDamostras.filterMetadata("reference", "equals", 3);
  var BDsav = BDamostras.filterMetadata("reference", "equals", 4);//.limit(100);
  var BDreflo = BDamostras.filterMetadata("reference", "equals", 9);
  var BDvarzea = BDamostras.filterMetadata("reference", "equals", 11);
  var BDcampo = BDamostras.filterMetadata("reference", "equals", 12);
  var BDOutroNFlo = BDamostras.filterMetadata("reference", "equals", 13);
  var BDagro = BDamostras.filterMetadata("reference", "equals", 21);

  // Shuffle and limit the agro class
  // BDagro = shuffle(BDagro, 2).limit(1000);
  var BDNaoVeg = BDamostras.filterMetadata("reference", "equals", 22);
  var BDAflora = BDamostras.filterMetadata("reference", "equals", 29);
  var BDagua = BDamostras.filterMetadata("reference", "equals", 33);

  // Create a feature collection of complementary samples
  var amostraTotal = agro.merge(varzea).merge(campo).merge(aflora)//.merge(nao_flo);
  
  // Reduce the complementary samples to an image
  var amostraTotalimg = amostraTotal.reduceToImage({properties: ['reference'],reducer: ee.Reducer.first()});
  amostraTotalimg = amostraTotalimg.select([0],['reference']);

  // Sample the mosaic using the complementary samples
  // var training_flo = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 200, 'region': flor.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_nflo = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 300, 'region': nao_flo.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_sav = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 1000, 'region': sav.filterBounds(limite), 'scale': 10, 'seed': 1});
  var training_afl = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 400, 'region': aflora.filterBounds(limite), 'scale': 10, 'seed': 1});
  var training_var = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 500, 'region': varzea.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_agu = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 200, 'region': agua.filterBounds(limite), 'scale': 10, 'seed': 1});
  var training_cam = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 600, 'region': campo.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_nflo = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 200, 'region': n_flo.filterBounds(limite), 'scale': 10, 'seed': 1});
  var training_agr = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 300, 'region': agro.filterBounds(limite), 'scale': 10, 'seed': 1});

  // Print the size of the training data if collecting data
  if (coleta) {
// print('BDflo',BDflo.size())
// print('BDsav',BDsav.size())
// print('BDvar',BDvarzea.size())
// print('BDcam',BDcampo.size())
// print('BDOut',BDOutroNFlo.size())
// print('BDAfl',BDAflora.size())
// print('BDagr',BDagro.size())
// print('BDNao',BDNaoVeg.size())
// print('BDagu',BDagua.size())
//  print('training_agr',training_agr.size())
//  print('training_cam',training_cam.size())
//print(training_sav.size())
//print(training_afl.size())
//print(training_cam.size())
//print(training_agr.size())
  }

  // Merge the training data
  var training = BDflo.merge(BDreflo).merge(BDcampo)//.merge(BDsav).merge(BDOutroNFlo).merge(BDAflora)
                      .merge(BDagro).merge(BDNaoVeg).merge(BDagua)
                      // Add complementary samples
                      .merge(training_agr).merge(training_var).merge(training_cam).merge(training_afl)//.merge(training_flo)//.merge(training_agu)//.merge(training_agr);

  // Train a random forest classifier
  var classifierRF = ee.Classifier.smileRandomForest({numberOfTrees: RFtrees, variablesPerSplit:1}).train(training, 'reference', bandNames);

  // Print the classifier explanation if collecting data
  if (coleta) {print(classifierRF.explain())};

  // Train a gradient tree boosting classifier
  var classifierGTB = ee.Classifier.smileGradientTreeBoost({numberOfTrees: 30, shrinkage: 0.1, samplingRate: 0.8, loss: 'LeastSquares'}).train(training, 'reference', bandNames);

  // Print the classifier explanation
  // print(classifier.explain())

  // Classify the mosaic using the random forest classifier
  var classifiedRF = mosaicoTotal.classify(classifierRF).mask(mosaicoTotal.select('blue_median'));

  // Classify the mosaic using the gradient tree boosting classifier
  var classifiedGTB = mosaicoTotal.classify(classifierGTB).mask(mosaicoTotal.select('blue_median'));

  // Rename and clip the classified images
  classifiedRF = classifiedRF.select(['classification'],['classification_'+ano]).clip(limite.geometry()).toInt8();
  // classifiedGTB = classifiedGTB.select(['classification'],['classification_'+ano]).clip(limite.geometry()).toInt8();

  // Add the classified images to the map if collecting data
  if (coleta) {  
    Map.addLayer(classifiedRF, vis, 'RF'+ano+"_"+regiaoID, false);
    // Map.addLayer(classifiedGTB, vis, 'GTB'+ano+"_"+regiaoID, false);
  }

  // Combine the classified images for all years
  if (i_ano == 0){ var classified16a23RF = classifiedRF;}//  var classified16a23GTB = classifiedGTB}  
  else {classified16a23RF = classified16a23RF.addBands(classifiedRF);}// classified16a23GTB = classified16a23GTB.addBands(classifiedGTB)}
}

// Export the classified image if not collecting data
if (coleta) {}
   else 
   {
     // Set metadata for the classified image
     classified16a23RF = classified16a23RF
     .set('territory', 'BRAZIL')
     .set('biome', 'MATA ATÂNTICA')
     .set('source', 'arcplan')
     .set('version', '1')
     .set('collection_id',versao_out);

//     classified16a23GTB = classified16a23GTB
//     .set('territory', 'BRAZIL')
//     .set('biome', 'MATA ATÂNTICA')
//     .set('source', 'arcplan')
//     .set('version', '1')
//     .set('collection_id',versao_out);
     
    // Export the classified image to an asset
    Export.image.toAsset({
       "image": classified16a23RF.toInt8(),
       "description": regiaoID+'-'+'RF_SENTINEL2_v'+versao_out,
       "assetId": dirout + regiaoID+'-'+'RF_SENTINEL2_v'+versao_out,
       "scale": 10,
       "pyramidingPolicy": {
           '.default': 'mode'
       },
       "maxPixels": 1e13,
       "region": limite
     });    
     
//    Export.image.toAsset({
//       "image": classified16a23GTB.toInt8(),
//       "description": regiaoID+'-'+'GTB_SENTINEL2_v'+versao_out,
//       "assetId": dirout + regiaoID+'-'+'GTB_SENTINEL2_v'+versao_out,
//       "scale": 10,
//       "pyramidingPolicy": {
//           '.default': 'mode'
//       },
//       "maxPixels": 1e13,
//       "region": limite
//     });    
}
