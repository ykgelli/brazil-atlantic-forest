var varzea = /* color: #d63000 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.29306318705524, -20.715530744420164],
                  [-48.2990713352486, -20.716975805941086],
                  [-48.288943314008364, -20.72002644610719]]]),
            {
              "reference": 11,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.342330002240786, -20.682129928421425],
                  [-48.33821012919391, -20.67233310211242],
                  [-48.34370329325641, -20.679560330229503],
                  [-48.34541990702594, -20.684217694919205],
                  [-48.343359970502505, -20.689517280875737]]]),
            {
              "reference": 11,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.678130809399, -20.51657555516171],
                  [-50.678302470775954, -20.51906751699034],
                  [-50.677529994579665, -20.51778134820817]]]),
            {
              "reference": 11,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.71308678646423, -20.546413744784417],
                  [-50.71308678646423, -20.549869651962172],
                  [-50.71368760128357, -20.5512359192937],
                  [-50.71257180233337, -20.550834077228775],
                  [-50.712228479579466, -20.54673522781799]]]),
            {
              "reference": 11,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.73034270533985, -20.55726342346695],
                  [-50.730256874651374, -20.56039763166582],
                  [-50.7290552450127, -20.560719085281118],
                  [-50.72957022914356, -20.557504518688212]]]),
            {
              "reference": 11,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.86189730243336, -20.47247208160627],
                  [-50.86078150348317, -20.473678221636188],
                  [-50.86146814899098, -20.474964760552606],
                  [-50.85975153522145, -20.476010065479834],
                  [-50.86000902728688, -20.47215044266398]]]),
            {
              "reference": 11,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.84078295306813, -20.50310509965867],
                  [-50.839152169987074, -20.498361804449125],
                  [-50.84232790546071, -20.501979585268188]]]),
            {
              "reference": 11,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.92776840768634, -20.348951984365307],
                  [-50.92510765634356, -20.347825341704947],
                  [-50.9242493494588, -20.34685964145674],
                  [-50.92545097909747, -20.346779166163593],
                  [-50.92888420663653, -20.34871056162977]]]),
            {
              "reference": 11,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.55908820100033, -20.033389324838158],
                  [-50.55925986237728, -20.030163797987093],
                  [-50.560289830639, -20.029679963249386],
                  [-50.560289830639, -20.033308687473767]]]),
            {
              "reference": 11,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.372742783951985, -19.955351531820924],
                  [-50.3737727522137, -19.957691156640255],
                  [-50.371712815690266, -19.95696506989152]]]),
            {
              "reference": 11,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.4233594978819, -20.056550305032136],
                  [-50.4237028206358, -20.060017161148682],
                  [-50.42207203755475, -20.063000208588768],
                  [-50.42129956135846, -20.06050090242428]]]),
            {
              "reference": 11,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.41477642903424, -20.067756842573928],
                  [-50.41074238667584, -20.070820360971616],
                  [-50.41048489461041, -20.067756842573928]]]),
            {
              "reference": 11,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.395922559331495, -20.213114358836606],
                  [-50.394463437627394, -20.213275448186298],
                  [-50.39454926831587, -20.212067273998816],
                  [-50.39583672864302, -20.212067273998816]]]),
            {
              "reference": 11,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.81099610187426, -20.124303614703347],
                  [-49.811081932562736, -20.13010602930626],
                  [-49.80996613361254, -20.13050896676759]]]),
            {
              "reference": 11,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.7705698476018, -20.122933568719628],
                  [-49.77211479999438, -20.123336524666797],
                  [-49.770913170355705, -20.124303614703347],
                  [-49.769625710028556, -20.123981252022418]]]),
            {
              "reference": 11,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.81975083209887, -20.145900399940174],
                  [-49.820094154852775, -20.147350823309885],
                  [-49.819321678656486, -20.147350823309885]]]),
            {
              "reference": 11,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.67864074585718, -20.232914136202393],
                  [-49.6741775500564, -20.237746128912786],
                  [-49.66937103150171, -20.236296546872662],
                  [-49.674005888679446, -20.23549121767497]]]),
            {
              "reference": 11,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.93267478992859, -20.675483564673453],
                  [-48.92623748829285, -20.6782941359461],
                  [-48.92563667347351, -20.67668810159022],
                  [-48.92889823963562, -20.67612598555168],
                  [-48.93112983753601, -20.67451992825933]]]),
            {
              "reference": 11,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.91825523426453, -20.677972930434183],
                  [-48.91696777393738, -20.68030165499687],
                  [-48.91576614429871, -20.68030165499687],
                  [-48.91671028187195, -20.678133533275098]]]),
            {
              "reference": 11,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.979538345836794, -20.6624739571264],
                  [-48.98108329822937, -20.663598288186307],
                  [-48.98005332996765, -20.66464230243426]]]),
            {
              "reference": 11,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.86298712429159, -20.026498395201116],
                  [-47.86504706081503, -20.0216598679793],
                  [-47.865390383568936, -20.027466082774882]]]),
            {
              "reference": 11,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.84908255275839, -19.98343027078149],
                  [-47.840671145287686, -19.981171691971223],
                  [-47.84753760036581, -19.980687706585766]]]),
            {
              "reference": 11,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.01413670923701, -21.514303570107053],
                  [-48.01653996851435, -21.50775567959575],
                  [-48.018428243660836, -21.51126921849064],
                  [-48.01533833887568, -21.523725626595958]]]),
            {
              "reference": 11,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.86327505733909, -20.603559595745466],
                  [-49.86567831661643, -20.601631405353935],
                  [-49.865334993862525, -20.60380061782919]]]),
            {
              "reference": 11,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.86224508907737, -20.597212543706913],
                  [-49.86215925838889, -20.59632875600686],
                  [-49.86353254940452, -20.595525308197484]]]),
            {
              "reference": 11,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.11747152194496, -20.613360853008434],
                  [-49.11635572299476, -20.61054908140385],
                  [-49.11918813571449, -20.61207547814317]]]),
            {
              "reference": 11,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.1334360300016, -20.59335597796446],
                  [-49.13403684482093, -20.59239182128771],
                  [-49.13463765964027, -20.59311493936679]]]),
            {
              "reference": 11,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.12219220981117, -20.616252906797403],
                  [-49.121505564303355, -20.615770901646016],
                  [-49.12210637912269, -20.614806886767038]]]),
            {
              "reference": 11,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.14283449038978, -20.5835534343912],
                  [-49.1424053369474, -20.583031150050054],
                  [-49.14407903537269, -20.582950798454274]]]),
            {
              "reference": 11,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.34891397342201, -20.257161072077587],
                  [-49.34960061892982, -20.263119577925007],
                  [-49.345995730013804, -20.260623474936438]]]),
            {
              "reference": 11,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.357239550204234, -20.251927060702194],
                  [-49.35586625918861, -20.25039708559316],
                  [-49.358183687777476, -20.24975288103792]]]),
            {
              "reference": 11,
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.6025415121679, -19.992689173972447],
                  [-48.60211235872552, -19.990027430559685],
                  [-48.6051164328222, -19.99228588240763]]]),
            {
              "reference": 11,
              "system:index": "31"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.62339836946771, -19.987365642164008],
                  [-48.62382752291009, -19.986397707959213],
                  [-48.62485749117181, -19.98728498120743]]]),
            {
              "reference": 11,
              "system:index": "32"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.565805977499934, -20.210718036979817],
                  [-48.56443268648431, -20.21651723781245],
                  [-48.559282845175716, -20.215228545193774]]]),
            {
              "reference": 11,
              "system:index": "33"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.579538887656184, -20.205240815550233],
                  [-48.58262879244134, -20.201696628404544],
                  [-48.58709198824212, -20.205240815550233]]]),
            {
              "reference": 11,
              "system:index": "34"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.853939598715755, -20.54012227813786],
                  [-48.85428292146966, -20.53795216068464],
                  [-48.85582787386224, -20.53891666113237]]]),
            {
              "reference": 11,
              "system:index": "35"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.85702950350091, -20.534817492221787],
                  [-48.85737282625482, -20.536746526571132],
                  [-48.85582787386224, -20.535942765215548]]]),
            {
              "reference": 11,
              "system:index": "36"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.83110863558099, -20.5271011115643],
                  [-48.830936974204036, -20.528226441315628],
                  [-48.83016449800775, -20.5271011115643]]]),
            {
              "reference": 11,
              "system:index": "37"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.83685929170892, -20.55515150544635],
                  [-48.83685929170892, -20.554026373831505],
                  [-48.83788925997064, -20.554749673677826]]]),
            {
              "reference": 11,
              "system:index": "38"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.875912254965755, -21.39064719989928],
                  [-48.8757405935888, -21.391366462586234],
                  [-48.87496811739251, -21.391046790717567]]]),
            {
              "reference": 11,
              "system:index": "39"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.576534813559505, -21.560454557746137],
                  [-48.57662064424798, -21.562051051850624],
                  [-48.57541901460931, -21.561651929972445]]]),
            {
              "reference": 11,
              "system:index": "40"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.74519211641595, -21.82212356360349],
                  [-48.74347550264642, -21.818697271230455],
                  [-48.7479386984472, -21.819972180301466]]]),
            {
              "reference": 11,
              "system:index": "41"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.73798233858392, -21.828099458606374],
                  [-48.740557259238216, -21.826107521340333],
                  [-48.74167305818841, -21.828577519422936]]]),
            {
              "reference": 11,
              "system:index": "42"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.745020455039, -21.80738195560066],
                  [-48.747337883627864, -21.80690382398019],
                  [-48.74725205293939, -21.808577277667233]]]),
            {
              "reference": 11,
              "system:index": "43"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.72167450777337, -21.836385619908068],
                  [-48.72364861360833, -21.835987257754823],
                  [-48.72347695223138, -21.83829774279437]]]),
            {
              "reference": 11,
              "system:index": "44"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.753775185263606, -21.819334727185662],
                  [-48.75463349214837, -21.822442284304735],
                  [-48.75214440218255, -21.823239082951858]]]),
            {
              "reference": 11,
              "system:index": "45"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.73592240206048, -21.815908368042663],
                  [-48.737295693076106, -21.81471310718387],
                  [-48.738325661337825, -21.815509948865394]]]),
            {
              "reference": 11,
              "system:index": "46"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.71566635958001, -21.83423445109605],
                  [-48.716095513022395, -21.836704308831578],
                  [-48.71446472994134, -21.835110857111108]]]),
            {
              "reference": 11,
              "system:index": "47"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.02196469326513, -21.544350554302245],
                  [-48.02127804775732, -21.54275386538372],
                  [-48.0228230001499, -21.54147650160143]]]),
            {
              "reference": 11,
              "system:index": "48"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.03157773037451, -21.545308559221315],
                  [-48.032178545193844, -21.543871549471174],
                  [-48.033637666897945, -21.54586739250349]]]),
            {
              "reference": 11,
              "system:index": "49"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.018188142972164, -21.547064885147087],
                  [-48.01698651333349, -21.545468226092964],
                  [-48.01887478847998, -21.545308559221315]]]),
            {
              "reference": 11,
              "system:index": "50"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.101537303648364, -21.383541231838038],
                  [-48.102223949156176, -21.38162308755393],
                  [-48.10411222430266, -21.383301465177567]]]),
            {
              "reference": 11,
              "system:index": "51"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.09913404437102, -21.37434989542722],
                  [-48.09982068987883, -21.3772272454097],
                  [-48.097245769224536, -21.376108282692712]]]),
            {
              "reference": 11,
              "system:index": "52"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.09192426653899, -21.370593270057462],
                  [-48.09037931414641, -21.370992915635817],
                  [-48.09020765276946, -21.368914746717092]]]),
            {
              "reference": 11,
              "system:index": "53"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.103511409483325, -21.38633848051338],
                  [-48.10265310259856, -21.38458021616014],
                  [-48.10385473223723, -21.38450029455113]]]),
            {
              "reference": 11,
              "system:index": "54"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.13809971574989, -21.33211043519392],
                  [-48.13629727129188, -21.331790633990483],
                  [-48.13706974748817, -21.329711909177124]]]),
            {
              "reference": 11,
              "system:index": "55"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.138958022634654, -21.350248721903263],
                  [-48.13835720781532, -21.35248703392318],
                  [-48.1373272395536, -21.351527761528825]]]),
            {
              "reference": 11,
              "system:index": "56"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.16410641435829, -20.765852288660632],
                  [-48.16410641435829, -20.77066750487303],
                  [-48.160673186819224, -20.76970447390806]]]),
            {
              "reference": 11,
              "system:index": "57"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.76173214678016, -19.493291476803627],
                  [-47.753149077932505, -19.49717515447361],
                  [-47.756925628225474, -19.490702306584744]]]),
            {
              "reference": 11,
              "system:index": "58"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.69032101396766, -19.470958522246146],
                  [-47.689977691213755, -19.468368994997597],
                  [-47.69512753252235, -19.469340072564375]]]),
            {
              "reference": 11,
              "system:index": "59"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.58148770097938, -19.625930893434504],
                  [-47.58080105547157, -19.621080156173093],
                  [-47.58869747881141, -19.620756768483066]]]),
            {
              "reference": 11,
              "system:index": "60"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.370601699392466, -20.818576877226686],
                  [-47.37077336076942, -20.81953959629165],
                  [-47.36905674699989, -20.818657104050356]]]),
            {
              "reference": 11,
              "system:index": "61"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.36768345598426, -20.821304565268314],
                  [-47.36802677873817, -20.820261631553763],
                  [-47.36897091631141, -20.82058253500408]]]),
            {
              "reference": 11,
              "system:index": "62"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.36742596391883, -20.82812356931206],
                  [-47.367168471853404, -20.829326890921745],
                  [-47.365881011526255, -20.828765342033698]]]),
            {
              "reference": 11,
              "system:index": "63"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.35609631303993, -20.813041123246233],
                  [-47.35695461992469, -20.815127083402995],
                  [-47.352663085500865, -20.81584913980777]]]),
            {
              "reference": 11,
              "system:index": "64"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.6224289393827, -21.373915460865657],
                  [-47.623544738332896, -21.372077118868578],
                  [-47.62543301347938, -21.37271654479006]]]),
            {
              "reference": 11,
              "system:index": "65"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.62148480180946, -21.366162296717683],
                  [-47.62114147905555, -21.365442910161292],
                  [-47.62217144731727, -21.365682706072704]]]),
            {
              "reference": 11,
              "system:index": "66"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.359448596400654, -19.84367866337739],
                  [-47.35773198263112, -19.843274991581936],
                  [-47.35807530538503, -19.842548379763738]]]),
            {
              "reference": 11,
              "system:index": "67"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.71258246719865, -19.76551487979482],
                  [-47.71193873703508, -19.765111009640144],
                  [-47.71202456772355, -19.764747525626287]]]),
            {
              "reference": 11,
              "system:index": "68"
            })]),
    imageVisParam = {"opacity":1,"bands":["b1"],"min":6.611734818658739,"max":55.90739627890223,"gamma":1},
    agro = /* color: #ff9999 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.29359658266809, -20.069454222866863],
                  [-51.30355294253137, -20.07284017675554],
                  [-51.29823143984582, -20.078160813710067]]]),
            {
              "reference": 21,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.27934868838098, -20.079128182846077],
                  [-51.278662042873165, -20.07541990207201],
                  [-51.28209527041223, -20.075581133494932],
                  [-51.282438593166134, -20.07928941045498]]]),
            {
              "reference": 21,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.190789778709, -20.247833273018628],
                  [-51.19696958827931, -20.243001593977056],
                  [-51.20417936611134, -20.243967941807455],
                  [-51.19868620204884, -20.25330899424231]]]),
            {
              "reference": 21,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.2515579061504, -20.22914994802994],
                  [-51.25396116542775, -20.21851877805953],
                  [-51.25739439296681, -20.23204923188484]]]),
            {
              "reference": 21,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.76529013197554, -20.27345761914623],
                  [-50.76735006849898, -20.264117779090363],
                  [-50.77181326429976, -20.272169398774167]]]),
            {
              "reference": 21,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.60533942108309, -20.306348705078538],
                  [-50.610660923768634, -20.301840843700557],
                  [-50.60877264862215, -20.308441596109763]]]),
            {
              "reference": 21,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.48534811859285, -20.305543739456834],
                  [-50.48689307098543, -20.30232383512469],
                  [-50.488781346131915, -20.304577775187028]]]),
            {
              "reference": 21,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.379948033143634, -20.339187732427064],
                  [-50.387672795106525, -20.338061018575228],
                  [-50.38475455169832, -20.34111922277893]]]),
            {
              "reference": 21,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.32055319671785, -20.34498213106506],
                  [-50.32535971527254, -20.346752598423475],
                  [-50.32741965179598, -20.353029546481327]]]),
            {
              "reference": 21,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.33068121795809, -20.33854389694597],
                  [-50.3339427841202, -20.34015348062021],
                  [-50.3313678634659, -20.344177366468582]]]),
            {
              "reference": 21,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.356430424501056, -20.302162838150668],
                  [-50.355228794862384, -20.299908862941837],
                  [-50.357460392762775, -20.29910386384664],
                  [-50.35831869964754, -20.30135785077019]]]),
            {
              "reference": 21,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.40939569227293, -20.465069192616955],
                  [-50.41094064466551, -20.462817597285312],
                  [-50.41265725843504, -20.46860734713665]]]),
            {
              "reference": 21,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.49797296278074, -20.441586647045312],
                  [-50.492651460095196, -20.442632179174847],
                  [-50.493938920422345, -20.440299828508454]]]),
            {
              "reference": 21,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.47188043348387, -20.433222134031904],
                  [-50.47282457105711, -20.43193524549094],
                  [-50.47299623243406, -20.43442858225925]]]),
            {
              "reference": 21,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.344604131944465, -20.593423648790257],
                  [-50.3521572325304, -20.591334635879697],
                  [-50.35198557115345, -20.594387798942904],
                  [-50.344089147813605, -20.597119524600735]]]),
            {
              "reference": 21,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.24658548570423, -20.60740322921586],
                  [-50.24710046983509, -20.613348179376665],
                  [-50.24366724229603, -20.608849319524715]]]),
            {
              "reference": 21,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.08442976008435, -20.585186309646044],
                  [-50.08408643733044, -20.58068661867555],
                  [-50.087004680738644, -20.5834185897344]]]),
            {
              "reference": 21,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.12700178156872, -20.597559775411582],
                  [-50.12837507258435, -20.59322114197353],
                  [-50.129405040846066, -20.597559775411582]]]),
            {
              "reference": 21,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.98924352656384, -20.53756268185708],
                  [-49.99190427790661, -20.543912214174906],
                  [-49.988642711744504, -20.539973927711763]]]),
            {
              "reference": 21,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.776235775263544, -20.325901855234154],
                  [-50.77984066417956, -20.324292123197036],
                  [-50.78052730968737, -20.327833511565238]]]),
            {
              "reference": 21,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.71684093883776, -20.30272009815795],
                  [-50.71907253673815, -20.298212131159065],
                  [-50.71907253673815, -20.302076110905457]]]),
            {
              "reference": 21,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.96677990368151, -20.2901618637987],
                  [-50.970728115351434, -20.294670065052106],
                  [-50.96712322643542, -20.296119101884305]]]),
            {
              "reference": 21,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.873603306607954, -20.323959744126558],
                  [-50.87394662936186, -20.328386476429724],
                  [-50.86879678805327, -20.328788900356624]]]),
            {
              "reference": 21,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.87188669283842, -20.3324911513492],
                  [-50.87068506319975, -20.336595717306125],
                  [-50.86853929598784, -20.333859352109364]]]),
            {
              "reference": 21,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.38272814500653, -20.48881176453207],
                  [-50.38298563707196, -20.486560517572713],
                  [-50.384358928087586, -20.487444939962614]]]),
            {
              "reference": 21,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.61902003038251, -20.249029937538964],
                  [-50.61927752244794, -20.254827709323173],
                  [-50.61472849595868, -20.25466666302992],
                  [-50.61455683458173, -20.249110463629332]]]),
            {
              "reference": 21,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.69942427303733, -19.738850989539948],
                  [-49.69418860104026, -19.74135538015419],
                  [-49.6936736169094, -19.73666971409791]]]),
            {
              "reference": 21,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.85280371334495, -20.621474531487635],
                  [-49.85366202022971, -20.620349888991274],
                  [-49.85426283504905, -20.6223581733358]]]),
            {
              "reference": 21,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.84670973446311, -20.621715525227554],
                  [-49.84567976620139, -20.619546567836757],
                  [-49.84670973446311, -20.619064573109853]]]),
            {
              "reference": 21,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.8460230889553, -20.622518834939033],
                  [-49.84516478207053, -20.622759827025995],
                  [-49.84447813656272, -20.619867896807122]]]),
            {
              "reference": 21,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.877866274380104, -20.609263682814078],
                  [-49.87812376644553, -20.607897934929998],
                  [-49.879840380215064, -20.609183345042148]]]),
            {
              "reference": 21,
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.89992476131858, -20.62155486277665],
                  [-49.8994956078762, -20.620912211277805],
                  [-49.90146971371116, -20.620269557066532]]]),
            {
              "reference": 21,
              "system:index": "31"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.780190950893775, -20.67922178013037],
                  [-49.77976179745139, -20.68291557209054],
                  [-49.777959352993385, -20.68251407731901],
                  [-49.77881765987815, -20.678579372352615]]]),
            {
              "reference": 21,
              "system:index": "32"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.011161333584205, -20.836048283700208],
                  [-50.00961638119163, -20.839016303394665],
                  [-50.00480986263694, -20.83709110809899]]]),
            {
              "reference": 21,
              "system:index": "33"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.99588347103538, -20.8410216889777],
                  [-49.99511099483909, -20.83925695107536],
                  [-49.998200899624244, -20.840219537950723]]]),
            {
              "reference": 21,
              "system:index": "34"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.57971054903314, -21.560694032982408],
                  [-48.578766411459895, -21.562929116115296],
                  [-48.57747895113275, -21.560614207947598],
                  [-48.58039719454095, -21.55766065076812],
                  [-48.581255501425716, -21.558299262823013]]]),
            {
              "reference": 21,
              "system:index": "35"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.49042259159906, -21.778395526494158],
                  [-48.488705977829525, -21.775287013753417],
                  [-48.48904930058343, -21.77425082786796],
                  [-48.491710051926205, -21.778076707775416]]]),
            {
              "reference": 21,
              "system:index": "36"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.48012290898187, -21.786445464222368],
                  [-48.47729049626214, -21.788517652265146],
                  [-48.477719649704525, -21.78493115401662]]]),
            {
              "reference": 21,
              "system:index": "37"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.53350959721429, -21.80963632128643],
                  [-48.53170715275628, -21.808042568101325],
                  [-48.533938750656674, -21.80652848614467]]]),
            {
              "reference": 21,
              "system:index": "38"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.45480285588128, -21.808361320157495],
                  [-48.454030379684994, -21.812584717910813],
                  [-48.45282875004632, -21.809875382734138]]]),
            {
              "reference": 21,
              "system:index": "39"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.92197194118994, -22.21181055373891],
                  [-47.912015581326656, -22.205135635455534],
                  [-47.91510548611181, -22.201003384100847],
                  [-47.92815175076025, -22.207360643491334]]]),
            {
              "reference": 21,
              "system:index": "40"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.07166066189306, -21.86652592571329],
                  [-48.065824175076656, -21.864295553889527],
                  [-48.07578053493994, -21.862383778882027]]]),
            {
              "reference": 21,
              "system:index": "41"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.989949846463375, -21.877358664611023],
                  [-47.99200978298681, -21.88213755271864],
                  [-47.98788990993994, -21.88213755271864]]]),
            {
              "reference": 21,
              "system:index": "42"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.967977190213375, -21.759109966765507],
                  [-47.96042408962744, -21.758472242905842],
                  [-47.96282734890478, -21.754645840255368]]]),
            {
              "reference": 21,
              "system:index": "43"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-48.10479886981047, -21.36779572046767],
                  [-48.10685880633391, -21.372271774156225],
                  [-48.103253917417895, -21.37147248888998]]]),
            {
              "reference": 21,
              "system:index": "44"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.42596249345985, -19.940913321090406],
                  [-47.42836575273719, -19.934458413582895],
                  [-47.43076901201454, -19.94059058198021]]]),
            {
              "reference": 21,
              "system:index": "45"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.38304714922157, -19.952854204426597],
                  [-47.38270382646766, -19.946399785044903],
                  [-47.38991360429969, -19.948013414632044]]]),
            {
              "reference": 21,
              "system:index": "46"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.35832791094032, -19.977701254083037],
                  [-47.35970120195594, -19.968666416234544],
                  [-47.365881011526255, -19.973506572332536]]]),
            {
              "reference": 21,
              "system:index": "47"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.37103085283485, -19.963826111564945],
                  [-47.3682842708036, -19.95930835985515],
                  [-47.375150725881724, -19.960599159260227]]]),
            {
              "reference": 21,
              "system:index": "48"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.32880215410438, -19.98673557404701],
                  [-47.32365231279579, -19.983831741977532],
                  [-47.33326534990516, -19.98286378606081]]]),
            {
              "reference": 21,
              "system:index": "49"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.393346831838755, -20.012867653223022],
                  [-47.38854031328407, -20.012867653223022],
                  [-47.391630218069224, -20.008996507847197]]]),
            {
              "reference": 21,
              "system:index": "50"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.40776638750282, -19.970279818109972],
                  [-47.40879635576454, -19.97479725552942],
                  [-47.4012432551786, -19.97544259316497]]]),
            {
              "reference": 21,
              "system:index": "51"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.383390471975474, -19.989961991346455],
                  [-47.38030056719032, -19.992865710408882],
                  [-47.376867339651255, -19.99028462944156]]]),
            {
              "reference": 21,
              "system:index": "52"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.40570645097938, -19.96092185746128],
                  [-47.40295986894813, -19.958340253370675],
                  [-47.407079741995005, -19.956404022581047]]]),
            {
              "reference": 21,
              "system:index": "53"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.34425167803016, -19.937040408239938],
                  [-47.343908355276255, -19.930585342473634],
                  [-47.34699826006141, -19.932844645492228]]]),
            {
              "reference": 21,
              "system:index": "54"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.37171749834266, -19.979637223393656],
                  [-47.37480740312782, -19.979637223393656],
                  [-47.374120757620005, -19.984799691947632]]]),
            {
              "reference": 21,
              "system:index": "55"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.54046063188758, -20.12895764933429],
                  [-47.538915679495005, -20.131052928183962],
                  [-47.53634075884071, -20.129118825627536]]]),
            {
              "reference": 21,
              "system:index": "56"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.50535588030067, -20.132342316592812],
                  [-47.50835995439735, -20.130005292269836],
                  [-47.50930409197059, -20.132906420676875]]]),
            {
              "reference": 21,
              "system:index": "57"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.50664334062782, -20.13580749523276],
                  [-47.50312428240028, -20.13725801231451],
                  [-47.50278095964637, -20.13540457143162]]]),
            {
              "reference": 21,
              "system:index": "58"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.50209431413856, -20.12291341838609],
                  [-47.50183682207313, -20.12097921513666],
                  [-47.506214187185435, -20.121785136064567]]]),
            {
              "reference": 21,
              "system:index": "59"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.509733245412974, -20.140884246106886],
                  [-47.51041989092079, -20.144268655039895],
                  [-47.5085316157743, -20.142576459739207]]]),
            {
              "reference": 21,
              "system:index": "60"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.51162152055946, -20.13725801231451],
                  [-47.511449859182505, -20.140159006081614],
                  [-47.51050572160926, -20.140159006081614],
                  [-47.51007656816688, -20.13846676626343]]]),
            {
              "reference": 21,
              "system:index": "61"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.49934773210731, -20.124202873928052],
                  [-47.49840359453407, -20.122752235695717],
                  [-47.499691054861216, -20.122832827061664]]]),
            {
              "reference": 21,
              "system:index": "62"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.506214187185435, -20.140642499805875],
                  [-47.50681500200477, -20.14225413474635],
                  [-47.50509838823524, -20.141609482765347]]]),
            {
              "reference": 21,
              "system:index": "63"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.51153568987098, -20.14579967308632],
                  [-47.51239399675575, -20.144429815540988],
                  [-47.5125656581327, -20.14579967308632]]]),
            {
              "reference": 21,
              "system:index": "64"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.4081955409452, -20.807665631340214],
                  [-47.405277297537, -20.807184234654418],
                  [-47.40845303301063, -20.805900502644725]]]),
            {
              "reference": 21,
              "system:index": "65"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.35558132890907, -20.822668390770993],
                  [-47.355924651662974, -20.819459369937835],
                  [-47.35721211199012, -20.82218704200332]]]),
            {
              "reference": 21,
              "system:index": "66"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.63899426225868, -21.37119790366681],
                  [-47.63710598711219, -21.37119790366681],
                  [-47.63950924638954, -21.368160574166986],
                  [-47.641054198782115, -21.368320435184998]]]),
            {
              "reference": 21,
              "system:index": "67"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.630325362722544, -21.38262728942022],
                  [-47.62826542619911, -21.385344634420004],
                  [-47.62663464311805, -21.384465498912913],
                  [-47.62920956377235, -21.38334659153706]]]),
            {
              "reference": 21,
              "system:index": "68"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.62543301347938, -21.38814184861682],
                  [-47.62560467485633, -21.385904081537852],
                  [-47.62826542619911, -21.386863128762933]]]),
            {
              "reference": 21,
              "system:index": "69"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.629810378591685, -21.38062920943292],
                  [-47.62697796587196, -21.380309514103313],
                  [-47.62972454790321, -21.37743222471137]]]),
            {
              "reference": 21,
              "system:index": "70"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.35295316608184, -19.866762069374264],
                  [-47.35243818195098, -19.86999093696478],
                  [-47.351064890935355, -19.86869939781926]]]),
            {
              "reference": 21,
              "system:index": "71"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.374898120326435, -19.831487322691448],
                  [-47.372409030360615, -19.83415173533278],
                  [-47.37180821554128, -19.833425081771583]]]),
            {
              "reference": 21,
              "system:index": "72"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.69195127668884, -19.74235158437956],
                  [-47.68749620941865, -19.745371228083794],
                  [-47.687324548041694, -19.74290729315712]]]),
            {
              "reference": 21,
              "system:index": "73"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.62694874390321, -19.772840584342678],
                  [-47.62596169098573, -19.775667516860423],
                  [-47.62583294495302, -19.772638658672662],
                  [-47.62634792908388, -19.772800199229152]]]),
            {
              "reference": 21,
              "system:index": "74"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.53037104234099, -19.870337850272552],
                  [-49.52951273545622, -19.872032975724185],
                  [-49.527195306867355, -19.870418570943176]]]),
            {
              "reference": 21,
              "system:index": "75"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.520243021100754, -19.85806783050424],
                  [-49.51964220628142, -19.861054699046893],
                  [-49.5186122380197, -19.858471464674885]]]),
            {
              "reference": 21,
              "system:index": "76"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.562643381208176, -19.881396199195425],
                  [-49.56127009019255, -19.882606920455842],
                  [-49.560411783307785, -19.882203347730382],
                  [-49.56152758225798, -19.879055445191412]]]),
            {
              "reference": 21,
              "system:index": "77"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.02152140193636, -19.902697789759017],
                  [-50.018174005085775, -19.905925924897325],
                  [-50.01748735957796, -19.90354518160726],
                  [-50.01856024318392, -19.90181004105127]]]),
            {
              "reference": 21,
              "system:index": "78"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.01757319026644, -19.906329437159094],
                  [-50.015513253743, -19.90782242357978],
                  [-50.01306707912142, -19.902939902178677],
                  [-50.016199899250815, -19.90261708553682]]]),
            {
              "reference": 21,
              "system:index": "79"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.01036341243441, -19.91076800411648],
                  [-50.00813181453402, -19.911575002910922],
                  [-50.00551397853548, -19.907580318630785],
                  [-50.00748808437044, -19.90645049063695]]]),
            {
              "reference": 21,
              "system:index": "80"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.00062162929232, -19.90128545992874],
                  [-49.99907667689974, -19.902294268236478],
                  [-49.99839003139193, -19.900115234235926]]]),
            {
              "reference": 21,
              "system:index": "81"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.66798561645171, -20.96899425936722],
                  [-49.66502445769927, -20.974363977372718],
                  [-49.664337812191455, -20.969635429866763],
                  [-49.66614025664946, -20.96791227791391]]]),
            {
              "reference": 21,
              "system:index": "82"
            })]),
    flo = /* color: #99ff99 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.85501263748159, -20.537584065384838],
                  [-49.85338185440054, -20.53501202826357],
                  [-49.85810254226675, -20.53669993250297]]]),
            {
              "reference": 3,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-49.83104952200651, -20.550363233341436],
                  [-49.83147867544889, -20.551890232271518],
                  [-49.82821710928678, -20.552131335971023]]]),
            {
              "reference": 3,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.250719007751776, -20.483983401511136],
                  [-50.25380891253693, -20.47851585801834],
                  [-50.2546672194217, -20.487521119916625]]]),
            {
              "reference": 3,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.48926270434027, -20.40848219072993],
                  [-50.49166596361761, -20.415078385970773],
                  [-50.487889413324645, -20.41234341248258]]]),
            {
              "reference": 3,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.76181621959948, -20.32413114907197],
                  [-50.763189510615106, -20.328477391647795],
                  [-50.7602712672069, -20.327511570518727]]]),
            {
              "reference": 3,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.20148228534142, -20.204078545941023],
                  [-51.19719075091759, -20.201984247654018],
                  [-51.19993733294884, -20.200695434706894]]]),
            {
              "reference": 3,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-51.18483113177697, -20.20552842825252],
                  [-51.17985295184533, -20.212294367153095],
                  [-51.180367935976186, -20.20649500895855]]]),
            {
              "reference": 3,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.55998035275554, -20.84472624772796],
                  [-50.56092449032878, -20.846651345358584],
                  [-50.55817790829753, -20.848095152418008]]]),
            {
              "reference": 3,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-50.01133299496116, -20.844069823889622],
                  [-50.01030302669944, -20.844551102705715],
                  [-50.00747061397971, -20.843187475395734]]]),
            {
              "reference": 3,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.390600249807505, -19.89410926888764],
                  [-47.38579373125282, -19.8954006009103],
                  [-47.387853667776255, -19.892495089048445]]]),
            {
              "reference": 3,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.52106289629188, -20.135162816652247],
                  [-47.52174954179969, -20.133712280122193],
                  [-47.52260784868446, -20.134921061498886]]]),
            {
              "reference": 3,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.53333668474403, -20.11840024025898],
                  [-47.533680007497935, -20.120253882750614],
                  [-47.531705901662974, -20.119770325957724]]]),
            {
              "reference": 3,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-47.371631667654185, -20.822026592072337],
                  [-47.37000088457313, -20.82218704200332],
                  [-47.37077336076942, -20.82106388889802]]]),
            {
              "reference": 3,
              "system:index": "12"
            })]);

// Define the region ID (reg_18)
var regiaoID = 'reg_18'; // old 11

// Define whether to collect data (false)
var coleta = false;   // true or false

// Define the years to process (2016-2023)
var anos = [2016,2017,2018,2019,2020,2021,2022,2023]

// If collecting data, only process 2023
if (coleta) {var anos = [2023]}

// Define the number of trees for the Random Forest classifier (100)
var RFtrees = 100;

// If collecting data, use 200 trees
if (coleta) {var RFtrees = 200}

// Define the output version (1)
var versao_out = 1;

// Define the version of the point data (S2_v1)
var versao_pt = 'S2_v1';

// Define the stable version (3)
var versao_estavel = '3'

// Define the input directory for point data
var dir_pt_in = 'projects/mapbiomas-workspace/AMOSTRAS/col9/MATA_ATLANTICA/teste/';

// Load the 250,000 biomes feature collection
var bioma250mil = ee.FeatureCollection('projects/mapbiomas-workspace/AUXILIAR/biomas_IBGE_250mil');

// Filter the collection to only include the Atlantic Forest biome
var bioma250mil_MA_vetor = bioma250mil.filterMetadata('Bioma','equals', 'Mata Atlântica');

// Load the biomes raster
var biomes = ee.Image('projects/mapbiomas-workspace/AUXILIAR/biomas-raster-41');

// Mask the biomes raster to only include the Atlantic Forest biome
var bioma250mil_MA = biomes.mask(biomes.eq(2));

// Add the Atlantic Forest biome layer to the map
Map.addLayer(bioma250mil_MA,{},'layer bioma',false)

// Import the palettes module
var palettes = require('users/mapbiomas/modules:Palettes.js');

// Define the visualization parameters for the classification
var vis = {
    'min': 0,
    'max': 62,
    'palette': palettes.get('classification7')
};

// Load the Atlantic Forest regions feature collection
var regioesCollection = ee.FeatureCollection('projects/mapbiomas-workspace/AUXILIAR/Mata_Atlantica_col6_PLANET');

// Define the visualization parameters for the median composite
var visParMedian2 = {bands: ['swir1_median', 'nir_median', 'red_median'],gain: [0.08, 0.06, 0.2],gamma: 0.85}

// Define the biome name (MATAATLANTICA)
var bioma = "MATAATLANTICA";

// Define the output directory
var dirout = 'projects/mapbiomas-workspace/COLECAO7/classificacao-ma/';

// Load the S2 cluster image
var S2_cluster = ee.Image('projects/mapbiomas-workspace/AMOSTRAS/S2_2024/MATA_ATLANTICA/mosaicos_MA_S2_clusters_2106_2023')

// Filter the regions collection to only include the specified region ID
var limite = regioesCollection.filterMetadata('reg_id', "equals", regiaoID);
//var limite = reg_04_rev

// Load the stable map from collection 6
var mapa_estavel_col6 = ee.Image('projects/mapbiomas-workspace/AMOSTRAS/col7/MATA_ATLANTICA/MA_amostras_estaveis85a20_col6_v1')

// Add the stable map layer to the map
Map.addLayer(mapa_estavel_col6, vis, 'mapa_estavel_col6', false);

// Create a blank image
var blank = ee.Image(0).mask(0);
// Outline the region boundary
var outline = blank.paint(limite, 'AA0000', 2); 
// Define the visualization parameters for the outline
var visPar = {'palette':'000000','opacity': 0.6};
// Add the outline layer to the map
Map.addLayer(outline, visPar, regiaoID, false);

// Define a function to shuffle a feature collection
var shuffle = function (collection, seed) {
    // Add a random column to the collection
    collection = collection.randomColumn('random', seed || 1)
        // Sort the collection by the random column
        .sort('random', true)
        // Map over the collection and set a new ID based on the random value
        .map(function (feature) {
                var rescaled = ee.Number(feature.get('random')).multiply(1000000000).round();
                return feature.set('new_id', rescaled)});
    // Get a list of the new IDs
    var randomIdList = ee.List(collection.reduceColumns(ee.Reducer.toList(), ['new_id']).get('list'));
    // Create a sequential list of IDs
    var sequentialIdList = ee.List.sequence(1, collection.size());
    // Remap the collection using the new and sequential IDs
    var shuffled = collection.remap(randomIdList, sequentialIdList, 'new_id');
    // Return the shuffled collection
    return shuffled;
};

// Define the visualization parameters for the hand-labeled data
var vis_hand = {
    'min': 0,
    'max': 60,
    'palette': 'blue,white,green,orange,red,brown'
};

// Loop through each year
for (var i_ano=0;i_ano<anos.length; i_ano++){
  // Get the current year
  var ano = anos[i_ano];

  // Define the asset path for the Sentinel-2 mosaics
  var asset = 'projects/mapbiomas-mosaics/assets/SENTINEL/BRAZIL/mosaics-3';
  // Define the band names to use for classification
  var bandNames = ee.List([
  // THE 60 MOST IMPORTANT BANDS FOR THIS REGION
  'green_median_texture','brightness_median_dry','swir2_stdDev','red_edge_1_median','red_median_dry','lai_median','gcvi_median_wet','red_median_wet','osavi_median_wet','ndvi_median_dry_'+ano,'bsi_median_2','spri_median','red_edge_1_median_dry','cvi_median','red_median','swir2_median_dry','swir1_median','ratio_median','wetness_median_dry','lswi_median_dry','iia_median_wet','avi_median_wet','dswi5_median_dry','ui_median_dry','gli_median_dry','wetness_median_wet','gcvi_median','brba_median_dry','blue_median','ui_median_wet','cvi_median_dry','gemi_median','ndvi_median_dry','ri_median','brba_median_wet','red_edge_1_median_wet','rvi_median_1','brightness_median_wet','longitude','swir2_median_wet','lswi_median_wet','brightness_median','swir1_median_dry','nir_median_dry','green_median_wet','gli_median','swir1_stdDev','red_edge_4_median_dry','msi_median_dry','co2flux_median','osavi_median_dry','red_edge_3_median_dry','red_stdDev','wetness_median','shape_median_wet','ratio_median_dry','latitude','red_edge_2_stdDev','iia_median_dry','ui_median',

  // ALL 143 BANDS TO FEATURE IMPORTANCE
  //    'blue_median','afvi_median','afvi_median_dry','afvi_median_wet','avi_median','avi_median_dry','avi_median_wet','awei_median','awei_median_dry','awei_median_wet','blue_median_dry','blue_median_wet','blue_stdDev','brba_median','brba_median_dry','brba_median_wet','brightness_median','brightness_median_dry','brightness_median_wet','bsi_median','bsi_median_1','bsi_median_2','clusters_2023','co2flux_median','cvi_median','cvi_median_dry','cvi_median_wet','dswi5_median','dswi5_median_dry','dswi5_median_wet','evi_median','evi_median_dry','evi_median_wet','gcvi_median','gcvi_median_dry','gcvi_median_wet','gemi_median','gemi_median_dry','gemi_median_wet','gli_median','gli_median_dry','gli_median_wet','green_median','green_median_dry','green_median_texture','green_median_texture_2023','green_median_wet','green_min','green_stdDev','gvmi_median','gvmi_median_1','gvmi_median_dry','gvmi_median_dry_1','gvmi_median_wet','gvmi_median_wet_1','iia_median','iia_median_dry','iia_median_wet','lai_median','latitude','longitude','lswi_median','lswi_median_dry','lswi_median_wet','mbi_median','mbi_median_dry','mbi_median_wet','msi_median','msi_median_dry','msi_median_wet','nddi_median','nddi_median_dry','nddi_median_wet','ndvi_median','ndvi_median_dry','ndvi_median_dry_2023','ndvi_median_wet','ndvi_median_wet_2023','ndwi_median','ndwi_median_2023','ndwi_median_dry','ndwi_median_wet','nir_median','nir_median_contrast','nir_median_dry','nir_median_dry_contrast','nir_median_wet','nir_stdDev','osavi_median','osavi_median_dry','osavi_median_wet','ratio_median','ratio_median_dry','ratio_median_wet','red_edge_1_median','red_edge_1_median_dry','red_edge_1_median_wet','red_edge_1_stdDev','red_edge_2_median','red_edge_2_median_dry','red_edge_2_median_wet','red_edge_2_stdDev','red_edge_3_median','red_edge_3_median_dry','red_edge_3_median_wet','red_edge_3_stdDev','red_edge_4_median','red_edge_4_median_dry','red_edge_4_median_wet','red_edge_4_stdDev','red_median','red_median_contrast','red_median_dry','red_median_dry_contrast','red_median_wet','red_min','red_stdDev','ri_median','ri_median_dry','ri_median_wet','rvi_median','rvi_median_1','rvi_median_wet','shape_median','shape_median_dry','shape_median_wet','spri_median','spri_median_1','spri_median_wet','swir1_median','swir1_median_dry','swir1_median_wet','swir1_stdDev','swir2_median','swir2_median_dry','swir2_median_wet','swir2_stdDev','ui_median','ui_median_dry','ui_median_wet','wetness_median','wetness_median_dry','wetness_median_wet',
  ])

  // Filter the Sentinel-2 mosaic collection by version, year, and biome
  var collection = ee.ImageCollection(asset)
        .filter(ee.Filter.eq('version', '3'))
        .filter(ee.Filter.eq('year', ano))
        .filter(ee.Filter.inList('biome', [
            'MATAATLANTICA',
        ])); 

  // Create a mosaic of the filtered collection
  var mosaicoTotal = collection.mosaic()

  // Import the function to add indices for the Caatinga biome
  var addIndexCaatinga = require('users/marcosrosaUSP/MapBiomas_col9_MataAtlan:Mata_Atlantica_SENTINEL2/processa_Bandas_Sentinel2_CAATINGA');

  // Add the Caatinga indices to the mosaic
  mosaicoTotal = addIndexCaatinga.get(mosaicoTotal);

  // Add bands from the S2 cluster image to the mosaic
  mosaicoTotal = mosaicoTotal.addBands(S2_cluster.select([
    'clusters_'+ano, 'ndvi_median_dry_'+ano,'ndvi_median_wet_'+ano,'ndwi_median_'+ano, 'green_median_texture_'+ano
    ]))
    
  // Add the mosaic layer to the map
  Map.addLayer(mosaicoTotal, {'bands': ['swir1_median', 'nir_median', 'red_median'],
    'gain': [0.08, 0.07, 0.2],'gamma': 0.85}, 'Sentinel 2 '+ano, false);
  //print(mosaicoTotal)
  //var BDamostras = ee.FeatureCollection('projects/mapbiomas-workspace/AMOSTRAS/col9/MATA_ATLANTICA/teste/REGIONs_'+regiaoID+'_'+ano)

  // Load the training points for the current year
  var BDamostras = ee.FeatureCollection('projects/mapbiomas-workspace/AMOSTRAS/S2_2024/MATA_ATLANTICA/pontos_train_v1_'+ano)
                    .filterMetadata('reg_id', 'equals', regiaoID)
          
    // Filter the training points by reference class
    var BDflo = BDamostras.filterMetadata("reference", "equals", 3)
    var BDsav = BDamostras.filterMetadata("reference", "equals", 4)//.limit(100)
    var BDreflo = BDamostras.filterMetadata("reference", "equals", 9)
    var BDvarzea = BDamostras.filterMetadata("reference", "equals", 11)
    var BDcampo = BDamostras.filterMetadata("reference", "equals", 12)
    var BDOutroNFlo = BDamostras.filterMetadata("reference", "equals", 13)
    var BDagro = BDamostras.filterMetadata("reference", "equals", 21)
    // BDagro = shuffle(BDagro, 2).limit(1000)
    var BDNaoVeg = BDamostras.filterMetadata("reference", "equals", 22)
    var BDAflora = BDamostras.filterMetadata("reference", "equals", 29)
    var BDagua = BDamostras.filterMetadata("reference", "equals", 33)

  // Complementary samples
  // Merge the training points for different classes
  var amostraTotal = varzea.merge(flo).merge(agro)//.merge(agua).merge(varzea)
  
  // Reduce the training points to an image
  var amostraTotalimg = amostraTotal.reduceToImage({properties: ['reference'],reducer: ee.Reducer.first()})

  // Rename the band
  amostraTotalimg = amostraTotalimg.select([0],['reference'])

   // Sample the mosaic using the training points for the forest class
  var training_flo = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 100, 'region': flo.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_nflo = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 300, 'region': nao_flo.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_sav = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 1500, 'region': sav.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_afl = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 1000, 'region': aflora.filterBounds(limite), 'scale': 10, 'seed': 1});

  // Sample the mosaic using the training points for the varzea class
  var training_var = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 1200, 'region': varzea.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_agu = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 100, 'region': agua.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_cam = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 800, 'region': campo.filterBounds(limite), 'scale': 10, 'seed': 1});
  // var training_nflo = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 200, 'region': n_flo.filterBounds(limite), 'scale': 10, 'seed': 1});

  // Sample the mosaic using the training points for the agriculture class
  var training_agr = mosaicoTotal.select(bandNames).addBands(amostraTotalimg).sample({'numPixels': 500, 'region': agro.filterBounds(limite), 'scale': 10, 'seed': 1});

// If collecting data, print the size of each training set
if (coleta) {
// print('BDflo',BDflo.size())
// print('BDsav',BDsav.size())
// print('BDvar',BDvarzea.size())
// print('BDcam',BDcampo.size())
// print('BDOut',BDOutroNFlo.size())
// print('BDAfl',BDAflora.size())
// print('BDagr',BDagro.size())
// print('BDNao',BDNaoVeg.size())
// print('BDagu',BDagua.size())
print('training_flo',training_flo.size())
//print('training_cam',training_cam.size())
//print('training_var',training_var.size())
//print('training_afl',training_afl.size())
//print('training_cam',training_cam.size())
print('training_agr',training_agr.size())
}

  // Merge the training points for all classes
  var training = BDflo.merge(BDreflo).merge(BDcampo)//.merge(BDsav).merge(BDOutroNFlo).merge(BDAflora)
                      .merge(BDagro).merge(BDNaoVeg).merge(BDagua)
                      //complementares
                      // .merge(training_afl)
                      .merge(training_var).merge(training_agr).merge(training_flo)
                      // .merge(training_sav)
                      // //.merge(training_agu).merge(training_agr)

  // Train a Random Forest classifier
  var classifierRF = ee.Classifier.smileRandomForest({numberOfTrees: RFtrees, variablesPerSplit:1}).train(training, 'reference', bandNames);

  // If collecting data, print the classifier explanation
  if (coleta) {print(classifierRF.explain())}

  // Train a Gradient Tree Boost classifier
  var classifierGTB = ee.Classifier.smileGradientTreeBoost({numberOfTrees: 30, shrinkage: 0.1, samplingRate: 0.8, loss: 'LeastSquares'}).train(training, 'reference', bandNames);

  // print(classifier.explain())

  // Classify the mosaic using the Random Forest classifier
  var classifiedRF = mosaicoTotal.classify(classifierRF).mask(mosaicoTotal.select('blue_median'));

  // Classify the mosaic using the Gradient Tree Boost classifier
  var classifiedGTB = mosaicoTotal.classify(classifierGTB).mask(mosaicoTotal.select('blue_median'));

  // Rename the classification band and clip the image to the region boundary
  classifiedRF = classifiedRF.select(['classification'],['classification_'+ano]).clip(limite.geometry()).toInt8()
  // classifiedGTB = classifiedGTB.select(['classification'],['classification_'+ano]).clip(limite.geometry()).toInt8()

  // If collecting data, add the classified images to the map
  if (coleta) {  
    Map.addLayer(classifiedRF, vis, 'RF'+ano+"_"+regiaoID, false);
    // Map.addLayer(classifiedGTB, vis, 'GTB'+ano+"_"+regiaoID, false);
  }

  // If this is the first year, initialize the combined classification image
  if (i_ano == 0){ var classified16a23RF = classifiedRF;}//  var classified16a23GTB = classifiedGTB}  
  // Otherwise, add the current year's classification to the combined image
  else {classified16a23RF = classified16a23RF.addBands(classifiedRF);}// classified16a23GTB = classified16a23GTB.addBands(classifiedGTB)}
}

// If collecting data, do nothing
if (coleta) {}
// Otherwise, export the classified image to an asset
   else 
   {
     // Set metadata for the classified image
     classified16a23RF = classified16a23RF
     .set('territory', 'BRAZIL')
     .set('biome', 'MATA ATÂNTICA')
     .set('source', 'arcplan')
     .set('version', '1')
     .set('collection_id',versao_out)

//     classified16a23GTB = classified16a23GTB
//     .set('territory', 'BRAZIL')
//     .set('biome', 'MATA ATÂNTICA')
//     .set('source', 'arcplan')
//     .set('version', '1')
//     .set('collection_id',versao_out)
     
    // Export the classified image to an asset
    Export.image.toAsset({
       "image": classified16a23RF.toInt8(),
       "description": regiaoID+'-'+'RF_SENTINEL2_v'+versao_out,
       "assetId": dirout + regiaoID+'-'+'RF_SENTINEL2_v'+versao_out,
       "scale": 10,
       "pyramidingPolicy": {
           '.default': 'mode'
       },
       "maxPixels": 1e13,
       "region": limite
     });    
     
//    Export.image.toAsset({
//       "image": classified16a23GTB.toInt8(),
//       "description": regiaoID+'-'+'GTB_SENTINEL2_v'+versao_out,
//       "assetId": dirout + regiaoID+'-'+'GTB_SENTINEL2_v'+versao_out,
//       "scale": 10,
//       "pyramidingPolicy": {
//           '.default': 'mode'
//       },
//       "maxPixels": 1e13,
//       "region": limite
//     });    
}
